<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PreorderTokens - é¢„è´­ä»£å¸ - Solidityå­¦ä¹ </title>
    <link href="https://fonts.googleapis.com/css2?family=Gochi+Hand&family=Reenie+Beanie&family=Comic+Neue:ital,wght@0,400;0,700;1,400&family=Fira+Code&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --accent: #4cc9f0;
            --light: #f8f9fa;
            --dark: #212529;
            --easy: #43AA8B;
            --medium: #F8961E;
            --hard: #E71D36;
            --expert: #7209B7;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Comic Neue', cursive;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf9 100%);
            color: var(--dark);
            line-height: 1.8;
            background-image: radial-gradient(#d0e3ff 1px, transparent 1px);
            background-size: 30px 30px;
        }
        
        .nav-bar {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .nav-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .back-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 10px;
            font-family: 'Comic Neue', cursive;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .back-btn:hover {
            background: var(--secondary);
            transform: translateX(-3px);
        }
        
        .nav-title {
            font-family: 'Gochi Hand', cursive;
            font-size: 1.3rem;
            color: var(--secondary);
        }
        
        .nav-right {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 5px 15px;
            border-radius: 8px;
            font-family: 'Comic Neue', cursive;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }
        
        .nav-btn:hover {
            background: var(--primary);
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        
        .hero-section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 5px 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            border-top: 5px solid var(--hard);
        }
        
        .hero-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .hero-title {
            flex: 1;
            min-width: 250px;
        }
        
        .day-badge {
            background: linear-gradient(135deg, var(--hard), #c72828);
            color: white;
            padding: 8px 20px;
            border-radius: 15px;
            font-family: 'Gochi Hand', cursive;
            font-size: 1.2rem;
            margin-bottom: 10px;
            display: inline-block;
        }
        
        h1 {
            font-family: 'Gochi Hand', cursive;
            font-size: 2.8rem;
            color: var(--secondary);
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 20px;
        }
        
        .meta-tags {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .difficulty-badge {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            color: white;
            font-size: 1rem;
        }
        
        .tag {
            background: var(--light);
            padding: 5px 15px;
            border-radius: 15px;
            color: var(--secondary);
            font-size: 0.9rem;
        }
        
        .section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 3px 3px 10px rgba(0,0,0,0.1);
        }
        
        .section-title {
            font-family: 'Gochi Hand', cursive;
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px dashed var(--accent);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .key-points {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .key-point {
            background: linear-gradient(135deg, #ffe6e6, #ffd6d6);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--hard);
        }
        
        .key-point-title {
            font-weight: bold;
            color: var(--hard);
            margin-bottom: 5px;
        }
        
        .concept-card {
            background: linear-gradient(135deg, #fff0f0, #ffe6e6);
            border-left: 5px solid var(--hard);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .concept-title {
            font-family: 'Gochi Hand', cursive;
            font-size: 1.4rem;
            color: var(--hard);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        pre {
            background: #282c34;
            border-radius: 10px;
            padding: 20px;
            overflow-x: auto;
            margin: 15px 0;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.3);
        }
        
        code {
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            color: #f8f8f2;
        }
        
        .inline-code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Fira Code', monospace;
            color: var(--hard);
            font-size: 0.9em;
        }
        
        .navigation-footer {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .nav-footer-btn {
            flex: 1;
            min-width: 200px;
            background: white;
            border: 3px solid var(--primary);
            padding: 20px;
            border-radius: 15px;
            text-decoration: none;
            color: var(--dark);
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .nav-footer-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .nav-footer-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .nav-footer-title {
            font-family: 'Gochi Hand', cursive;
            font-size: 1.3rem;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .hero-section {
                padding: 25px;
            }
            
            .section {
            padding: 20px;
            }
            
            .key-points {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="nav-bar">
        <div class="nav-left">
        <a href="index.html" class="back-btn">
            <i class="fas fa-arrow-left"></i> è¿”å›é¦–é¡µ
        </a>
            <span class="nav-title">ç¬¬13å¤© - ä»£å¸é”€å”®ä¸é”å®š</span>
        </div>
        <div class="nav-right">
            <a href="#concepts" class="nav-btn">ğŸ“š æ ¸å¿ƒæ¦‚å¿µ</a>
            <a href="#code" class="nav-btn">ğŸ’» ä»£ç è®²è§£</a>
            <a href="#practice" class="nav-btn">ğŸ¯ å®è·µ</a>
        </div>
    </div>

    <div class="container">
        <div class="hero-section">
            <div class="hero-header">
                <div class="hero-title">
                    <div class="day-badge">ç¬¬ 13 å¤© ğŸ«</div>
            <h1>PreorderTokens - é¢„è´­ä»£å¸</h1>
                    <p class="subtitle">ä»£å¸é”€å”®åˆçº¦ - virtual/overrideä¸æ—¶é—´é”</p>
                </div>
                <div class="meta-tags">
                    <div class="difficulty-badge" style="background: var(--hard);">
                        ğŸŒ³ é«˜çº§
                    </div>
                    <span class="tag">virtual</span>
                    <span class="tag">override</span>
                    <span class="tag">æ—¶é—´é”</span>
                <span class="tag">ICO</span>
                </div>
            </div>
            
            <div class="key-points">
                <div class="key-point">
                    <div class="key-point-title">ğŸ“Œ å­¦ä¹ ç›®æ ‡</div>
                    <div>æŒæ¡å‡½æ•°é‡å†™å’Œä»£å¸é”€å”®æœºåˆ¶</div>
                </div>
                <div class="key-point">
                    <div class="key-point-title">ğŸ¯ æ ¸å¿ƒæŠ€èƒ½</div>
                    <div>virtual/overrideã€superã€æ—¶é—´æ§åˆ¶</div>
                </div>
                <div class="key-point">
                    <div class="key-point-title">â±ï¸ é¢„è®¡æ—¶é—´</div>
                    <div>90åˆ†é’Ÿ</div>
                </div>
                <div class="key-point">
                    <div class="key-point-title">ğŸ”¥ éš¾åº¦ç³»æ•°</div>
                    <div>â˜…â˜…â˜…â˜…â˜†</div>
                </div>
            </div>
        </div>

        <div class="section" id="concepts">
            <h2 class="section-title">
                <i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µè¯¦è§£
            </h2>
            
            <div class="concept-card">
                <div class="concept-title">ğŸ”„ virtual å’Œ override</div>
                <p>å…è®¸å­åˆçº¦é‡å†™çˆ¶åˆçº¦çš„å‡½æ•°:</p>
                <pre><code class="language-solidity">// çˆ¶åˆçº¦
contract SimpleERC20 {
    function transfer(address _to, uint256 _value) 
        public 
        virtual  // æ ‡è®°ä¸ºå¯è¢«é‡å†™
        returns (bool) 
    {
        _transfer(msg.sender, _to, _value);
        return true;
    }
}

// å­åˆçº¦
contract TokenSale is SimpleERC20 {
    function transfer(address _to, uint256 _value) 
        public 
        override  // é‡å†™çˆ¶åˆçº¦å‡½æ•°
        returns (bool) 
    {
        // æ·»åŠ é¢å¤–é€»è¾‘
        require(finalized, "Tokens are locked");
        
        // è°ƒç”¨çˆ¶åˆçº¦çš„åŸå§‹å‡½æ•°
        return super.transfer(_to, _value);
    }
}</code></pre>
                <p><strong>å…³é”®ç‚¹:</strong></p>
                <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.8;">
                    <li><code class="inline-code">virtual</code>: çˆ¶åˆçº¦æ ‡è®°å‡½æ•°å¯è¢«é‡å†™</li>
                    <li><code class="inline-code">override</code>: å­åˆçº¦æ ‡è®°æ­£åœ¨é‡å†™çˆ¶å‡½æ•°</li>
                    <li><code class="inline-code">super</code>: è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°</li>
                    <li>å‡½æ•°ç­¾åå¿…é¡»å®Œå…¨åŒ¹é…</li>
                </ul>
            </div>

            <div class="concept-card">
                <div class="concept-title">ğŸ”’ ä»£å¸é”å®šæœºåˆ¶</div>
                <p>åœ¨ä»£å¸é”€å”®æœŸé—´é˜²æ­¢è½¬è´¦,ä¿æŠ¤æŠ•èµ„è€…:</p>
                <pre><code class="language-solidity">bool public finalized = false;

function transfer(address _to, uint256 _value) public override returns (bool) {
    // å¦‚æœé”€å”®æœªå®Œæˆ,ç¦æ­¢è½¬è´¦
    if (!finalized && msg.sender != address(this)) {
        require(false, "Tokens are locked until sale is finalized");
    }
    return super.transfer(_to, _value);
}</code></pre>
                <p><strong>ä¸ºä»€ä¹ˆéœ€è¦é”å®š?</strong></p>
                <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.8;">
                    <li>é˜²æ­¢æ—©æœŸæŠ•èµ„è€…åœ¨é”€å”®æœŸé—´æŠ›å”®</li>
                    <li>ç¡®ä¿å…¬å¹³çš„ä»£å¸åˆ†é…</li>
                    <li>é¿å…ä»·æ ¼æ“çºµ</li>
                    <li>ä¿æŠ¤é¡¹ç›®æ–¹ç­¹é›†èµ„é‡‘</li>
                </ul>
                
                <div style="background: #fff9e6; padding: 15px; border-radius: 8px; margin-top: 15px;">
                    <strong style="color: #856404;">ğŸ’¡ ä¾‹å¤–:</strong>
                    <span style="color: #856404;"> åˆçº¦è‡ªå·±(<code class="inline-code">address(this)</code>)ä»ç„¶å¯ä»¥è½¬è´¦,è¿™æ ·æ‰èƒ½åœ¨è´­ä¹°æ—¶å°†ä»£å¸è½¬ç»™ä¹°å®¶!</span>
                </div>
            </div>

            <div class="concept-card">
                <div class="concept-title">â° æ—¶é—´æ§åˆ¶ - é”€å”®å‘¨æœŸ</div>
                <pre><code class="language-solidity">uint256 public saleStartTime;
uint256 public saleEndTime;

constructor(uint256 _startTime, uint256 _duration) {
    saleStartTime = _startTime;
    saleEndTime = _startTime + _duration;
}

function isSaleActive() public view returns (bool) {
    return block.timestamp >= saleStartTime && 
           block.timestamp <= saleEndTime && 
           !finalized;
}</code></pre>
                <p><strong>æ—¶é—´çº¿ç¤ºä¾‹:</strong></p>
                <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px;">
                    <pre><code>éƒ¨ç½²æ—¶é—´: 2024-01-01 00:00:00
é”€å”®å¼€å§‹: 2024-01-10 00:00:00 (saleStartTime)
é”€å”®æŒç»­: 30å¤©
é”€å”®ç»“æŸ: 2024-02-09 00:00:00 (saleEndTime)

æ—¶é—´è½´:
|---- å‡†å¤‡æœŸ ----|---- é”€å”®æœŸ (30å¤©) ----|---- é”€å”®å ----|
éƒ¨ç½²            å¼€å§‹                     ç»“æŸ            å®Œæˆ</code></pre>
                </div>
            </div>

            <div class="concept-card">
                <div class="concept-title">ğŸ’° ä»£å¸ä»·æ ¼è®¡ç®—</div>
                <pre><code class="language-solidity">uint256 public tokenPrice = 0.001 ether;  // æ¯ä¸ªä»£å¸0.001 ETH

function buyTokens() public payable {
    // ç”¨æˆ·å‘é€1 ETH,èƒ½ä¹°å¤šå°‘ä»£å¸?
    uint256 tokenAmount = (msg.value * 10**decimals) / tokenPrice;
    
    // è®¡ç®—è¿‡ç¨‹:
    // msg.value = 1 ETH = 10^18 wei
    // decimals = 18
    // tokenAmount = (10^18 * 10^18) / (0.001 * 10^18)
    //             = 10^36 / 10^15
    //             = 10^21 æœ€å°å•ä½
    //             = 1000 tokens (10^21 / 10^18)
}</code></pre>
                
                <p style="margin-top: 15px;"><strong>å…¬å¼æ¨å¯¼:</strong></p>
                <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px;">
                    <code>ä»£å¸æ•°é‡ = (æ”¯ä»˜çš„ETH Ã— 10^decimals) Ã· å•ä¸ªä»£å¸ä»·æ ¼</code><br><br>
                    <code>ä¾‹: 1 ETH Ã· 0.001 ETH/token = 1000 tokens</code>
                </div>
            </div>

            <div class="concept-card">
                <div class="concept-title">ğŸ“Š receive() - è‡ªåŠ¨è´­ä¹°</div>
                <pre><code class="language-solidity">receive() external payable {
    buyTokens();
}

// ç”¨æˆ·ç›´æ¥å‘åˆçº¦å‘é€ETH,è‡ªåŠ¨è§¦å‘è´­ä¹°
// ä¸éœ€è¦è°ƒç”¨å‡½æ•°!</code></pre>
                <p><strong>å·¥ä½œåŸç†:</strong></p>
                <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.8;">
                    <li><code class="inline-code">receive()</code>åœ¨åˆçº¦æ”¶åˆ°çº¯ETHæ—¶è‡ªåŠ¨è°ƒç”¨</li>
                    <li>å¿…é¡»æ ‡è®°ä¸º<code class="inline-code">external payable</code></li>
                    <li>ä¸èƒ½æœ‰å‚æ•°,ä¸èƒ½è¿”å›å€¼</li>
                    <li>æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ</li>
                </ul>
            </div>
        </div>

        <div class="section" id="code">
            <h2 class="section-title">
                <i class="fas fa-code"></i> å®Œæ•´ä»£ç è¯¦è§£
            </h2>
            
            <h3 style="color: var(--secondary); margin: 20px 0;">ğŸ“„ æ­¥éª¤1: ä¿®æ”¹SimpleERC20ä¸ºvirtual</h3>
            <pre><code class="language-solidity">// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract SimpleERC20 {
    string public name = "SimpleToken";
    string public symbol = "SIM";
    uint8 public decimals = 18;
    uint256 public totalSupply;
    
    mapping(address => uint256) public balanceOf;
    mapping(address => mapping(address => uint256)) public allowance;
    
    event Transfer(address indexed from, address indexed to, uint256 value);
    event Approval(address indexed owner, address indexed spender, uint256 value);
    
    constructor(uint256 _initialSupply) {
        totalSupply = _initialSupply * (10 ** uint256(decimals));
        balanceOf[msg.sender] = totalSupply;
        emit Transfer(address(0), msg.sender, totalSupply);
    }
    
    function _transfer(address _from, address _to, uint256 _value) internal {
        require(balanceOf[_from] >= _value, "Insufficient balance");
        balanceOf[_from] -= _value;
        balanceOf[_to] += _value;
        emit Transfer(_from, _to, _value);
    }
    
    // âœ… æ·»åŠ virtualå…³é”®å­—
    function transfer(address _to, uint256 _value) public virtual returns (bool) {
        require(_to != address(0), "Invalid address");
        _transfer(msg.sender, _to, _value);
        return true;
    }
    
    function approve(address _spender, uint256 _value) public returns (bool) {
        require(_spender != address(0), "Invalid address");
        allowance[msg.sender][_spender] = _value;
        emit Approval(msg.sender, _spender, _value);
        return true;
    }
    
    // âœ… æ·»åŠ virtualå…³é”®å­—
    function transferFrom(address _from, address _to, uint256 _value) public virtual returns (bool) {
        require(_to != address(0), "Invalid address");
        require(_value <= allowance[_from][msg.sender], "Allowance exceeded");
        allowance[_from][msg.sender] -= _value;
        _transfer(_from, _to, _value);
        return true;
    }
}</code></pre>

            <h3 style="color: var(--secondary); margin: 30px 0 20px 0;">ğŸ“„ æ­¥éª¤2: TokenSaleåˆçº¦(ç»§æ‰¿å¹¶é‡å†™)</h3>
            <pre><code class="language-solidity">// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "./SimpleERC20.sol";

contract SimplifiedTokenSale is SimpleERC20 {
    uint256 public tokenPrice;
    uint256 public saleStartTime;
    uint256 public saleEndTime;
    uint256 public minPurchase;
    uint256 public maxPurchase;
    uint256 public totalRaised;
    address public projectOwner;
    bool public finalized = false;
    bool private initialTransferDone = false;
    
    event TokensPurchased(address indexed buyer, uint256 etherAmount, uint256 tokenAmount);
    event SaleFinalized(uint256 totalRaised, uint256 totalTokensSold);
    
    constructor(
        uint256 _initialSupply,
        uint256 _tokenPrice,
        uint256 _saleStartTime,
        uint256 _saleDuration,
        uint256 _minPurchase,
        uint256 _maxPurchase
    ) SimpleERC20(_initialSupply) {
        tokenPrice = _tokenPrice;
        saleStartTime = _saleStartTime;
        saleEndTime = _saleStartTime + _saleDuration;
        minPurchase = _minPurchase;
        maxPurchase = _maxPurchase;
        projectOwner = msg.sender;
        
        // å°†æ‰€æœ‰ä»£å¸è½¬åˆ°åˆçº¦
        _transfer(msg.sender, address(this), totalSupply);
        initialTransferDone = true;
    }
    
    // æ£€æŸ¥é”€å”®æ˜¯å¦æ¿€æ´»
    function isSaleActive() public view returns (bool) {
        return block.timestamp >= saleStartTime && 
               block.timestamp <= saleEndTime && 
               !finalized;
    }
    
    // è´­ä¹°ä»£å¸
    function buyTokens() public payable {
        require(isSaleActive(), "Sale not active");
        require(msg.value >= minPurchase && msg.value <= maxPurchase, "Invalid purchase amount");
        
        uint256 tokenAmount = (msg.value * 10**uint256(decimals)) / tokenPrice;
        require(balanceOf[address(this)] >= tokenAmount, "Insufficient tokens");
        
        _transfer(address(this), msg.sender, tokenAmount);
        totalRaised += msg.value;
        
        emit TokensPurchased(msg.sender, msg.value, tokenAmount);
    }
    
    // âœ… é‡å†™transfer - æ·»åŠ é”å®šé€»è¾‘
    function transfer(address _to, uint256 _value) public override returns (bool) {
        if (!finalized && msg.sender != address(this) && initialTransferDone) {
            require(false, "Tokens are locked until sale is finalized");
        }
        return super.transfer(_to, _value);
    }
    
    // âœ… é‡å†™transferFrom - æ·»åŠ é”å®šé€»è¾‘
    function transferFrom(address _from, address _to, uint256 _value) public override returns (bool) {
        if (!finalized && _from != address(this) && initialTransferDone) {
            require(false, "Tokens are locked until sale is finalized");
        }
        return super.transferFrom(_from, _to, _value);
    }
    
    // å®Œæˆé”€å”®
    function finalizeSale() public payable {
        require(msg.sender == projectOwner, "Only owner");
        require(block.timestamp > saleEndTime, "Sale not ended");
        require(!finalized, "Already finalized");
        
        finalized = true;
        
        // å°†ç­¹é›†çš„ETHè½¬ç»™é¡¹ç›®æ–¹
        (bool success, ) = projectOwner.call{value: address(this).balance}("");
        require(success, "Transfer failed");
        
        emit SaleFinalized(totalRaised, totalSupply - balanceOf[address(this)]);
    }
    
    // å·¥å…·å‡½æ•°
    function timeRemaining() public view returns (uint256) {
        if (block.timestamp >= saleEndTime) return 0;
        return saleEndTime - block.timestamp;
    }
    
    function tokensAvailable() public view returns (uint256) {
        return balanceOf[address(this)];
    }
    
    // æ¥æ”¶ç›´æ¥å‘é€çš„ETH
    receive() external payable {
        buyTokens();
    }
}</code></pre>

            <div style="background: linear-gradient(135deg, #d4edda, #c3e6cb); border-left: 5px solid #28a745; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <strong style="color: #155724;">âœ… åˆçº¦åŠŸèƒ½</strong>
                <p style="margin-top: 10px; color: #155724;">è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä»£å¸é”€å”®(ICO)åˆçº¦ã€‚é¡¹ç›®æ–¹å¯ä»¥è®¾ç½®ä»£å¸ä»·æ ¼ã€é”€å”®æ—¶é—´ã€è´­ä¹°é™é¢ã€‚æŠ•èµ„è€…åœ¨é”€å”®æœŸé—´è´­ä¹°ä»£å¸,ä½†ä»£å¸è¢«é”å®šã€‚é”€å”®ç»“æŸå,é¡¹ç›®æ–¹å®Œæˆé”€å”®,ä»£å¸è§£é”,æŠ•èµ„è€…å¯ä»¥è‡ªç”±è½¬è´¦ã€‚</p>
            </div>

            <h3 style="color: var(--secondary); margin: 30px 0 20px 0;">ğŸ” å…³é”®ä»£ç è§£æ</h3>
            
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 15px 0;">
                <h4 style="color: var(--primary); margin-bottom: 15px;">1. æ„é€ å‡½æ•°æ‰§è¡Œæµç¨‹</h4>
                <pre><code class="language-solidity">constructor(...) SimpleERC20(_initialSupply) {
    // 1. å…ˆæ‰§è¡Œçˆ¶åˆçº¦æ„é€ å‡½æ•°
    //    - é“¸é€ æ‰€æœ‰ä»£å¸ç»™msg.sender
    //    - balanceOf[deployer] = totalSupply
    
    // 2. è®¾ç½®é”€å”®å‚æ•°
    tokenPrice = _tokenPrice;
    saleStartTime = _saleStartTime;
    saleEndTime = _saleStartTime + _saleDuration;
    // ...
    
    // 3. å°†æ‰€æœ‰ä»£å¸ä»deployerè½¬åˆ°åˆçº¦
    _transfer(msg.sender, address(this), totalSupply);
    // balanceOf[deployer] = 0
    // balanceOf[this contract] = totalSupply
    
    // 4. æ ‡è®°åˆå§‹è½¬è´¦å®Œæˆ
    initialTransferDone = true;
}</code></pre>
            </div>

            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 15px 0;">
                <h4 style="color: var(--primary); margin-bottom: 15px;">2. è´­ä¹°æµç¨‹è¯¦è§£</h4>
                <pre><code class="language-solidity">// åœºæ™¯: Aliceç”¨1 ETHè´­ä¹°ä»£å¸
// tokenPrice = 0.001 ETH

buyTokens{value: 1 ether}();

// æ­¥éª¤1: æ£€æŸ¥é”€å”®æ¿€æ´»
require(isSaleActive());  âœ…

// æ­¥éª¤2: æ£€æŸ¥è´­ä¹°é‡‘é¢
require(1 ether >= minPurchase && 1 ether <= maxPurchase);  âœ…

// æ­¥éª¤3: è®¡ç®—ä»£å¸æ•°é‡
tokenAmount = (1 ether * 10^18) / 0.001 ether
            = (10^18 * 10^18) / (10^15)
            = 10^21 æœ€å°å•ä½
            = 1000 tokens

// æ­¥éª¤4: æ£€æŸ¥åˆçº¦ä½™é¢
require(balanceOf[contract] >= 1000 tokens);  âœ…

// æ­¥éª¤5: è½¬è´¦(åˆçº¦å¯ä»¥è½¬,å› ä¸ºmsg.sender == address(this))
_transfer(address(this), Alice, 1000 tokens);

// æ­¥éª¤6: è®°å½•
totalRaised += 1 ether;

// æ­¥éª¤7: è§¦å‘äº‹ä»¶
emit TokensPurchased(Alice, 1 ether, 1000 tokens);</code></pre>
            </div>

            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 15px 0;">
                <h4 style="color: var(--primary); margin-bottom: 15px;">3. é”å®šæœºåˆ¶è¯¦è§£</h4>
                <pre><code class="language-solidity">// åœºæ™¯1: Aliceè¯•å›¾åœ¨é”€å”®æœŸé—´è½¬è´¦
Aliceè°ƒç”¨: token.transfer(Bob, 100);

æ‰§è¡Œ:
  finalized = false  âœ…
  msg.sender = Alice (ä¸æ˜¯address(this))  âœ…
  initialTransferDone = true  âœ…
  
  require(false, "Tokens are locked");  âŒ å¤±è´¥!

// åœºæ™¯2: åˆçº¦åœ¨è´­ä¹°æ—¶è½¬è´¦ç»™Alice
Contractè°ƒç”¨: _transfer(address(this), Alice, 100);

æ‰§è¡Œ:
  å†…éƒ¨é€šè¿‡super.transfer()è°ƒç”¨
  ä½†msg.senderåœ¨_transferå†…éƒ¨çš„ä¸Šä¸‹æ–‡ä¸åŒ
  å®é™…ä¸Šç›´æ¥ä¿®æ”¹balanceOf,ä¸è§¦å‘é”å®šæ£€æŸ¥  âœ…

// åœºæ™¯3: é”€å”®å®ŒæˆåAliceè½¬è´¦
finalizeSale();  // finalized = true

Aliceè°ƒç”¨: token.transfer(Bob, 100);

æ‰§è¡Œ:
  finalized = true  âœ…
  ifæ¡ä»¶ä¸æ»¡è¶³,ç›´æ¥æ‰§è¡Œsuper.transfer()  âœ…</code></pre>
            </div>
        </div>

        <div class="section" id="practice">
            <h2 class="section-title">
                <i class="fas fa-dumbbell"></i> å®è·µä¸ç»ƒä¹ 
            </h2>
            
            <h3 style="color: var(--secondary); margin-bottom: 20px;">ğŸ“ Remixå®æˆ˜æ­¥éª¤</h3>
            
            <div style="margin: 30px 0;">
                <h4 style="color: var(--primary); margin-bottom: 15px; font-size: 1.2rem;">æ­¥éª¤1: éƒ¨ç½²ä»£å¸é”€å”®</h4>
                <ol style="margin: 10px 0 10px 25px; line-height: 2;">
                    <li>åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶:<code class="inline-code">SimpleERC20.sol</code>å’Œ<code class="inline-code">TokenSale.sol</code></li>
                    <li>ç¼–è¯‘TokenSaleåˆçº¦</li>
                    <li>éƒ¨ç½²å‚æ•°ç¤ºä¾‹:
                        <ul style="margin-left: 20px;">
                            <li>_initialSupply: <code class="inline-code">1000000</code> (100ä¸‡ä»£å¸)</li>
                            <li>_tokenPrice: <code class="inline-code">1000000000000000</code> (0.001 ETH)</li>
                            <li>_saleStartTime: <code class="inline-code">(å½“å‰æ—¶é—´æˆ³)</code></li>
                            <li>_saleDuration: <code class="inline-code">2592000</code> (30å¤©)</li>
                            <li>_minPurchase: <code class="inline-code">10000000000000000</code> (0.01 ETH)</li>
                            <li>_maxPurchase: <code class="inline-code">10000000000000000000</code> (10 ETH)</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <div style="margin: 30px 0;">
                <h4 style="color: var(--primary); margin-bottom: 15px; font-size: 1.2rem;">æ­¥éª¤2: æ£€æŸ¥åˆå§‹çŠ¶æ€</h4>
                <ol style="margin: 10px 0 10px 25px; line-height: 2;">
                    <li>è°ƒç”¨<code class="inline-code">balanceOf(åˆçº¦åœ°å€)</code> - åº”è¯¥ç­‰äºtotalSupply</li>
                    <li>è°ƒç”¨<code class="inline-code">tokensAvailable()</code> - æŸ¥çœ‹å¯å”®ä»£å¸</li>
                    <li>è°ƒç”¨<code class="inline-code">isSaleActive()</code> - åº”è¯¥è¿”å›true</li>
                    <li>è°ƒç”¨<code class="inline-code">timeRemaining()</code> - æŸ¥çœ‹å‰©ä½™æ—¶é—´</li>
                </ol>
            </div>

            <div style="margin: 30px 0;">
                <h4 style="color: var(--primary); margin-bottom: 15px; font-size: 1.2rem;">æ­¥éª¤3: è´­ä¹°ä»£å¸</h4>
                <ol style="margin: 10px 0 10px 25px; line-height: 2;">
                    <li>åˆ‡æ¢åˆ°å¦ä¸€ä¸ªè´¦æˆ·(æŠ•èµ„è€…)</li>
                    <li>åœ¨VALUEè¾“å…¥æ¡†è¾“å…¥0.1,é€‰æ‹©Ether</li>
                    <li>è°ƒç”¨<code class="inline-code">buyTokens</code></li>
                    <li>æŸ¥çœ‹äº‹ä»¶<code class="inline-code">TokensPurchased</code></li>
                    <li>è°ƒç”¨<code class="inline-code">balanceOf(æŠ•èµ„è€…åœ°å€)</code> - åº”è¯¥æœ‰100ä¸ªä»£å¸</li>
                </ol>
            </div>

            <div style="margin: 30px 0;">
                <h4 style="color: var(--primary); margin-bottom: 15px; font-size: 1.2rem;">æ­¥éª¤4: æµ‹è¯•é”å®š</h4>
                <ol style="margin: 10px 0 10px 25px; line-height: 2;">
                    <li>æŠ•èµ„è€…å°è¯•è½¬è´¦:<code class="inline-code">transfer(å¦ä¸€ä¸ªåœ°å€, 10)</code></li>
                    <li>åº”è¯¥å¤±è´¥,é”™è¯¯ä¿¡æ¯:"Tokens are locked until sale is finalized"</li>
                    <li>éªŒè¯ä»£å¸ç¡®å®è¢«é”å®š</li>
                </ol>
            </div>

            <div style="margin: 30px 0;">
                <h4 style="color: var(--primary); margin-bottom: 15px; font-size: 1.2rem;">æ­¥éª¤5: å®Œæˆé”€å”®(æ¨¡æ‹Ÿ)</h4>
                <ol style="margin: 10px 0 10px 25px; line-height: 2;">
                    <li>åœ¨Remixä¸­ä¿®æ”¹<code class="inline-code">saleEndTime</code>ä¸ºè¿‡å»çš„æ—¶é—´(æµ‹è¯•ç”¨)</li>
                    <li>æˆ–è€…ç­‰å¾…å®é™…é”€å”®æœŸç»“æŸ</li>
                    <li>åˆ‡æ¢å›é¡¹ç›®æ–¹è´¦æˆ·</li>
                    <li>è°ƒç”¨<code class="inline-code">finalizeSale()</code></li>
                    <li>æŸ¥çœ‹äº‹ä»¶<code class="inline-code">SaleFinalized</code></li>
                    <li>éªŒè¯<code class="inline-code">finalized() == true</code></li>
                </ol>
            </div>

            <div style="margin: 30px 0;">
                <h4 style="color: var(--primary); margin-bottom: 15px; font-size: 1.2rem;">æ­¥éª¤6: éªŒè¯è§£é”</h4>
                <ol style="margin: 10px 0 10px 25px; line-height: 2;">
                    <li>åˆ‡æ¢å›æŠ•èµ„è€…è´¦æˆ·</li>
                    <li>å†æ¬¡è°ƒç”¨<code class="inline-code">transfer(å¦ä¸€ä¸ªåœ°å€, 10)</code></li>
                    <li>è¿™æ¬¡åº”è¯¥æˆåŠŸ!</li>
                    <li>éªŒè¯ä»£å¸å·²è§£é”,å¯ä»¥è‡ªç”±è½¬è´¦</li>
                </ol>
            </div>

            <h3 style="color: var(--secondary); margin: 40px 0 20px 0;">ğŸ¯ æŒ‘æˆ˜ç»ƒä¹ </h3>
            <div style="background: linear-gradient(135deg, #fff9e6, #ffedd5); border-left: 5px solid var(--medium); padding: 25px; border-radius: 10px;">
                <p style="font-weight: bold; margin-bottom: 15px; font-size: 1.1rem;">å°è¯•ä»¥ä¸‹æ”¹è¿›:</p>
                <ol style="margin-left: 25px; line-height: 2.2;">
                    <li>æ·»åŠ ç™½åå•åŠŸèƒ½(åªæœ‰ç™½åå•åœ°å€å¯ä»¥è´­ä¹°)</li>
                    <li>å®ç°åˆ†é˜¶æ®µé”€å”®(æ—©é¸Ÿä»·ã€æ­£å¸¸ä»·ã€æœ€åå†²åˆºä»·)</li>
                    <li>æ·»åŠ è½¯ä¸Šé™å’Œç¡¬ä¸Šé™</li>
                    <li>å®ç°é€€æ¬¾åŠŸèƒ½(å¦‚æœæ²¡è¾¾åˆ°è½¯ä¸Šé™)</li>
                    <li>æ·»åŠ æ¨èå¥–åŠ±(æ¨èäººè·å¾—é¢å¤–ä»£å¸)</li>
                    <li>å®ç°æ¸è¿›å¼è§£é”(25%ç«‹å³è§£é”,å‰©ä½™åˆ†3ä¸ªæœˆ)</li>
                    <li>æ·»åŠ ç´§æ€¥æš‚åœåŠŸèƒ½</li>
                </ol>
            </div>

            <h3 style="color: var(--secondary); margin: 40px 0 20px 0;">ğŸ“š æ·±å…¥ç†è§£</h3>
            
            <div style="background: white; border: 2px solid var(--accent); padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h4 style="color: var(--primary); margin-bottom: 10px;">virtualã€overrideå’Œsuper</h4>
                <pre><code class="language-solidity">contract A {
    function foo() public virtual returns (string memory) {
        return "A";
    }
}

contract B is A {
    function foo() public override returns (string memory) {
        return "B";
    }
}

contract C is B {
    function foo() public override returns (string memory) {
        string memory parent = super.foo();  // è°ƒç”¨Bçš„foo
        return string.concat(parent, "+C");  // "B+C"
    }
}</code></pre>
            </div>

            <div style="background: white; border: 2px solid var(--accent); padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h4 style="color: var(--primary); margin-bottom: 10px;">çœŸå®ä¸–ç•Œçš„ä»£å¸é”€å”®</h4>
                <p>ç°ä»£ICO/IDOé€šå¸¸åŒ…æ‹¬:</p>
                <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                    <li><strong>KYC/AML</strong>: èº«ä»½éªŒè¯</li>
                    <li><strong>Vesting</strong>: é”ä»“æœŸå’Œé‡Šæ”¾è®¡åˆ’</li>
                    <li><strong>Cliff</strong>: æ‚¬å´–æœŸ(ä¸€æ®µæ—¶é—´åæ‰å¼€å§‹é‡Šæ”¾)</li>
                    <li><strong>Cap</strong>: ä¸ªäººä¸Šé™å’Œæ€»ä¸Šé™</li>
                    <li><strong>Whitelist</strong>: ç™½åå•/ä¼˜å…ˆè´­ä¹°</li>
                    <li><strong>Refund</strong>: æœªè¾¾ç›®æ ‡é€€æ¬¾</li>
</ul>
            </div>

            <div style="background: white; border: 2px solid var(--accent); padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h4 style="color: var(--primary); margin-bottom: 10px;">receive() vs fallback()</h4>
                <pre><code class="language-solidity">// receive: æ¥æ”¶çº¯ETH(æ— data)
receive() external payable {
    buyTokens();
}

// fallback: æ¥æ”¶ETH+data æˆ– è°ƒç”¨ä¸å­˜åœ¨çš„å‡½æ•°
fallback() external payable {
    // å¤„ç†å…¶ä»–æƒ…å†µ
}

// è°ƒç”¨ä¼˜å…ˆçº§:
// 1. å¦‚æœmsg.dataä¸ºç©º -> receive()
// 2. å¦‚æœreceive()ä¸å­˜åœ¨æˆ–msg.dataä¸ä¸ºç©º -> fallback()</code></pre>
            </div>
        </div>

        <div class="navigation-footer">
            <a href="contract-12.html" class="nav-footer-btn" style="border-color: var(--accent);">
                <div class="nav-footer-label">â† ä¸Šä¸€ä¸ª</div>
                <div class="nav-footer-title">MyFirstTokené¦–ä»£å¸</div>
            </a>
            <a href="contract-14.html" class="nav-footer-btn" style="border-color: var(--accent);">
                <div class="nav-footer-label">ä¸‹ä¸€ä¸ª â†’</div>
                <div class="nav-footer-title">SafeDeposit å®‰å…¨ä¿ç®¡ç®±</div>
            </a>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/solidity.min.js"></script>
    <script>
        hljs.highlightAll();
        
        // å¹³æ»‘æ»šåŠ¨
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    </script>
</body>
</html>