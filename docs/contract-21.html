<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SimpleNFT ç®€å•NFTåˆçº¦ - Solidityå­¦ä¹ </title>
    <link href="https://fonts.googleapis.com/css2?family=Gochi+Hand&family=Reenie+Beanie&family=Comic+Neue:ital,wght@0,400;0,700;1,400&family=Fira+Code&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --accent: #4cc9f0;
            --light: #f8f9fa;
            --dark: #212529;
            --easy: #43AA8B;
            --medium: #F8961E;
            --hard: #E71D36;
            --expert: #7209B7;
            --warm-brown: #8B7355;
            --parchment: #F5F1E6;
            --vintage-blue: #6B8E9F;
            --warm-red: #C44536;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Comic Neue', cursive;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf9 100%);
            color: var(--dark);
            line-height: 1.8;
            background-image: radial-gradient(#d0e3ff 1px, transparent 1px);
            background-size: 30px 30px;
        }
        
        .nav-bar {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .nav-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .back-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 10px;
            font-family: 'Comic Neue', cursive;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .back-btn:hover {
            background: var(--secondary);
            transform: translateX(-3px);
        }
        
        .nav-title {
            font-family: 'Gochi Hand', cursive;
            font-size: 1.3rem;
            color: var(--secondary);
        }
        
        .nav-right {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 5px 15px;
            border-radius: 8px;
            font-family: 'Comic Neue', cursive;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }
        
        .nav-btn:hover {
            background: var(--primary);
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        
        .hero-section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 5px 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            border-top: 5px solid var(--accent);
        }
        
        .hero-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .hero-title {
            flex: 1;
            min-width: 250px;
        }
        
        .day-badge {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 8px 20px;
            border-radius: 15px;
            font-family: 'Gochi Hand', cursive;
            font-size: 1.2rem;
            margin-bottom: 10px;
            display: inline-block;
        }
        
        h1 {
            font-family: 'Gochi Hand', cursive;
            font-size: 2.8rem;
            color: var(--secondary);
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 20px;
        }
        
        .meta-tags {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .difficulty-badge {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            color: white;
            font-size: 1rem;
        }
        
        .tag {
            background: var(--light);
            padding: 5px 15px;
            border-radius: 15px;
            color: var(--secondary);
            font-size: 0.9rem;
        }
        
        .section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 3px 3px 10px rgba(0,0,0,0.1);
        }
        
        .section-title {
            font-family: 'Gochi Hand', cursive;
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px dashed var(--accent);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .key-points {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .key-point {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--accent);
        }
        
        .key-point-title {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .concept-card {
            background: linear-gradient(135deg, #fff5f5, #ffe6e6);
            border-left: 5px solid var(--hard);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .concept-card.important {
            background: linear-gradient(135deg, #fff9e6, #ffedd5);
            border-left-color: var(--medium);
        }
        
        .concept-card.tip {
            background: linear-gradient(135deg, #e6f7ff, #d6f0ff);
            border-left-color: var(--primary);
        }
        
        .concept-title {
            font-family: 'Gochi Hand', cursive;
            font-size: 1.4rem;
            color: var(--secondary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        pre {
            background: #282c34;
            border-radius: 10px;
            padding: 20px;
            overflow-x: auto;
            margin: 15px 0;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.3);
        }
        
        code {
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            color: #f8f8f2;
        }
        
        .inline-code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Fira Code', monospace;
            color: var(--hard);
            font-size: 0.9em;
        }
        
        .warning-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 15px 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .warning-box strong {
            color: #ff6b35;
        }
        
        .success-box {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 15px 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .comparison-table th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }
        
        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .comparison-table tr:hover {
            background: #f8f9fa;
        }
        
        .steps-list {
            counter-reset: step-counter;
            list-style: none;
            padding-left: 0;
        }
        
        .steps-list li {
            counter-increment: step-counter;
            margin-bottom: 20px;
            padding-left: 60px;
            position: relative;
        }
        
        .steps-list li::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            background: var(--accent);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-family: 'Gochi Hand', cursive;
            font-size: 1.2rem;
        }
        
        .navigation-footer {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .nav-footer-btn {
            flex: 1;
            min-width: 200px;
            background: white;
            border: 3px solid var(--primary);
            padding: 20px;
            border-radius: 15px;
            text-decoration: none;
            color: var(--dark);
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .nav-footer-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .nav-footer-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .nav-footer-title {
            font-family: 'Gochi Hand', cursive;
            font-size: 1.3rem;
        }        
        /* å‚è€ƒç­”æ¡ˆæ¨¡å—æ ·å¼ - æ¸©æš–æ²»æ„ˆé£æ ¼ */
        .answer-reference {
            position: relative;
            margin: 60px 0 30px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .envelope-container {
            position: relative;
            width: 340px;
            height: 240px;
            cursor: pointer;
            perspective: 1200px;
            margin-bottom: 20px;
            filter: drop-shadow(0 10px 20px rgba(139, 115, 85, 0.2));
        }
        
        .envelope {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 1s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        .envelope-front, .envelope-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .envelope-front {
            background: linear-gradient(135deg, #f9f3e9, #e8dfd1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 1px solid #d4c9b8;
        }
        
        .envelope-flap {
            position: absolute;
            top: -70px;
            width: 0;
            height: 0;
            border-left: 170px solid transparent;
            border-right: 170px solid transparent;
            border-bottom: 70px solid #e8dfd1;
            z-index: 1;
            filter: drop-shadow(0 2px 3px rgba(0,0,0,0.1));
        }
        
        .envelope-flap::after {
            content: "";
            position: absolute;
            top: 3px;
            left: -170px;
            width: 0;
            height: 0;
            border-left: 170px solid transparent;
            border-right: 170px solid transparent;
            border-bottom: 67px solid #f9f3e9;
        }
        
        .envelope-seal {
            position: absolute;
            bottom: 25px;
            right: 35px;
            width: 70px;
            height: 70px;
            background: radial-gradient(circle at 30% 30%, #C44536, #8B2E24);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 2;
            border: 2px solid #A52A2A;
        }
        
        .seal-icon {
            color: #F5F1E6;
            font-size: 1.8rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .envelope-text {
            font-family: 'Reenie Beanie', cursive;
            font-size: 2.4rem;
            color: var(--warm-brown);
            z-index: 2;
            position: relative;
            margin-top: 20px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            letter-spacing: 1px;
        }
        
        .envelope-pattern {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 15% 25%, rgba(139, 115, 85, 0.05) 3px, transparent 3px),
                radial-gradient(circle at 85% 75%, rgba(139, 115, 85, 0.05) 3px, transparent 3px);
            background-size: 40px 40px;
            z-index: 0;
        }
        
        .envelope-back {
            background: linear-gradient(135deg, #f5f1e6, #e8dfd1);
            transform: rotateY(180deg);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #d4c9b8;
        }
        
        .envelope-container:hover .envelope {
            transform: rotateY(10deg) translateY(-5px);
        }
        
        .envelope-container.open .envelope {
            transform: rotateY(180deg);
        }
        
        .envelope-hint {
            font-family: 'Gochi Hand', cursive;
            font-size: 1.3rem;
            color: var(--warm-brown);
            margin-top: 15px;
            opacity: 0.9;
            background: rgba(245, 241, 230, 0.7);
            padding: 8px 20px;
            border-radius: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        /* å¼¹çª—æ ·å¼ */
        .answer-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2000;
            background: rgba(107, 142, 159, 0.7);
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(3px);
        }
        
        .letter-container {
            width: 90%;
            max-width: 900px;
            height: 80vh;
            background: #F5F1E6;
            border-radius: 12px;
            box-shadow: 0 20px 50px rgba(107, 142, 159, 0.4);
            overflow: hidden;
            transform: scale(0);
            transition: transform 0.7s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            flex-direction: column;
            position: relative;
            border: 1px solid #d4c9b8;
        }
        
        .answer-modal.open .letter-container {
            transform: scale(1);
        }
        
        .letter-header {
            background: linear-gradient(135deg, #8B7355, #6B5A45);
            padding: 25px 30px;
            position: relative;
            display: flex;
            flex-direction: column;
            gap: 10px;
            border-bottom: 2px dashed #A5947A;
        }
        
        .letter-title {
            font-family: 'Reenie Beanie', cursive;
            font-size: 3rem;
            color: #F5F1E6;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            letter-spacing: 2px;
        }
        
        .letter-subtitle {
            color: rgba(245, 241, 230, 0.9);
            font-size: 1.3rem;
            font-family: 'Gochi Hand', cursive;
        }
        
        .close-letter {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(245, 241, 230, 0.2);
            color: #F5F1E6;
            border: 1px solid rgba(245, 241, 230, 0.3);
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            backdrop-filter: blur(5px);
        }
        
        .close-letter:hover {
            background: rgba(245, 241, 230, 0.3);
            transform: rotate(90deg);
        }
        
        .letter-body {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
            background: #F5F1E6;
            position: relative;
        }
        
        .letter-body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            background-image: 
                linear-gradient(90deg, transparent 98%, rgba(139, 115, 85, 0.1) 98%),
                linear-gradient(rgba(139, 115, 85, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            pointer-events: none;
        }
        
        /* MDå†…å®¹æ ·å¼ */
        .md-content {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        
        .md-section {
            margin-bottom: 40px;
        }
        
        .md-section h1 {
            font-family: 'Reenie Beanie', cursive;
            font-size: 3rem;
            color: var(--warm-brown);
            margin-bottom: 20px;
            border-bottom: 2px dashed #A5947A;
            padding-bottom: 10px;
            text-align: center;
        }
        
        .md-section h2 {
            font-family: 'Reenie Beanie', cursive;
            font-size: 2.2rem;
            color: var(--warm-brown);
            margin: 30px 0 15px 0;
            position: relative;
            padding-left: 25px;
        }
        
        .md-section h2::before {
            content: "â€¢";
            position: absolute;
            left: 0;
            top: 0;
            color: var(--warm-red);
            font-size: 2.5rem;
        }
        
        .md-meta {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .md-tag {
            background: rgba(139, 115, 85, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
            color: var(--warm-brown);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            border: 1px solid rgba(139, 115, 85, 0.2);
        }
        
        .md-highlight {
            background: rgba(107, 142, 159, 0.1);
            border-left: 5px solid var(--vintage-blue);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border: 1px solid rgba(107, 142, 159, 0.2);
        }
        
        .md-content pre {
            background: #2d2a2e;
            border-radius: 10px;
            padding: 20px;
            overflow-x: auto;
            margin: 20px 0;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.3), 0 5px 15px rgba(0,0,0,0.1);
            border: 1px solid #3a363b;
        }
        
        .md-content code {
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            color: #f8f8f2;
        }
        
        .md-content .inline-code {
            background: rgba(139, 115, 85, 0.1);
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Fira Code', monospace;
            color: var(--warm-brown);
            font-size: 0.9em;
            border: 1px solid rgba(139, 115, 85, 0.2);
        }
        
        .md-content ul, .md-content ol {
            margin-left: 25px;
            margin-bottom: 15px;
        }
        
        .md-content li {
            margin-bottom: 8px;
            line-height: 1.7;
        }
        
        .md-content blockquote {
            border-left: 4px solid var(--vintage-blue);
            padding-left: 20px;
            margin: 20px 0;
            font-style: italic;
            color: #666;
            background: rgba(107, 142, 159, 0.05);
            padding: 15px 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .md-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid rgba(139, 115, 85, 0.2);
        }
        
        .md-content th, .md-content td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(139, 115, 85, 0.2);
        }
        
        .md-content th {
            background: linear-gradient(135deg, var(--warm-brown), #6B5A45);
            color: #F5F1E6;
            font-weight: bold;
            font-family: 'Gochi Hand', cursive;
            font-size: 1.1rem;
        }
        
        .md-content tr:nth-child(even) {
            background: rgba(139, 115, 85, 0.05);
        }
        
        .signature {
            text-align: right;
            margin-top: 40px;
            font-family: 'Reenie Beanie', cursive;
            font-size: 2rem;
            color: var(--warm-brown);
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .hero-section {
                padding: 25px;
            }
            
            .section {
            padding: 20px;
            }
            
            .key-points {
                grid-template-columns: 1fr;
            }
            
            .envelope-container {
                width: 300px;
                height: 210px;
            }
            
            .envelope-flap {
                border-left: 150px solid transparent;
                border-right: 150px solid transparent;
                border-bottom: 60px solid #e8dfd1;
            }
            
            .envelope-flap::after {
                border-left: 150px solid transparent;
                border-right: 150px solid transparent;
                border-bottom: 57px solid #f9f3e9;
                left: -150px;
            }
            
            .envelope-text {
                font-size: 2rem;
            }
            
            .answer-modal {
                padding: 10px;
            }
            
            .letter-container {
                width: 95%;
                height: 85vh;
            }
            
            .letter-title {
                font-size: 2.2rem;
            }
            
            .md-section h1 {
                font-size: 2.2rem;
            }
            
            .md-section h2 {
                font-size: 1.8rem;
            }
        }
    
        /* éšè— mermaid æ¸²æŸ“ç»„ä»¶ */
        .md-content section.js-render-needs-enrichment,
        .md-content .js-render-enrichment-target,
        .md-content .js-render-block-actions,
        .md-content .render-container,
        .md-content .js-render-enrichment-fallback,
        .md-content details[class*="details"],
        .md-content iframe[title="File display"] {
            display: none !important;
        }
        
        /* ä¿®å¤ GitHub ä»£ç å—æ ·å¼ */
        .md-content .highlight,
        .md-content .highlight-source-solidity,
        .md-content .highlight-source-js,
        .md-content .highlight-source-javascript {
            background: #2d2a2e !important;
            border-radius: 10px;
            padding: 20px !important;
            overflow-x: auto;
            margin: 20px 0;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.3), 0 5px 15px rgba(0,0,0,0.1);
            border: 1px solid #3a363b;
        }
        
        .md-content .highlight pre,
        .md-content .highlight-source-solidity pre,
        .md-content .highlight-source-js pre {
            background: transparent !important;
            padding: 0 !important;
            margin: 0 !important;
            border: none !important;
        }
        
        .md-content .highlight code,
        .md-content .highlight pre code,
        .md-content .highlight pre span,
        .md-content .highlight pre {
            color: #f8f8f2 !important;
            font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        
        /* ç¡®ä¿æ‰€æœ‰ä»£ç å—å†…çš„æ–‡æœ¬éƒ½å¯è§ */
        .md-content .highlight pre * {
            color: #f8f8f2 !important;
        }
        
        /* GitHub è¯­æ³•é«˜äº®ç±»é¢œè‰²ä¿®å¤ */
        .md-content .highlight [class*="pl-"] {
            color: #f8f8f2 !important;
        }
        
        /* ç‰¹å®šç±»å‹çš„é¢œè‰² */
        .md-content .highlight .pl-c,   /* æ³¨é‡Š */
        .md-content .highlight .pl-c1 {  /* å¸¸é‡ */
            color: #6a9955 !important;
        }
        
        .md-content .highlight .pl-s,   /* å­—ç¬¦ä¸² */
        .md-content .highlight .pl-s1 {   /* å­—ç¬¦ä¸² */
            color: #ce9178 !important;
        }
        
        .md-content .highlight .pl-k,   /* å…³é”®å­— */
        .md-content .highlight .pl-en {  /* å‡½æ•°å */
            color: #569cd6 !important;
        }
        
        .md-content .highlight .pl-v,   /* å˜é‡ */
        .md-content .highlight .pl-e {    /* å®ä½“ */
            color: #dcdcaa !important;
        }
        
        /* å†…è” code æ ‡ç­¾æ ·å¼ */
        .md-content code:not(pre code) {
            background: rgba(139, 115, 85, 0.15) !important;
            padding: 3px 8px !important;
            border-radius: 4px !important;
            color: var(--warm-brown) !important;
            font-family: 'Fira Code', 'Consolas', 'Monaco', monospace !important;
            font-size: 0.9em !important;
            border: 1px solid rgba(139, 115, 85, 0.2) !important;
        }
        
        </style>
</head>
<body>
    <div class="nav-bar">
        <div class="nav-left">
        <a href="index.html" class="back-btn">
            <i class="fas fa-arrow-left"></i> è¿”å›é¦–é¡µ
        </a>
            <span class="nav-title">ç¬¬21å¤©</span>
        </div>
        <div class="nav-right">
            <a href="#concepts" class="nav-btn">ğŸ“š æ ¸å¿ƒæ¦‚å¿µ</a>
            <a href="#code" class="nav-btn">ğŸ’» ä»£ç è®²è§£</a>
            <a href="#practice" class="nav-btn">ğŸ¯ ç»ƒä¹ </a>
        </div>
    </div>

    <div class="container">
        <div class="hero-section">
            <div class="hero-header">
                <div class="hero-title">
                    <div class="day-badge">ç¬¬ 21 å¤©</div>
                    <h1>ğŸ¨ SimpleNFT ç®€å•NFTåˆçº¦</h1>
                    <p class="subtitle">ä»é›¶å®ç°ERC-721æ ‡å‡† - æ·±å…¥ç†è§£éåŒè´¨åŒ–ä»£å¸çš„æ ¸å¿ƒæœºåˆ¶</p>
                </div>
                <div class="meta-tags">
                    <div class="difficulty-badge" style="background: var(--expert);">
                        å›°éš¾ â­â­â­â­
                    </div>
                    <span class="tag">ERC-721</span>
                    <span class="tag">NFT</span>
                    <span class="tag">å…ƒæ•°æ®</span>
                    <span class="tag">æ‰€æœ‰æƒè¿½è¸ª</span>
                </div>
            </div>
            
            <div class="key-points">
                <div class="key-point">
                    <div class="key-point-title">ğŸ¯ å­¦ä¹ ç›®æ ‡</div>
                    <div>ä»é›¶å®ç°å®Œæ•´çš„ERC-721æ ‡å‡†ï¼Œæ·±å…¥ç†è§£NFTæ ¸å¿ƒæœºåˆ¶</div>
                </div>
                <div class="key-point">
                    <div class="key-point-title">ğŸ› ï¸ æ ¸å¿ƒæŠ€èƒ½</div>
                    <div>ERC-721æ ‡å‡†ã€æ˜ å°„è®¾è®¡ã€æ‰¹å‡†æœºåˆ¶ã€å®‰å…¨è½¬è´¦</div>
                </div>
                <div class="key-point">
                    <div class="key-point-title">â° é¢„è®¡æ—¶é—´</div>
                    <div>4-5å°æ—¶ (ç†è§£+ç¼–ç +æµ‹è¯•)</div>
                </div>
                <div class="key-point">
                    <div class="key-point-title">ğŸ“Š ä¸»è§‚æ„Ÿå—éš¾åº¦</div>
                    <div>â­â­â­â­â­ æéš¾ - ERC-721æ ‡å‡†çš„å®Œæ•´å®ç°å’Œå¤æ‚çŠ¶æ€ç®¡ç†</div>
                </div>
            </div>
            
            <div class="key-points" style="margin-top: 20px;">
                <div class="key-point">
                    <div class="key-point-title">ğŸ¯ ERC-721æ ‡å‡†</div>
                    <div>å®Œæ•´å®ç°NFTæ ‡å‡†çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½</div>
                </div>
                <div class="key-point">
                    <div class="key-point-title">ğŸ”‘ å”¯ä¸€æ€§ä¿è¯</div>
                    <div>æ¯ä¸ªtokenIdå¯¹åº”å”¯ä¸€çš„æ‰€æœ‰è€…å’Œå…ƒæ•°æ®</div>
                </div>
                <div class="key-point">
                    <div class="key-point-title">âœ… åŒå±‚æ‰¹å‡†</div>
                    <div>æ”¯æŒå•ä¸ªNFTæ‰¹å‡†å’Œå…¨éƒ¨NFTçš„æ“ä½œå‘˜æ‰¹å‡†</div>
                </div>
                <div class="key-point">
                    <div class="key-point-title">ğŸ›¡ï¸ å®‰å…¨è½¬è´¦</div>
                    <div>å®ç°IERC721Receiveræ¥å£æ£€æŸ¥,é˜²æ­¢NFTä¸¢å¤±</div>
                </div>
            </div>
        </div>

        <div class="section" id="concepts">
            <h2 class="section-title">
                <i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µ
            </h2>
            
            <div class="concept-card">
                <div class="concept-title">ğŸ†š ERC-721 vs ERC-20 æœ¬è´¨åŒºåˆ«</div>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>ç‰¹æ€§ç»´åº¦</th>
                            <th>ERC-20 (åŒè´¨åŒ–ä»£å¸)</th>
                            <th>ERC-721 (éåŒè´¨åŒ–ä»£å¸)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>å¯æ›¿ä»£æ€§</strong></td>
                            <td>å®Œå…¨å¯æ›¿ä»£,1 USDC = 1 USDC</td>
                            <td>ç‹¬ä¸€æ— äºŒ,NFT #1 â‰  NFT #2</td>
                        </tr>
                        <tr>
                            <td><strong>æ•°é‡è¡¨ç¤º</strong></td>
                            <td>uint256 ä½™é¢(å¯åˆ†å‰²)</td>
                            <td>tokenId(ä¸å¯åˆ†å‰²)</td>
                        </tr>
                        <tr>
                            <td><strong>æ‰€æœ‰æƒè®°å½•</strong></td>
                            <td>mapping(address => uint256)</td>
                            <td>mapping(uint256 => address)</td>
                        </tr>
                        <tr>
                            <td><strong>è½¬è´¦é€»è¾‘</strong></td>
                            <td>å‡å°‘å‘é€è€…ä½™é¢,å¢åŠ æ¥æ”¶è€…ä½™é¢</td>
                            <td>æ”¹å˜ç‰¹å®štokenIdçš„æ‰€æœ‰è€…</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="concept-card important">
                <div class="concept-title">ğŸ”‘ NFTçš„äº”å¤§æ ¸å¿ƒçŠ¶æ€æ˜ å°„</div>
                <p>ç†è§£è¿™äº›mappingæ˜¯æŒæ¡NFTçš„å…³é”®:</p>
                <pre><code class="language-solidity">// 1. tokenId â†’ æ‰€æœ‰è€…åœ°å€ (æ ¸å¿ƒ!)
mapping(uint256 => address) private _owners;

// 2. åœ°å€ â†’ æ‹¥æœ‰çš„NFTæ•°é‡
mapping(address => uint256) private _balances;

// 3. tokenId â†’ è¢«æ‰¹å‡†çš„åœ°å€(å•ä¸ªæˆæƒ)
mapping(uint256 => address) private _tokenApprovals;

// 4. æ‰€æœ‰è€… â†’ æ“ä½œå‘˜ â†’ æ˜¯å¦æ‰¹å‡†å…¨éƒ¨(æ‰¹é‡æˆæƒ)
mapping(address => mapping(address => bool)) private _operatorApprovals;

// 5. tokenId â†’ å…ƒæ•°æ®URI
mapping(uint256 => string) private _tokenURIs;</code></pre>
                
                <div class="warning-box">
                    <strong>ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦ä¸¤ä¸ªbalance?</strong><br>
                    _owners[tokenId]: å¿«é€ŸæŸ¥è¯¢"è¿™ä¸ªNFTå±äºè°?"<br>
                    _balances[address]: å¿«é€ŸæŸ¥è¯¢"è¿™ä¸ªäººæœ‰å¤šå°‘ä¸ªNFT?"<br>
                    è™½ç„¶å¯ä»¥éå†æ‰€æœ‰tokenIdæ¥è®¡ç®—ä½™é¢,ä½†gasæˆæœ¬æé«˜!ä¸¤ä¸ªmappingå®ç°O(1)æŸ¥è¯¢,ç”¨ç©ºé—´æ¢æ—¶é—´ã€‚
                </div>
            </div>

            <div class="concept-card tip">
                <div class="concept-title">ğŸ« åŒå±‚æ‰¹å‡†æœºåˆ¶è¯¦è§£</div>
                <p>NFTçš„æˆæƒæ¯”ERC-20æ›´å¤æ‚,æ”¯æŒä¸¤ç§æ¨¡å¼:</p>
                
                <ol class="steps-list">
                    <li>
                        <strong>å•ä¸ªNFTæ‰¹å‡† (approve)</strong><br>
                        æˆæƒç‰¹å®šåœ°å€è½¬ç§»ç‰¹å®šçš„ä¸€ä¸ªNFT<br>
                        ä¾‹: æ‰¹å‡†Bobè½¬ç§»æˆ‘çš„NFT #42
                    </li>
                    <li>
                        <strong>å…¨éƒ¨NFTæ‰¹å‡† (setApprovalForAll)</strong><br>
                        æˆæƒæ“ä½œå‘˜ç®¡ç†æˆ‘çš„æ‰€æœ‰NFT<br>
                        ä¾‹: æ‰¹å‡†OpenSeaæ“ä½œæˆ‘çš„æ‰€æœ‰NFT
                    </li>
                </ol>

                <div class="warning-box">
                    <strong>âš ï¸ å®‰å…¨é£é™©:</strong> setApprovalForAlléå¸¸å¼ºå¤§,æ„å‘³ç€æ“ä½œå‘˜å¯ä»¥è½¬ç§»ä½ çš„æ‰€æœ‰NFT!åªæˆæƒç»™ä½ å®Œå…¨ä¿¡ä»»çš„åˆçº¦ã€‚è®¸å¤šNFTç›—çªƒæ¡ˆéƒ½æºäºæ¶æ„åˆçº¦è·å–äº†å…¨éƒ¨æ‰¹å‡†ã€‚
                </div>
            </div>

            <div class="concept-card">
                <div class="concept-title">ğŸ›¡ï¸ å®‰å…¨è½¬è´¦ vs æ™®é€šè½¬è´¦</div>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>å¯¹æ¯”é¡¹</th>
                            <th>transferFrom</th>
                            <th>safeTransferFrom</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>æ¥æ”¶è€…æ£€æŸ¥</strong></td>
                            <td>ä¸æ£€æŸ¥</td>
                            <td>æ£€æŸ¥æ˜¯å¦èƒ½æ¥æ”¶NFT</td>
                        </tr>
                        <tr>
                            <td><strong>è½¬ç»™EOA</strong></td>
                            <td>âœ… å®‰å…¨</td>
                            <td>âœ… å®‰å…¨</td>
                        </tr>
                        <tr>
                            <td><strong>è½¬ç»™åˆçº¦</strong></td>
                            <td>âš ï¸ å¯èƒ½ä¸¢å¤±</td>
                            <td>âœ… å®‰å…¨(éœ€å®ç°æ¥æ”¶å™¨)</td>
                        </tr>
                        <tr>
                            <td><strong>æ¨èåœºæ™¯</strong></td>
                            <td>æ˜ç¡®çŸ¥é“æ¥æ”¶è€…</td>
                            <td>ä¸ç¡®å®šæ¥æ”¶è€…ç±»å‹</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section" id="code">
            <h2 class="section-title">
                <i class="fas fa-code"></i> ä»£ç è¯¦è§£
            </h2>
            
            <h3>ğŸ“¦ çŠ¶æ€å˜é‡ä¸æ„é€ å‡½æ•°</h3>
            <pre><code class="language-solidity">string public name;
string public symbol;

uint256 private _tokenIdCounter;  // è‡ªå¢IDç”Ÿæˆå™¨

// äº”å¤§æ ¸å¿ƒæ˜ å°„
mapping(uint256 => address) private _owners;
mapping(address => uint256) private _balances;
mapping(uint256 => address) private _tokenApprovals;
mapping(address => mapping(address => bool)) private _operatorApprovals;
mapping(uint256 => string) private _tokenURIs;

constructor(string memory _name, string memory _symbol) {
    name = _name;
    symbol = _symbol;
}</code></pre>

            <h3>ğŸ” æŸ¥è¯¢å‡½æ•°</h3>
            <pre><code class="language-solidity">// æŸ¥è¯¢åœ°å€æ‹¥æœ‰çš„NFTæ•°é‡
function balanceOf(address owner) public view returns (uint256) {
    require(owner != address(0), "Invalid address");
    return _balances[owner];
}

// æŸ¥è¯¢NFTçš„æ‰€æœ‰è€…
function ownerOf(uint256 tokenId) public view returns (address) {
    address owner = _owners[tokenId];
    require(owner != address(0), "Token doesn't exist");
    return owner;
}</code></pre>

            <h3>âœ… æ‰¹å‡†ç®¡ç†</h3>
            <pre><code class="language-solidity">// æ‰¹å‡†å•ä¸ªNFT
function approve(address to, uint256 tokenId) public {
    address owner = ownerOf(tokenId);
    
    // åªæœ‰æ‰€æœ‰è€…å¯ä»¥æ‰¹å‡†
    require(msg.sender == owner, "Not the owner");
    
    // ä¸èƒ½æ‰¹å‡†ç»™è‡ªå·±
    require(to != owner, "Approval to current owner");
    
    _tokenApprovals[tokenId] = to;
}

// æ‰¹å‡†æ‰€æœ‰NFT
function setApprovalForAll(address operator, bool approved) public {
    require(operator != msg.sender, "Approve to caller");
    _operatorApprovals[msg.sender][operator] = approved;
}</code></pre>

            <h3>ğŸ”„ è½¬è´¦åŠŸèƒ½</h3>
            <pre><code class="language-solidity">// æ™®é€šè½¬è´¦
function transferFrom(address from, address to, uint256 tokenId) public {
    require(_isApprovedOrOwner(msg.sender, tokenId), "Not approved");
    _transfer(from, to, tokenId);
}

// å®‰å…¨è½¬è´¦
function safeTransferFrom(address from, address to, uint256 tokenId) public {
    safeTransferFrom(from, to, tokenId, "");
}

function safeTransferFrom(
    address from, 
    address to, 
    uint256 tokenId, 
    bytes memory data
) public {
    require(_isApprovedOrOwner(msg.sender, tokenId), "Not approved");
    _safeTransfer(from, to, tokenId, data);
}</code></pre>

            <h3>ğŸ”¨ é“¸é€ åŠŸèƒ½</h3>
            <pre><code class="language-solidity">function mint(address to, string memory uri) public returns (uint256) {
    // ç”Ÿæˆæ–°çš„tokenId
    uint256 tokenId = _tokenIdCounter;
    _tokenIdCounter++;
    
    // è®¾ç½®æ‰€æœ‰è€…
    _owners[tokenId] = to;
    
    // å¢åŠ ä½™é¢
    _balances[to]++;
    
    // è®¾ç½®å…ƒæ•°æ®URI
    _tokenURIs[tokenId] = uri;
    
    return tokenId;
}</code></pre>

            <div class="warning-box">
                <strong>âš ï¸ æ³¨æ„:</strong> è¿™ä¸ªmintå‡½æ•°æ˜¯publicçš„,æ„å‘³ç€ä»»ä½•äººéƒ½å¯ä»¥é“¸é€ !çœŸå®é¡¹ç›®åº”è¯¥æ·»åŠ è®¿é—®æ§åˆ¶(onlyOwner)æˆ–æ”¯ä»˜æœºåˆ¶ã€‚
            </div>

            <h3>ğŸ”§ å†…éƒ¨è¾…åŠ©å‡½æ•°</h3>
            <pre><code class="language-solidity">// æ ¸å¿ƒè½¬è´¦é€»è¾‘
function _transfer(address from, address to, uint256 tokenId) internal {
    // éªŒè¯fromæ˜¯çœŸæ­£çš„æ‰€æœ‰è€…
    require(ownerOf(tokenId) == from, "Not the owner");
    require(to != address(0), "Invalid address");
    
    // æ¸…é™¤æ‰¹å‡†(è½¬è´¦åæ‰¹å‡†å¤±æ•ˆ)
    _tokenApprovals[tokenId] = address(0);
    
    // æ›´æ–°ä½™é¢
    _balances[from]--;
    _balances[to]++;
    
    // è½¬ç§»æ‰€æœ‰æƒ
    _owners[tokenId] = to;
}

// æ£€æŸ¥æ˜¯å¦æœ‰æƒé™è½¬ç§»
function _isApprovedOrOwner(address spender, uint256 tokenId) 
    internal view returns (bool) 
{
    address owner = ownerOf(tokenId);
    return (
        spender == owner ||                           // æ˜¯æ‰€æœ‰è€…
        getApproved(tokenId) == spender ||        // è¢«å•ç‹¬æ‰¹å‡†
        isApprovedForAll(owner, spender)          // æ˜¯æ“ä½œå‘˜
    );
}</code></pre>
        </div>

        <div class="section" id="practice">
            <h2 class="section-title">
                <i class="fas fa-dumbbell"></i> å®è·µè¦ç‚¹
            </h2>
            
            <div class="concept-card">
                <div class="concept-title">ğŸ“ å®Œæ•´çš„NFTç”Ÿå‘½å‘¨æœŸ</div>
                <p><strong>ä»»åŠ¡:</strong> æ¨¡æ‹Ÿä¸€ä¸ªNFTä»é“¸é€ åˆ°è½¬ç§»çš„å®Œæ•´æµç¨‹</p>
                <pre><code class="language-solidity">// 1. éƒ¨ç½²åˆçº¦
SimpleNFT nft = new SimpleNFT("MyNFT", "MNFT");

// 2. Aliceé“¸é€ NFT
uint256 tokenId = nft.mint(alice, "ipfs://QmX...metadata");
// tokenId = 0 (ç¬¬ä¸€ä¸ªNFT)

// 3. æ£€æŸ¥æ‰€æœ‰æƒ
address owner = nft.ownerOf(0);  // è¿”å› alice
uint256 balance = nft.balanceOf(alice);  // è¿”å› 1

// 4. Aliceæ‰¹å‡†Bobè½¬ç§»
nft.approve(bob, 0);

// 5. Bobæ‰§è¡Œè½¬è´¦ç»™Charlie
nft.transferFrom(alice, charlie, 0);

// 6. éªŒè¯ç»“æœ
owner = nft.ownerOf(0);  // ç°åœ¨æ˜¯ charlie
balance = nft.balanceOf(alice);  // å˜æˆ 0
balance = nft.balanceOf(charlie);  // å˜æˆ 1
address approved = nft.getApproved(0);  // å˜æˆ address(0)</code></pre>
            </div>

            <div class="concept-card important">
                <div class="concept-title">ğŸ”§ å®ç°æ‰¹é‡é“¸é€ </div>
                <p><strong>ç›®æ ‡:</strong> æ·»åŠ ä¸€ä¸ªæ‰¹é‡é“¸é€ å‡½æ•°</p>
                <pre><code class="language-solidity">function batchMint(
    address to, 
    string[] memory uris
) public returns (uint256[] memory) {
    // TODO: å®ç°æ‰¹é‡é“¸é€ é€»è¾‘
    // 1. åˆ›å»ºè¿”å›æ•°ç»„
    // 2. å¾ªç¯è°ƒç”¨mint
    // 3. è¿”å›æ‰€æœ‰tokenId
}</code></pre>
                <div class="success-box">
                    <strong>ğŸ’¡ æ€è€ƒé¢˜:</strong><br>
                    â€¢ å¦‚ä½•é™åˆ¶å•æ¬¡æœ€å¤šé“¸é€ å¤šå°‘ä¸ª?(é˜²æ­¢gasè€—å°½)<br>
                    â€¢ æ˜¯å¦åº”è¯¥æ·»åŠ è®¿é—®æ§åˆ¶?<br>
                    â€¢ å¦‚ä½•ä¼˜åŒ–gasæˆæœ¬?
                </div>
            </div>

            <div class="concept-card tip">
                <div class="concept-title">ğŸ¯ å®ç°NFTé”€æ¯åŠŸèƒ½</div>
                <p><strong>ä»»åŠ¡:</strong> æ·»åŠ burnå‡½æ•°,å…è®¸æ‰€æœ‰è€…é”€æ¯NFT</p>
                <pre><code class="language-solidity">function burn(uint256 tokenId) public {
    // TODO: å®ç°é”€æ¯é€»è¾‘
    // 1. æ£€æŸ¥è°ƒç”¨è€…æ˜¯æ‰€æœ‰è€…æˆ–è¢«æ‰¹å‡†
    // 2. æ¸…é™¤æ‰¹å‡†
    // 3. å‡å°‘ä½™é¢
    // 4. åˆ é™¤æ‰€æœ‰è€…è®°å½•
    // 5. åˆ é™¤tokenURI
}</code></pre>
                <div class="warning-box">
                    <strong>âš ï¸ æ³¨æ„:</strong> é”€æ¯å,ownerOfåº”è¯¥revert,balanceOfåº”è¯¥å‡å°‘ã€‚
                </div>
            </div>

            <div class="concept-card">
                <div class="concept-title">âš¡ å®ç°æšä¸¾åŠŸèƒ½</div>
                <p><strong>é«˜çº§ä»»åŠ¡:</strong> æ·»åŠ å‡½æ•°æ¥æšä¸¾æŸåœ°å€çš„æ‰€æœ‰NFT</p>
                <pre><code class="language-solidity">// éœ€è¦æ·»åŠ æ–°çš„çŠ¶æ€å˜é‡
mapping(address => uint256[]) private _ownedTokens;
mapping(uint256 => uint256) private _ownedTokensIndex;

// å®ç°ERC-721 Enumerableæ‰©å±•
function tokenOfOwnerByIndex(address owner, uint256 index) 
    public view returns (uint256) 
{
    // TODO: è¿”å›ownerçš„ç¬¬indexä¸ªNFT
}

function tokensOfOwner(address owner) 
    public view returns (uint256[] memory) 
{
    // TODO: è¿”å›ownerçš„æ‰€æœ‰NFT
}</code></pre>
                <div class="success-box">
                    <strong>ğŸ’¡ æç¤º:</strong> è½¬è´¦æ—¶éœ€è¦åŒæ­¥æ›´æ–°_ownedTokensæ•°ç»„!è¿™ä¼šå¢åŠ gasæˆæœ¬,ä½†æä¾›äº†å¼ºå¤§çš„æŸ¥è¯¢èƒ½åŠ›ã€‚
                </div>
            </div>

            <div class="concept-card important">
                <div class="concept-title">ğŸŒŸ æŒ‘æˆ˜: å®ç°NFTè´¨æŠ¼åˆçº¦</div>
                <p><strong>ç»¼åˆä»»åŠ¡:</strong> åˆ›å»ºä¸€ä¸ªè´¨æŠ¼åˆçº¦,ç”¨æˆ·è´¨æŠ¼NFTèµšå–ä»£å¸å¥–åŠ±</p>
                <pre><code class="language-solidity">contract NFTStaking is IERC721Receiver {
    struct Stake {
        address owner;
        uint256 timestamp;
    }
    
    mapping(uint256 => Stake) public stakes;
    
    // TODO: å®ç°è´¨æŠ¼åŠŸèƒ½
    function stake(uint256 tokenId) external { }
    
    // TODO: å®ç°è§£é™¤è´¨æŠ¼
    function unstake(uint256 tokenId) external { }
    
    // TODO: è®¡ç®—å¥–åŠ±
    function calculateReward(uint256 tokenId) public view returns (uint256) { }
    
    // å¿…é¡»å®ç°ä»¥æ¥æ”¶NFT
    function onERC721Received(
        address,
        address,
        uint256,
        bytes calldata
    ) external pure returns (bytes4) {
        return IERC721Receiver.onERC721Received.selector;
    }
}</code></pre>
            </div>
        </div>

        <div class="navigation-footer">
            <a href="contract-20.html" class="nav-footer-btn" style="border-color: var(--accent);">
                <div class="nav-footer-label">â† ä¸Šä¸€ä¸ª</div>
                <div class="nav-footer-title">FortKnox - é‡‘åº“å ¡å’</div>
            </a>
            <a href="contract-22.html" class="nav-footer-btn" style="border-color: var(--accent);">
                <div class="nav-footer-label">ä¸‹ä¸€ä¸ª â†’</div>
                <div class="nav-footer-title">DecentralisedLottery - å»ä¸­å¿ƒåŒ–å½©ç¥¨</div>
            </a>
        </div>
    
        <!-- Snehaçš„ä¸€å°æ¥ä¿¡æ¨¡å— -->
        <div class="answer-reference">
            <div class="envelope-container" id="envelope-container">
                <div class="envelope">
                    <div class="envelope-front">
                        <div class="envelope-flap"></div>
                        <div class="envelope-pattern"></div>
                        <div class="envelope-seal">
                            <i class="fas fa-feather-alt seal-icon"></i>
                        </div>
                        <div class="envelope-text">Snehaçš„ä¸€å°æ¥ä¿¡</div>
                    </div>
                    <div class="envelope-back">
                        <div class="envelope-text" style="color: var(--warm-brown);">ç‚¹å‡»å¼€å¯</div>
                    </div>
                </div>
            </div>
            <div class="envelope-hint">ç‚¹å‡»ä¿¡å°æŸ¥çœ‹Snehaçš„æ¥ä¿¡</div>
        </div>
    </div>

    <!-- å¼¹çª— - å†…å®¹å¾…åç»­ç²¾ç»†åŒ–å¤„ç† -->
    <div class="answer-modal" id="answer-modal">
        <div class="letter-container">
            <div class="letter-header">
                <div class="letter-title">Snehaçš„ä¸€å°æ¥ä¿¡</div>
                <div class="letter-subtitle">å…³äºç¬¬21å¤©çš„å­¦ä¹ æŒ‡å¯¼</div>
                <button id="close-letter" class="close-letter">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="letter-body">
                <div id="md-content" class="md-content">
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">ç®€æ˜“çš„NFTåˆçº¦ - ERC721</h1></div><p dir="auto">Day: Day 21ID: 21è¯‘è€…: Bala Chenéš¾åº¦ç­‰çº§: é«˜çº§</p><div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">åˆ›å»ºä½ è‡ªå·±çš„NFTï¼ˆç®€å•çš„ERC-721ï¼‰</h1></div><p dir="auto">å¥½çš„ï¼Œæ¬¢è¿å›åˆ°<strong>30å¤©Solidityå­¦ä¹ </strong>ã€‚</p><p dir="auto">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨å­¦ä¹ æ™ºèƒ½åˆçº¦çš„åº•å±‚å·¥ä½œåŸç†ã€‚æˆ‘ä»¬åˆ¶ä½œäº†è‡ªå·±çš„ä»£å¸ï¼Œé”å®šäº†èµ„é‡‘ï¼Œç©è½¬äº†è®¿é—®æ§åˆ¶ï¼Œç”šè‡³å­¦ä¼šäº†å¦‚ä½•ä¿æŠ¤åˆçº¦å…å—æ¶æ„æ”»å‡»ã€‚</p><p dir="auto">ä½†ä»Šå¤©ï¼Ÿ</p><p dir="auto">ä»Šå¤©ä¸ä¸€æ ·ã€‚</p><p dir="auto">æˆ‘ä»¬ç»ˆäºè¦è¿›å…¥Solidityä¸­ä½ æ„å»ºçš„ä¸œè¥¿å…·æœ‰å®é™…ç°å®ä¸–ç•Œç”¨é€”çš„éƒ¨åˆ†ã€‚</p><p dir="auto">æˆ‘ä»¬å°†ä»æ¯ä¸ªäººéƒ½å¬è¯´è¿‡ï¼Œä½†å¾ˆå°‘æœ‰äººçœŸæ­£ç†è§£çš„ä¸œè¥¿å¼€å§‹ï¼š</p><p dir="auto"><strong>NFT</strong>ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ¨ NFTåˆ°åº•<em>æ˜¯</em>ä»€ä¹ˆï¼Ÿ</h3></div><p dir="auto">å¥½çš„ï¼Œè®©æˆ‘ä»¬å…ˆæ¾„æ¸…ä¸€ä¸‹â€”â€”NFTä¸ä»…ä»…æ˜¯çŒ´å­å›¾ç‰‡æˆ–ç½‘ç»œç‚«è€€çš„ææ–™ã€‚</p><p dir="auto"><strong>NFTæ˜¯å…³äºæ•°å­—æ‰€æœ‰æƒçš„</strong>ã€‚</p><p dir="auto">ç†è§£å®ƒä»¬çš„å…³é”®æ˜¯è¿™ä¸ªå¬èµ·æ¥å¾ˆå¥‡æ€ªçš„è¯ï¼š<strong>éåŒè´¨åŒ–</strong>ã€‚</p><p dir="auto"><strong>NFT</strong> = <strong>éåŒè´¨åŒ–ä»£å¸</strong></p><p dir="auto">è®©æˆ‘ä»¬åˆ†è§£ä¸€ä¸‹ï¼š</p><ul dir="auto"><li><strong>ä»£å¸</strong>åªæ˜¯åŒºå—é“¾ä¸Šçš„æ•°å­—ç‰©å“ã€‚</li><li><strong>åŒè´¨åŒ–</strong>æ„å‘³ç€"å¯äº’æ¢çš„"ã€‚å°±åƒé‡‘é’±ã€‚1ç¾å…ƒæ€»æ˜¯ä»·å€¼1ç¾å…ƒï¼Œæ— è®ºå®ƒæ¥è‡ªå“ªé‡Œã€‚</li><li><strong>éåŒè´¨åŒ–</strong>æ„å‘³ç€å®ƒä¸å¯äº’æ¢ã€‚å®ƒæ˜¯ç‹¬ç‰¹çš„ã€‚ç‹¬ä¸€æ— äºŒçš„ã€‚</li></ul><p dir="auto">å‡è®¾ä½ çš„æœ‹å‹é€’ç»™ä½ ä¸€æ”¯ç¬”ã€‚å¾ˆå¥½ã€‚å®ƒåªæ˜¯ä¸€æ”¯æ™®é€šçš„ç¬”â€”â€”ä½ ç”¨å®ƒï¼Œä¸¢äº†å®ƒï¼Œæ— æ‰€è°“ã€‚</p><p dir="auto">ç°åœ¨æƒ³è±¡ä½ çš„çˆ·çˆ·ç»™ä½ ä¸€æ”¯ä»–ä»1940å¹´ä»£å°±æ‹¥æœ‰çš„é’¢ç¬”ã€‚å®ƒå¾ˆæ—§ï¼Œæœ‰é›•åˆ»ï¼ŒèƒŒåæœ‰æ•…äº‹ã€‚</p><p dir="auto">ä»æŠ€æœ¯ä¸Šè®²ï¼Œä¸¤è€…éƒ½æ˜¯"åªæ˜¯ç¬”"ã€‚ä½†å®ƒä»¬ç›¸ç­‰å—ï¼Ÿ</p><p dir="auto">ç»å¯¹ä¸æ˜¯ã€‚</p><p dir="auto">æ¥è‡ªä½ çˆ·çˆ·çš„é‚£æ”¯æ˜¯<strong>éåŒè´¨åŒ–çš„</strong>â€”â€”å®ƒæœ‰æƒ…æ„Ÿä»·å€¼ã€å†å²ã€ç‹¬ç‰¹æ€§ã€‚</p><p dir="auto">ä½ ä¸ä¼šåªæ˜¯æŠŠå®ƒæ¢æˆæ–‡å…·åº—çš„éšæœºç¬”ã€‚</p><p dir="auto">è¿™æ­£æ˜¯NFTçš„å·¥ä½œåŸç†ã€‚</p><p dir="auto">å®ƒä»¬æ˜¯<em>ä¸å®Œå…¨ç›¸åŒ</em>çš„æ•°å­—ç‰©å“ã€‚æ¯ä¸€ä¸ªéƒ½æœ‰è‡ªå·±çš„IDï¼Œè‡ªå·±çš„æ•°æ®ï¼Œè‡ªå·±çš„æ„ä¹‰ã€‚</p><p dir="auto">å³ä½¿å®ƒä»¬æ˜¯åŒä¸€ä¸ªæ”¶è—çš„ä¸€éƒ¨åˆ†ï¼ŒNFT #1å¯èƒ½ä¸NFT #2000å®Œå…¨ä¸åŒã€‚</p><p dir="auto">ä¸åŒçš„å›¾åƒï¼Œä¸åŒçš„å±æ€§ï¼Œä¸åŒçš„æ•…äº‹ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ¤ é‚£ä¹ˆè¿™ä¸æˆ‘ä»¬ä¹‹å‰æ„å»ºçš„æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h3></div><p dir="auto">è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰åˆ¶ä½œçš„ERC-20ä»£å¸å—ï¼Ÿ</p><p dir="auto">é‚£æ˜¯ä¸€ä¸ª<strong>åŒè´¨åŒ–</strong>ä»£å¸â€”â€”å°±åƒåˆ¶ä½œä½ è‡ªå·±çš„æ•°å­—è´§å¸ã€‚</p><p dir="auto">å¦‚æœä½ æœ‰10ä¸ªï¼Œæˆ‘æœ‰10ä¸ªï¼Œæˆ‘ä»¬æ‹¥æœ‰çš„æ˜¯åŒæ ·çš„ä¸œè¥¿ã€‚ä»£å¸æ˜¯ç›¸ç­‰ä¸”å¯äº’æ¢çš„ã€‚</p><p dir="auto">NFTï¼ˆä½¿ç”¨<strong>ERC-721</strong>æ„å»ºï¼‰å®Œå…¨ä¸åŒã€‚</p><p dir="auto">æ¯ä¸ªä»£å¸éƒ½æœ‰è‡ªå·±çš„<em>èº«ä»½</em>ã€‚è‡ªå·±çš„ç¼–å·ã€‚è‡ªå·±çš„æ„ä¹‰ã€‚</p><p dir="auto">ä½ ä¸èƒ½1:1äº¤æ¢å®ƒä»¬ï¼Œå› ä¸ºæ¯ä¸€ä¸ªéƒ½å¯èƒ½ä»£è¡¨å®Œå…¨ä¸åŒçš„ä¸œè¥¿ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸšª NFTä¸ä»…ä»…æ˜¯è‰ºæœ¯</h3></div><p dir="auto">è¿™æ˜¯å¤§å¤šæ•°äººè¯¯è§£çš„éƒ¨åˆ†ã€‚</p><p dir="auto">NFTä¸ä»…ä»…æ˜¯å…³äºè‰ºæœ¯å“æˆ–æ”¶è—å“ã€‚</p><p dir="auto">å®ƒä»¬æ˜¯ä¸€ç§ä»¥æ•°å­—å½¢å¼è¡¨ç¤º<strong>æ‰€æœ‰æƒ</strong>â€”â€”å­—é¢ä¸Šä»»ä½•ä¸œè¥¿â€”â€”çš„æ–¹å¼ã€‚</p><p dir="auto">è®©æˆ‘ä»¬åˆ†è§£ä¸€äº›çœŸå®çš„ä¾‹å­ï¼š</p><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸŸ æ´»åŠ¨é—¨ç¥¨</h3></div><p dir="auto">NFTå¯ä»¥æ˜¯éŸ³ä¹ä¼šã€ç ”è®¨ä¼šæˆ–èŠ‚æ—¥çš„é—¨ç¥¨ã€‚</p><p dir="auto">æ²¡æœ‰çº¸å¼ ã€‚æ²¡æœ‰æˆªå›¾ã€‚åªéœ€ä»ä½ çš„é’±åŒ…æ‰«æâ€”â€”ä½ å°±è¿›å»äº†ã€‚</p><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ® æ¸¸æˆå†…ç‰©å“</h3></div><p dir="auto">ä½ è¾›è‹¦è·å¾—çš„é‚£ä¸ªç¨€æœ‰çš®è‚¤ã€å‰‘æˆ–æˆ¿å­ï¼Ÿå¦‚æœå®ƒæ˜¯NFTï¼Œä½ <em>æ‹¥æœ‰</em>å®ƒã€‚</p><p dir="auto">ä¸æ˜¯æ¸¸æˆå…¬å¸ã€‚æ˜¯ä½ ã€‚ä½ å¯ä»¥å‡ºå”®å®ƒï¼Œç§Ÿèµå®ƒï¼Œç”šè‡³æŠŠå®ƒå¸¦åˆ°å…¶ä»–æ¸¸æˆä¸­ã€‚</p><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ“„ è´¢äº§æˆ–æ³•å¾‹æ–‡ä»¶</h3></div><p dir="auto">åœ¨æœªæ¥ï¼Œä½ çš„æˆ¿å±‹å¥‘çº¦å¯èƒ½æ˜¯NFTã€‚</p><p dir="auto">å®ƒå°†å­˜åœ¨äºé“¾ä¸Šï¼Œå¾ˆéš¾ä¼ªé€ ï¼Œå¹¶ä¸”æ˜“äºè½¬ç§»ï¼Œæ— éœ€èµ°20æ­¥æµç¨‹çš„æ–‡ä¹¦å·¥ä½œã€‚</p><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ“› è¯ä¹¦æˆ–è¯æ˜</h3></div><p dir="auto">NFTå¯ä»¥ç”¨ä½œæ•°å­—è¯ä¹¦ã€‚</p><p dir="auto">å®Œæˆäº†è¯¾ç¨‹ï¼Ÿç °â€”â€”NFTåœ¨ä½ çš„é’±åŒ…é‡Œã€‚ä»»ä½•äººéƒ½å¯ä»¥ç«‹å³éªŒè¯å®ƒã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ’¡ ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿ</h3></div><p dir="auto">åœ¨NFTä¹‹å‰ï¼Œäº’è”ç½‘æœ‰ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜â€”â€”ä½ å¯ä»¥åˆ†äº«ä¸œè¥¿ï¼Œä½†ä½ ä¸èƒ½æ‹¥æœ‰å®ƒã€‚</p><p dir="auto">ä½ å¯ä»¥å‘å¸ƒç…§ç‰‡ï¼Œä½†å¾ˆéš¾è¯æ˜å®ƒæ˜¯ä½ çš„ã€‚</p><p dir="auto">ä½ å¯ä»¥åœ¨æ¸¸æˆä¸­è´­ä¹°ä¸œè¥¿ï¼Œä½†å¦‚æœæ¸¸æˆå…³é—­â€”â€”å®ƒå°±æ¶ˆå¤±äº†ã€‚</p><p dir="auto">NFTè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p dir="auto">å®ƒä»¬å°†<strong>æ‰€æœ‰æƒ</strong>çš„æ¦‚å¿µå¸¦åˆ°æ•°å­—ä¸–ç•Œâ€”â€”ä»¥ä¸€ç§å…¬å¼€ã€æ°¸ä¹…å’Œå¯ç¼–ç¨‹çš„æ–¹å¼ã€‚</p><p dir="auto">è¿™ä¸ä»…ä»…æ˜¯è‰ºæœ¯ã€‚</p><blockquote><p dir="auto">è¿™æ˜¯ä½ çš„ä¸œè¥¿â€”â€”é—¨ç¥¨ã€æ”¶è—å“ã€èº«ä»½è¯ã€å‡­è¯â€”â€”æœ€ç»ˆåœ¨æ•°å­—ç©ºé—´ä¸­å˜å¾—çœŸå®ã€‚</p></blockquote><div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">1. äº§å“éœ€æ±‚ä¹¦</h1></div><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ç”¨æˆ·æµç¨‹</h3></div><section class="js-render-needs-enrichment render-needs-enrichment position-relative" data-identity="1d45628a-2b84-4c86-a356-e698d8910ed7" data-host="https://viewscreen.githubusercontent.com" data-src="https://viewscreen.githubusercontent.com/markdown/mermaid?docs_host=https%3A%2F%2Fdocs.github.com" data-type="mermaid" aria-label="mermaid rendered output container">  <div class="js-render-enrichment-target" data-json="{&quot;data&quot;:&quot;flowchart TD\n  %% åˆçº¦åˆå§‹åŒ–\n  A[\&quot;éƒ¨ç½²åˆçº¦ constructor(name_ symbol_)\&quot;] --&amp;gt; A1[\&quot;è®¾ç½® name å’Œ symbol\&quot;]\n  A1 --&amp;gt; A2[\&quot;åˆå§‹åŒ– _tokenIdCounter=1 æ˜ å°„ä¸ºç©º\&quot;]\n\n  %% æŸ¥è¯¢\n  B[\&quot;æŸ¥è¯¢ä½™é¢ balanceOf(owner)\&quot;] --&amp;gt; B1{\&quot;owner != 0\&quot;}\n  B1 --&amp;gt;|æ˜¯| B2[\&quot;è¿”å› _balances[owner]\&quot;]\n  B1 --&amp;gt;|å¦| BX[\&quot;revert Zero address\&quot;]\n\n  C[\&quot;æŸ¥è¯¢æ‰€æœ‰è€… ownerOf(tokenId)\&quot;] --&amp;gt; C1{\&quot;_owners[tokenId] != 0\&quot;}\n  C1 --&amp;gt;|æ˜¯| C2[\&quot;è¿”å› owner\&quot;]\n  C1 --&amp;gt;|å¦| CX[\&quot;revert Token doesn't exist\&quot;]\n\n  D[\&quot;æŸ¥è¯¢æ‰¹å‡† getApproved(tokenId)\&quot;] --&amp;gt; D1{\&quot;_owners[tokenId] != 0\&quot;}\n  D1 --&amp;gt;|æ˜¯| D2[\&quot;è¿”å› _tokenApprovals[tokenId]\&quot;]\n  D1 --&amp;gt;|å¦| DX[\&quot;revert Token doesn't exist\&quot;]\n\n  E[\&quot;æŸ¥è¯¢å…¨å±€æ‰¹å‡† isApprovedForAll(owner operator)\&quot;] --&amp;gt; E1[\&quot;è¿”å› _operatorApprovals[owner][operator]\&quot;]\n\n  F[\&quot;æŸ¥è¯¢å…ƒæ•°æ® tokenURI(tokenId)\&quot;] --&amp;gt; F1{\&quot;_owners[tokenId] != 0\&quot;}\n  F1 --&amp;gt;|æ˜¯| F2[\&quot;è¿”å› _tokenURIs[tokenId]\&quot;]\n  F1 --&amp;gt;|å¦| FX[\&quot;revert Token doesn't exist\&quot;]\n\n  %% æ‰¹å‡†\n  G[\&quot;å•ä¸ªä»£å¸æ‰¹å‡† approve(to tokenId)\&quot;] --&amp;gt; G1[\&quot;owner = ownerOf(tokenId)\&quot;]\n  G1 --&amp;gt; G2{\&quot;to != owner\&quot;}\n  G2 --&amp;gt;|æ˜¯| G3{\&quot;msg.sender == owner æˆ– isApprovedForAll(owner msg.sender)\&quot;}\n  G3 --&amp;gt;|æ˜¯| G4[\&quot;è®¾ç½® _tokenApprovals[tokenId]=to\&quot;]\n  G4 --&amp;gt; G5[\&quot;emit Approval(owner to tokenId)\&quot;]\n  G2 --&amp;gt;|å¦| GX1[\&quot;revert Already owner\&quot;]\n  G3 --&amp;gt;|å¦| GX2[\&quot;revert Not authorized\&quot;]\n\n  H[\&quot;å…¨å±€æ‰¹å‡† setApprovalForAll(operator approved)\&quot;] --&amp;gt; H1{\&quot;operator != msg.sender\&quot;}\n  H1 --&amp;gt;|æ˜¯| H2[\&quot;è®¾ç½® _operatorApprovals[msg.sender][operator]=approved\&quot;]\n  H2 --&amp;gt; H3[\&quot;emit ApprovalForAll(msg.sender operator approved)\&quot;]\n  H1 --&amp;gt;|å¦| HX[\&quot;revert Self approval\&quot;]\n\n  %% è½¬ç§»ä¸å®‰å…¨è½¬ç§»\n  I[\&quot;è½¬ç§» transferFrom(from to tokenId)\&quot;] --&amp;gt; I1{\&quot;_isApprovedOrOwner(msg.sender tokenId)\&quot;}\n  I1 --&amp;gt;|æ˜¯| I2[\&quot;_transfer(from to tokenId)\&quot;]\n  I1 --&amp;gt;|å¦| IX[\&quot;revert Not authorized\&quot;]\n\n  J[\&quot;å®‰å…¨è½¬ç§» safeTransferFrom(from to tokenId)\&quot;] --&amp;gt; J1[\&quot;è°ƒç”¨ safeTransferFrom(from to tokenId ç©ºæ•°æ®)\&quot;]\n\n  K[\&quot;å®‰å…¨è½¬ç§»(å«æ•°æ®) safeTransferFrom(from to tokenId data)\&quot;] --&amp;gt; K1{\&quot;_isApprovedOrOwner(msg.sender tokenId)\&quot;}\n  K1 --&amp;gt;|æ˜¯| K2[\&quot;_safeTransfer(from to tokenId data)\&quot;]\n  K1 --&amp;gt;|å¦| KX[\&quot;revert Not authorized\&quot;]\n\n  %% å†…éƒ¨è½¬ç§»é€»è¾‘\n  I2 --&amp;gt; T1{\&quot;ownerOf(tokenId) == from\&quot;}\n  T1 --&amp;gt;|æ˜¯| T2{\&quot;to != 0\&quot;}\n  T2 --&amp;gt;|æ˜¯| T3[\&quot;å‡å°‘ _balances[from]\&quot;]\n  T3 --&amp;gt; T4[\&quot;å¢åŠ  _balances[to]\&quot;]\n  T4 --&amp;gt; T5[\&quot;è®¾ç½® _owners[tokenId]=to\&quot;]\n  T5 --&amp;gt; T6[\&quot;åˆ é™¤ _tokenApprovals[tokenId]\&quot;]\n  T6 --&amp;gt; T7[\&quot;emit Transfer(from to tokenId)\&quot;]\n  T1 --&amp;gt;|å¦| TX1[\&quot;revert Not owner\&quot;]\n  T2 --&amp;gt;|å¦| TX2[\&quot;revert Zero address\&quot;]\n\n  %% å®‰å…¨è½¬ç§»é€»è¾‘\n  K2 --&amp;gt; S1[\&quot;_transfer(from to tokenId)\&quot;]\n  S1 --&amp;gt; S2{\&quot;to æ˜¯åˆçº¦åœ°å€?\&quot;}\n  S2 --&amp;gt;|æ˜¯| S3{\&quot;onERC721Received è¿”å›æ­£ç¡®é€‰æ‹©å™¨?\&quot;}\n  S3 --&amp;gt;|æ˜¯| S4[\&quot;å®Œæˆå®‰å…¨è½¬ç§»\&quot;]\n  S3 --&amp;gt;|å¦| SX1[\&quot;revert Not ERC721Receiver\&quot;]\n  S2 --&amp;gt;|å¦| S4\n\n  %% é“¸é€ \n  M[\&quot;é“¸é€  mint(to uri)\&quot;] --&amp;gt; M1[\&quot;tokenId = _tokenIdCounter; é€’å¢\&quot;]\n  M1 --&amp;gt; M2[\&quot;è®¾ç½® _owners[tokenId]=to\&quot;]\n  M2 --&amp;gt; M3[\&quot;å¢åŠ  _balances[to]\&quot;]\n  M3 --&amp;gt; M4[\&quot;è®¾ç½® _tokenURIs[tokenId]=uri\&quot;]\n  M4 --&amp;gt; M5[\&quot;emit Transfer(0 to tokenId)\&quot;]\n\n&quot;}" data-plain="flowchart TD  %% åˆçº¦åˆå§‹åŒ–  A[&quot;éƒ¨ç½²åˆçº¦ constructor(name_ symbol_)&quot;] --&gt; A1[&quot;è®¾ç½® name å’Œ symbol&quot;]  A1 --&gt; A2[&quot;åˆå§‹åŒ– _tokenIdCounter=1 æ˜ å°„ä¸ºç©º&quot;]  %% æŸ¥è¯¢  B[&quot;æŸ¥è¯¢ä½™é¢ balanceOf(owner)&quot;] --&gt; B1{&quot;owner != 0&quot;}  B1 --&gt;|æ˜¯| B2[&quot;è¿”å› _balances[owner]&quot;]  B1 --&gt;|å¦| BX[&quot;revert Zero address&quot;]  C[&quot;æŸ¥è¯¢æ‰€æœ‰è€… ownerOf(tokenId)&quot;] --&gt; C1{&quot;_owners[tokenId] != 0&quot;}  C1 --&gt;|æ˜¯| C2[&quot;è¿”å› owner&quot;]  C1 --&gt;|å¦| CX[&quot;revert Token doesn't exist&quot;]  D[&quot;æŸ¥è¯¢æ‰¹å‡† getApproved(tokenId)&quot;] --&gt; D1{&quot;_owners[tokenId] != 0&quot;}  D1 --&gt;|æ˜¯| D2[&quot;è¿”å› _tokenApprovals[tokenId]&quot;]  D1 --&gt;|å¦| DX[&quot;revert Token doesn't exist&quot;]  E[&quot;æŸ¥è¯¢å…¨å±€æ‰¹å‡† isApprovedForAll(owner operator)&quot;] --&gt; E1[&quot;è¿”å› _operatorApprovals[owner][operator]&quot;]  F[&quot;æŸ¥è¯¢å…ƒæ•°æ® tokenURI(tokenId)&quot;] --&gt; F1{&quot;_owners[tokenId] != 0&quot;}  F1 --&gt;|æ˜¯| F2[&quot;è¿”å› _tokenURIs[tokenId]&quot;]  F1 --&gt;|å¦| FX[&quot;revert Token doesn't exist&quot;]  %% æ‰¹å‡†  G[&quot;å•ä¸ªä»£å¸æ‰¹å‡† approve(to tokenId)&quot;] --&gt; G1[&quot;owner = ownerOf(tokenId)&quot;]  G1 --&gt; G2{&quot;to != owner&quot;}  G2 --&gt;|æ˜¯| G3{&quot;msg.sender == owner æˆ– isApprovedForAll(owner msg.sender)&quot;}  G3 --&gt;|æ˜¯| G4[&quot;è®¾ç½® _tokenApprovals[tokenId]=to&quot;]  G4 --&gt; G5[&quot;emit Approval(owner to tokenId)&quot;]  G2 --&gt;|å¦| GX1[&quot;revert Already owner&quot;]  G3 --&gt;|å¦| GX2[&quot;revert Not authorized&quot;]  H[&quot;å…¨å±€æ‰¹å‡† setApprovalForAll(operator approved)&quot;] --&gt; H1{&quot;operator != msg.sender&quot;}  H1 --&gt;|æ˜¯| H2[&quot;è®¾ç½® _operatorApprovals[msg.sender][operator]=approved&quot;]  H2 --&gt; H3[&quot;emit ApprovalForAll(msg.sender operator approved)&quot;]  H1 --&gt;|å¦| HX[&quot;revert Self approval&quot;]  %% è½¬ç§»ä¸å®‰å…¨è½¬ç§»  I[&quot;è½¬ç§» transferFrom(from to tokenId)&quot;] --&gt; I1{&quot;_isApprovedOrOwner(msg.sender tokenId)&quot;}  I1 --&gt;|æ˜¯| I2[&quot;_transfer(from to tokenId)&quot;]  I1 --&gt;|å¦| IX[&quot;revert Not authorized&quot;]  J[&quot;å®‰å…¨è½¬ç§» safeTransferFrom(from to tokenId)&quot;] --&gt; J1[&quot;è°ƒç”¨ safeTransferFrom(from to tokenId ç©ºæ•°æ®)&quot;]  K[&quot;å®‰å…¨è½¬ç§»(å«æ•°æ®) safeTransferFrom(from to tokenId data)&quot;] --&gt; K1{&quot;_isApprovedOrOwner(msg.sender tokenId)&quot;}  K1 --&gt;|æ˜¯| K2[&quot;_safeTransfer(from to tokenId data)&quot;]  K1 --&gt;|å¦| KX[&quot;revert Not authorized&quot;]  %% å†…éƒ¨è½¬ç§»é€»è¾‘  I2 --&gt; T1{&quot;ownerOf(tokenId) == from&quot;}  T1 --&gt;|æ˜¯| T2{&quot;to != 0&quot;}  T2 --&gt;|æ˜¯| T3[&quot;å‡å°‘ _balances[from]&quot;]  T3 --&gt; T4[&quot;å¢åŠ  _balances[to]&quot;]  T4 --&gt; T5[&quot;è®¾ç½® _owners[tokenId]=to&quot;]  T5 --&gt; T6[&quot;åˆ é™¤ _tokenApprovals[tokenId]&quot;]  T6 --&gt; T7[&quot;emit Transfer(from to tokenId)&quot;]  T1 --&gt;|å¦| TX1[&quot;revert Not owner&quot;]  T2 --&gt;|å¦| TX2[&quot;revert Zero address&quot;]  %% å®‰å…¨è½¬ç§»é€»è¾‘  K2 --&gt; S1[&quot;_transfer(from to tokenId)&quot;]  S1 --&gt; S2{&quot;to æ˜¯åˆçº¦åœ°å€?&quot;}  S2 --&gt;|æ˜¯| S3{&quot;onERC721Received è¿”å›æ­£ç¡®é€‰æ‹©å™¨?&quot;}  S3 --&gt;|æ˜¯| S4[&quot;å®Œæˆå®‰å…¨è½¬ç§»&quot;]  S3 --&gt;|å¦| SX1[&quot;revert Not ERC721Receiver&quot;]  S2 --&gt;|å¦| S4  %% é“¸é€   M[&quot;é“¸é€  mint(to uri)&quot;] --&gt; M1[&quot;tokenId = _tokenIdCounter; é€’å¢&quot;]  M1 --&gt; M2[&quot;è®¾ç½® _owners[tokenId]=to&quot;]  M2 --&gt; M3[&quot;å¢åŠ  _balances[to]&quot;]  M3 --&gt; M4[&quot;è®¾ç½® _tokenURIs[tokenId]=uri&quot;]  M4 --&gt; M5[&quot;emit Transfer(0 to tokenId)&quot;]" dir="auto"><!----><!----><div class="js-render-block-actions position-absolute top-0 pr-2 right-0 d-flex flex-justify-end flex-items-center">        <details class="details-reset details-overlay details-overlay-dark" style="display: contents">      <summary role="button" aria-label="Open dialog" class="btn my-2 mr-2 p-0 d-inline-flex" aria-haspopup="dialog">              </summary>      <details-dialog class="Box Box--overlay render-full-screen d-flex flex-column anim-fade-in fast" aria-label="mermaid rendered container" role="dialog" aria-modal="true">        <div>          <button aria-label="Close dialog" data-close-dialog="" type="button" data-view-component="true" class="Link--muted btn-link position-absolute render-full-screen-close">                      </button>          <div class="Box-body border-0" role="presentation"></div>        </div>      </details-dialog>    </details>  <!---->  </div><!---->    <div class="render-container color-bg-transparent js-render-target p-0 is-render-automatic is-render-requested is-render-ready" data-identity="1d45628a-2b84-4c86-a356-e698d8910ed7" data-host="https://viewscreen.githubusercontent.com" data-type="mermaid" style="height: 436.752px;">      <iframe title="File display" role="presentation" class="render-viewer" sandbox="allow-scripts allow-same-origin allow-top-navigation allow-popups" src="https://viewscreen.githubusercontent.com/markdown/mermaid?docs_host=https%3A%2F%2Fdocs.github.com&amp;color_mode=dark#1d45628a-2b84-4c86-a356-e698d8910ed7" name="1d45628a-2b84-4c86-a356-e698d8910ed7" data-content="{&quot;data&quot;:&quot;flowchart TD\n  %% åˆçº¦åˆå§‹åŒ–\n  A[\&quot;éƒ¨ç½²åˆçº¦ constructor(name_ symbol_)\&quot;] --&amp;gt; A1[\&quot;è®¾ç½® name å’Œ symbol\&quot;]\n  A1 --&amp;gt; A2[\&quot;åˆå§‹åŒ– _tokenIdCounter=1 æ˜ å°„ä¸ºç©º\&quot;]\n\n  %% æŸ¥è¯¢\n  B[\&quot;æŸ¥è¯¢ä½™é¢ balanceOf(owner)\&quot;] --&amp;gt; B1{\&quot;owner != 0\&quot;}\n  B1 --&amp;gt;|æ˜¯| B2[\&quot;è¿”å› _balances[owner]\&quot;]\n  B1 --&amp;gt;|å¦| BX[\&quot;revert Zero address\&quot;]\n\n  C[\&quot;æŸ¥è¯¢æ‰€æœ‰è€… ownerOf(tokenId)\&quot;] --&amp;gt; C1{\&quot;_owners[tokenId] != 0\&quot;}\n  C1 --&amp;gt;|æ˜¯| C2[\&quot;è¿”å› owner\&quot;]\n  C1 --&amp;gt;|å¦| CX[\&quot;revert Token doesn't exist\&quot;]\n\n  D[\&quot;æŸ¥è¯¢æ‰¹å‡† getApproved(tokenId)\&quot;] --&amp;gt; D1{\&quot;_owners[tokenId] != 0\&quot;}\n  D1 --&amp;gt;|æ˜¯| D2[\&quot;è¿”å› _tokenApprovals[tokenId]\&quot;]\n  D1 --&amp;gt;|å¦| DX[\&quot;revert Token doesn't exist\&quot;]\n\n  E[\&quot;æŸ¥è¯¢å…¨å±€æ‰¹å‡† isApprovedForAll(owner operator)\&quot;] --&amp;gt; E1[\&quot;è¿”å› _operatorApprovals[owner][operator]\&quot;]\n\n  F[\&quot;æŸ¥è¯¢å…ƒæ•°æ® tokenURI(tokenId)\&quot;] --&amp;gt; F1{\&quot;_owners[tokenId] != 0\&quot;}\n  F1 --&amp;gt;|æ˜¯| F2[\&quot;è¿”å› _tokenURIs[tokenId]\&quot;]\n  F1 --&amp;gt;|å¦| FX[\&quot;revert Token doesn't exist\&quot;]\n\n  %% æ‰¹å‡†\n  G[\&quot;å•ä¸ªä»£å¸æ‰¹å‡† approve(to tokenId)\&quot;] --&amp;gt; G1[\&quot;owner = ownerOf(tokenId)\&quot;]\n  G1 --&amp;gt; G2{\&quot;to != owner\&quot;}\n  G2 --&amp;gt;|æ˜¯| G3{\&quot;msg.sender == owner æˆ– isApprovedForAll(owner msg.sender)\&quot;}\n  G3 --&amp;gt;|æ˜¯| G4[\&quot;è®¾ç½® _tokenApprovals[tokenId]=to\&quot;]\n  G4 --&amp;gt; G5[\&quot;emit Approval(owner to tokenId)\&quot;]\n  G2 --&amp;gt;|å¦| GX1[\&quot;revert Already owner\&quot;]\n  G3 --&amp;gt;|å¦| GX2[\&quot;revert Not authorized\&quot;]\n\n  H[\&quot;å…¨å±€æ‰¹å‡† setApprovalForAll(operator approved)\&quot;] --&amp;gt; H1{\&quot;operator != msg.sender\&quot;}\n  H1 --&amp;gt;|æ˜¯| H2[\&quot;è®¾ç½® _operatorApprovals[msg.sender][operator]=approved\&quot;]\n  H2 --&amp;gt; H3[\&quot;emit ApprovalForAll(msg.sender operator approved)\&quot;]\n  H1 --&amp;gt;|å¦| HX[\&quot;revert Self approval\&quot;]\n\n  %% è½¬ç§»ä¸å®‰å…¨è½¬ç§»\n  I[\&quot;è½¬ç§» transferFrom(from to tokenId)\&quot;] --&amp;gt; I1{\&quot;_isApprovedOrOwner(msg.sender tokenId)\&quot;}\n  I1 --&amp;gt;|æ˜¯| I2[\&quot;_transfer(from to tokenId)\&quot;]\n  I1 --&amp;gt;|å¦| IX[\&quot;revert Not authorized\&quot;]\n\n  J[\&quot;å®‰å…¨è½¬ç§» safeTransferFrom(from to tokenId)\&quot;] --&amp;gt; J1[\&quot;è°ƒç”¨ safeTransferFrom(from to tokenId ç©ºæ•°æ®)\&quot;]\n\n  K[\&quot;å®‰å…¨è½¬ç§»(å«æ•°æ®) safeTransferFrom(from to tokenId data)\&quot;] --&amp;gt; K1{\&quot;_isApprovedOrOwner(msg.sender tokenId)\&quot;}\n  K1 --&amp;gt;|æ˜¯| K2[\&quot;_safeTransfer(from to tokenId data)\&quot;]\n  K1 --&amp;gt;|å¦| KX[\&quot;revert Not authorized\&quot;]\n\n  %% å†…éƒ¨è½¬ç§»é€»è¾‘\n  I2 --&amp;gt; T1{\&quot;ownerOf(tokenId) == from\&quot;}\n  T1 --&amp;gt;|æ˜¯| T2{\&quot;to != 0\&quot;}\n  T2 --&amp;gt;|æ˜¯| T3[\&quot;å‡å°‘ _balances[from]\&quot;]\n  T3 --&amp;gt; T4[\&quot;å¢åŠ  _balances[to]\&quot;]\n  T4 --&amp;gt; T5[\&quot;è®¾ç½® _owners[tokenId]=to\&quot;]\n  T5 --&amp;gt; T6[\&quot;åˆ é™¤ _tokenApprovals[tokenId]\&quot;]\n  T6 --&amp;gt; T7[\&quot;emit Transfer(from to tokenId)\&quot;]\n  T1 --&amp;gt;|å¦| TX1[\&quot;revert Not owner\&quot;]\n  T2 --&amp;gt;|å¦| TX2[\&quot;revert Zero address\&quot;]\n\n  %% å®‰å…¨è½¬ç§»é€»è¾‘\n  K2 --&amp;gt; S1[\&quot;_transfer(from to tokenId)\&quot;]\n  S1 --&amp;gt; S2{\&quot;to æ˜¯åˆçº¦åœ°å€?\&quot;}\n  S2 --&amp;gt;|æ˜¯| S3{\&quot;onERC721Received è¿”å›æ­£ç¡®é€‰æ‹©å™¨?\&quot;}\n  S3 --&amp;gt;|æ˜¯| S4[\&quot;å®Œæˆå®‰å…¨è½¬ç§»\&quot;]\n  S3 --&amp;gt;|å¦| SX1[\&quot;revert Not ERC721Receiver\&quot;]\n  S2 --&amp;gt;|å¦| S4\n\n  %% é“¸é€ \n  M[\&quot;é“¸é€  mint(to uri)\&quot;] --&amp;gt; M1[\&quot;tokenId = _tokenIdCounter; é€’å¢\&quot;]\n  M1 --&amp;gt; M2[\&quot;è®¾ç½® _owners[tokenId]=to\&quot;]\n  M2 --&amp;gt; M3[\&quot;å¢åŠ  _balances[to]\&quot;]\n  M3 --&amp;gt; M4[\&quot;è®¾ç½® _tokenURIs[tokenId]=uri\&quot;]\n  M4 --&amp;gt; M5[\&quot;emit Transfer(0 to tokenId)\&quot;]\n\n&quot;}">      </iframe>    </div>  <!----><!----></div>  <span class="js-render-enrichment-loader d-flex flex-justify-center flex-items-center width-full" style="min-height:100px" role="presentation" hidden="">    <span data-view-component="true">  <svg style="box-sizing: content-box; color: var(--color-icon-primary);" width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true" data-view-component="true" class="octospinner mx-auto anim-rotate">    <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" fill="none"></circle>    <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke"></path></svg>    <span class="sr-only">Loading</span></span>  </span><div class="js-render-enrichment-fallback"><div class="render-plaintext-hidden" dir="auto">      <pre lang="mermaid" aria-label="Raw mermaid code">flowchart TD  %% åˆçº¦åˆå§‹åŒ–  A["éƒ¨ç½²åˆçº¦ constructor(name_ symbol_)"] --&gt; A1["è®¾ç½® name å’Œ symbol"]  A1 --&gt; A2["åˆå§‹åŒ– _tokenIdCounter=1 æ˜ å°„ä¸ºç©º"]  %% æŸ¥è¯¢  B["æŸ¥è¯¢ä½™é¢ balanceOf(owner)"] --&gt; B1{"owner != 0"}  B1 --&gt;|æ˜¯| B2["è¿”å› _balances[owner]"]  B1 --&gt;|å¦| BX["revert Zero address"]  C["æŸ¥è¯¢æ‰€æœ‰è€… ownerOf(tokenId)"] --&gt; C1{"_owners[tokenId] != 0"}  C1 --&gt;|æ˜¯| C2["è¿”å› owner"]  C1 --&gt;|å¦| CX["revert Token doesn't exist"]  D["æŸ¥è¯¢æ‰¹å‡† getApproved(tokenId)"] --&gt; D1{"_owners[tokenId] != 0"}  D1 --&gt;|æ˜¯| D2["è¿”å› _tokenApprovals[tokenId]"]  D1 --&gt;|å¦| DX["revert Token doesn't exist"]  E["æŸ¥è¯¢å…¨å±€æ‰¹å‡† isApprovedForAll(owner operator)"] --&gt; E1["è¿”å› _operatorApprovals[owner][operator]"]  F["æŸ¥è¯¢å…ƒæ•°æ® tokenURI(tokenId)"] --&gt; F1{"_owners[tokenId] != 0"}  F1 --&gt;|æ˜¯| F2["è¿”å› _tokenURIs[tokenId]"]  F1 --&gt;|å¦| FX["revert Token doesn't exist"]  %% æ‰¹å‡†  G["å•ä¸ªä»£å¸æ‰¹å‡† approve(to tokenId)"] --&gt; G1["owner = ownerOf(tokenId)"]  G1 --&gt; G2{"to != owner"}  G2 --&gt;|æ˜¯| G3{"msg.sender == owner æˆ– isApprovedForAll(owner msg.sender)"}  G3 --&gt;|æ˜¯| G4["è®¾ç½® _tokenApprovals[tokenId]=to"]  G4 --&gt; G5["emit Approval(owner to tokenId)"]  G2 --&gt;|å¦| GX1["revert Already owner"]  G3 --&gt;|å¦| GX2["revert Not authorized"]  H["å…¨å±€æ‰¹å‡† setApprovalForAll(operator approved)"] --&gt; H1{"operator != msg.sender"}  H1 --&gt;|æ˜¯| H2["è®¾ç½® _operatorApprovals[msg.sender][operator]=approved"]  H2 --&gt; H3["emit ApprovalForAll(msg.sender operator approved)"]  H1 --&gt;|å¦| HX["revert Self approval"]  %% è½¬ç§»ä¸å®‰å…¨è½¬ç§»  I["è½¬ç§» transferFrom(from to tokenId)"] --&gt; I1{"_isApprovedOrOwner(msg.sender tokenId)"}  I1 --&gt;|æ˜¯| I2["_transfer(from to tokenId)"]  I1 --&gt;|å¦| IX["revert Not authorized"]  J["å®‰å…¨è½¬ç§» safeTransferFrom(from to tokenId)"] --&gt; J1["è°ƒç”¨ safeTransferFrom(from to tokenId ç©ºæ•°æ®)"]  K["å®‰å…¨è½¬ç§»(å«æ•°æ®) safeTransferFrom(from to tokenId data)"] --&gt; K1{"_isApprovedOrOwner(msg.sender tokenId)"}  K1 --&gt;|æ˜¯| K2["_safeTransfer(from to tokenId data)"]  K1 --&gt;|å¦| KX["revert Not authorized"]  %% å†…éƒ¨è½¬ç§»é€»è¾‘  I2 --&gt; T1{"ownerOf(tokenId) == from"}  T1 --&gt;|æ˜¯| T2{"to != 0"}  T2 --&gt;|æ˜¯| T3["å‡å°‘ _balances[from]"]  T3 --&gt; T4["å¢åŠ  _balances[to]"]  T4 --&gt; T5["è®¾ç½® _owners[tokenId]=to"]  T5 --&gt; T6["åˆ é™¤ _tokenApprovals[tokenId]"]  T6 --&gt; T7["emit Transfer(from to tokenId)"]  T1 --&gt;|å¦| TX1["revert Not owner"]  T2 --&gt;|å¦| TX2["revert Zero address"]  %% å®‰å…¨è½¬ç§»é€»è¾‘  K2 --&gt; S1["_transfer(from to tokenId)"]  S1 --&gt; S2{"to æ˜¯åˆçº¦åœ°å€?"}  S2 --&gt;|æ˜¯| S3{"onERC721Received è¿”å›æ­£ç¡®é€‰æ‹©å™¨?"}  S3 --&gt;|æ˜¯| S4["å®Œæˆå®‰å…¨è½¬ç§»"]  S3 --&gt;|å¦| SX1["revert Not ERC721Receiver"]  S2 --&gt;|å¦| S4  %% é“¸é€   M["é“¸é€  mint(to uri)"] --&gt; M1["tokenId = _tokenIdCounter; é€’å¢"]  M1 --&gt; M2["è®¾ç½® _owners[tokenId]=to"]  M2 --&gt; M3["å¢åŠ  _balances[to]"]  M3 --&gt; M4["è®¾ç½® _tokenURIs[tokenId]=uri"]  M4 --&gt; M5["emit Transfer(0 to tokenId)"]</pre>    </div></div></section><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">æ•°æ®åº“</h3></div><p dir="auto">ä¸‹é¢æ˜¯å¯ç›´æ¥å¤åˆ¶åˆ° Notion çš„è¡¨æ ¼æ ¼å¼åˆ—æ¸…å•</p><p dir="auto"><strong>addresses</strong></p><p dir="auto">| åç§°| ç±»å‹| ç¤ºä¾‹å€¼|| --- | --- | --- || id| æ•°å­—| 1|| address| æ–‡æœ¬| 0x3Fâ€¦A1c9|| created_at| æ—¥æœŸ| 2025-10-17 00:57|| updated_at| æ—¥æœŸ| 2025-10-17 00:57|</p><p dir="auto"><strong>tokens</strong></p><p dir="auto">| åç§°| ç±»å‹| ç¤ºä¾‹å€¼|| --- | --- | --- || token_id| æ•°å­—| 1|| owner_address| æ–‡æœ¬| 0x3Fâ€¦A1c9|| uri| æ–‡æœ¬| ipfs://QmT7â€¦2uN|| minted_at| æ—¥æœŸ| 2025-10-17 00:58|| metadata_cached| æ–‡æœ¬(JSON)| {â€œnameâ€:â€œé¾™#1â€,â€œimageâ€:â€œipfs://Qmâ€¦â€}|| is_burned| å¤é€‰æ¡†| false|</p><p dir="auto"><strong>balances</strong></p><p dir="auto">| åç§°| ç±»å‹| ç¤ºä¾‹å€¼|| --- | --- | --- || address| æ–‡æœ¬| 0x3Fâ€¦A1c9|| balance| æ•°å­—| 3|| updated_at| æ—¥æœŸ| 2025-10-17 00:59|</p><p dir="auto"><strong>token_approvals</strong></p><p dir="auto">| åç§°| ç±»å‹| ç¤ºä¾‹å€¼|| --- | --- | --- || token_id| æ•°å­—| 1|| approved_address| æ–‡æœ¬| 0xOpâ€¦Sea1|| updated_at| æ—¥æœŸ| 2025-10-17 01:00|</p><p dir="auto"><strong>operator_approvals</strong></p><p dir="auto">| åç§°| ç±»å‹| ç¤ºä¾‹å€¼|| --- | --- | --- || owner_address| æ–‡æœ¬| 0x3Fâ€¦A1c9|| operator_address| æ–‡æœ¬| 0xOpâ€¦Sea1|| approved| å¤é€‰æ¡†| true|| updated_at| æ—¥æœŸ| 2025-10-17 01:01|</p><p dir="auto"><strong>transfers</strong></p><p dir="auto">| åç§°| ç±»å‹| ç¤ºä¾‹å€¼|| --- | --- | --- || id| æ•°å­—| 42|| token_id| æ•°å­—| 1|| from_address| æ–‡æœ¬| 0x0000000000000000000000000000000000000000|| to_address| æ–‡æœ¬| 0x7Bâ€¦92e3|| tx_hash| æ–‡æœ¬| 0xabcâ€¦789|| block_number| æ•°å­—| 5690021|| timestamp| æ—¥æœŸ| 2025-10-17 01:02|</p><p dir="auto"><strong>approvals</strong></p><p dir="auto">| åç§°| ç±»å‹| ç¤ºä¾‹å€¼|| --- | --- | --- || id| æ•°å­—| 7|| owner_address| æ–‡æœ¬| 0x3Fâ€¦A1c9|| approved_address| æ–‡æœ¬| 0xOpâ€¦Sea1|| token_id| æ•°å­—| 1|| tx_hash| æ–‡æœ¬| 0xdefâ€¦123|| block_number| æ•°å­—| 5690025|| timestamp| æ—¥æœŸ| 2025-10-17 01:03|</p><p dir="auto"><strong>approval_for_all</strong></p><p dir="auto">| åç§°| ç±»å‹| ç¤ºä¾‹å€¼|| --- | --- | --- || id| æ•°å­—| 11|| owner_address| æ–‡æœ¬| 0x3Fâ€¦A1c9|| operator_address| æ–‡æœ¬| 0xOpâ€¦Sea1|| approved| å¤é€‰æ¡†| true|| tx_hash| æ–‡æœ¬| 0xaaaâ€¦555|| block_number| æ•°å­—| 5690033|| timestamp| æ—¥æœŸ| 2025-10-17 01:04|</p><p dir="auto"><strong>countersï¼ˆå¯é€‰ï¼‰</strong></p><p dir="auto">| åç§°| ç±»å‹| ç¤ºä¾‹å€¼|| --- | --- | --- || name| æ–‡æœ¬| tokenIdCounter|| current_value| æ•°å­—| 1024|| updated_at| æ—¥æœŸ| 2025-10-17 01:05|</p><div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">2. ç»†èŠ‚è§£è¯´</h1></div><hr><p dir="auto">ğŸ›  é‚£ä¹ˆæˆ‘ä»¬ä»Šå¤©è¦æ„å»ºä»€ä¹ˆï¼Ÿ</p><p dir="auto">æˆ‘ä»¬è¦ä¿æŒç®€å•ã€‚</p><p dir="auto">ä½ å°†ä»å¤´å¼€å§‹æ„å»ºä½ çš„<strong>ç¬¬ä¸€ä¸ªNFTåˆçº¦</strong>ã€‚</p><p dir="auto">æ²¡æœ‰OpenZeppelinã€‚æ²¡æœ‰å¤åˆ¶ç²˜è´´ã€‚åªæœ‰åŸå§‹çš„Solidityâ€”â€”è¿™æ ·ä½ å°±èƒ½ç†è§£å®é™…å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p><p dir="auto">å®ƒå°†éµå¾ª<strong>ERC-721æ ‡å‡†</strong>ï¼Œè¿™å°±åƒä»¥å¤ªåŠä¸ŠNFTçš„è§„åˆ™æ‰‹å†Œã€‚</p><p dir="auto">åˆ°æœ€åï¼Œä½ å°†åˆ›å»ºä¸€ä¸ªçœŸæ­£çš„ã€å¯é“¸é€ çš„NFTâ€”â€”ä½ å¯ä»¥å°†å…¶è¿æ¥åˆ°æ¸¸æˆã€ç”»å»Šï¼Œç”šè‡³ä½ è‡ªå·±çš„è¿·ä½ å¸‚åœºã€‚</p><p dir="auto">è®©æˆ‘ä»¬å¼€å§‹å§ã€‚</p><hr><div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">ğŸ” å®Œæ•´ä»£ç ï¼š<code>SimpleNFT.sol</code></h2></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-c">// SPDX-License-Identifier: MIT</span><span class="pl-k">pragma solidity</span> <span class="pl-k">^</span><span class="pl-c1">0.8.19</span>;<span class="pl-k">interface</span> <span class="pl-en">IERC721</span> {    <span class="pl-k">event <span class="pl-en">Transfer</span></span>(<span class="pl-c1">address</span> <span class="pl-k">indexed</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-k">indexed</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-k">indexed</span> <span class="pl-v">tokenId</span>);    <span class="pl-k">event <span class="pl-en">Approval</span></span>(<span class="pl-c1">address</span> <span class="pl-k">indexed</span> <span class="pl-v">owner</span>, <span class="pl-c1">address</span> <span class="pl-k">indexed</span> <span class="pl-v">approved</span>, <span class="pl-c1">uint256</span> <span class="pl-k">indexed</span> <span class="pl-v">tokenId</span>);    <span class="pl-k">event <span class="pl-en">ApprovalForAll</span></span>(<span class="pl-c1">address</span> <span class="pl-k">indexed</span> <span class="pl-v">owner</span>, <span class="pl-c1">address</span> <span class="pl-k">indexed</span> <span class="pl-v">operator</span>, <span class="pl-c1">bool</span> <span class="pl-v">approved</span>);    <span class="pl-k">function<span class="pl-en"> balanceOf</span></span>(<span class="pl-c1">address</span> <span class="pl-v">owner</span>) <span class="pl-k">external</span> <span class="pl-k">view</span> <span class="pl-k">returns</span> (<span class="pl-c1">uint256</span>);    <span class="pl-k">function<span class="pl-en"> ownerOf</span></span>(<span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">external</span> <span class="pl-k">view</span> <span class="pl-k">returns</span> (<span class="pl-c1">address</span>);    <span class="pl-k">function<span class="pl-en"> approve</span></span>(<span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">external</span>;    <span class="pl-k">function<span class="pl-en"> getApproved</span></span>(<span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">external</span> <span class="pl-k">view</span> <span class="pl-k">returns</span> (<span class="pl-c1">address</span>);    <span class="pl-k">function<span class="pl-en"> setApprovalForAll</span></span>(<span class="pl-c1">address</span> <span class="pl-v">operator</span>, <span class="pl-c1">bool</span> <span class="pl-v">approved</span>) <span class="pl-k">external</span>;    <span class="pl-k">function<span class="pl-en"> isApprovedForAll</span></span>(<span class="pl-c1">address</span> <span class="pl-v">owner</span>, <span class="pl-c1">address</span> <span class="pl-v">operator</span>) <span class="pl-k">external</span> <span class="pl-k">view</span> <span class="pl-k">returns</span> (<span class="pl-c1">bool</span>);    <span class="pl-k">function<span class="pl-en"> transferFrom</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">external</span>;    <span class="pl-k">function<span class="pl-en"> safeTransferFrom</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">external</span>;    <span class="pl-k">function<span class="pl-en"> safeTransferFrom</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>, <span class="pl-c1">bytes</span> <span class="pl-k">calldata</span> <span class="pl-v">data</span>) <span class="pl-k">external</span>;}<span class="pl-k">interface</span> <span class="pl-en">IERC721Receiver</span> {    <span class="pl-k">function<span class="pl-en"> onERC721Received</span></span>(<span class="pl-c1">address</span> <span class="pl-v">operator</span>, <span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>, <span class="pl-c1">bytes</span> <span class="pl-k">calldata</span> <span class="pl-v">data</span>) <span class="pl-k">external</span> <span class="pl-k">returns</span> (<span class="pl-c1">bytes4</span>);}<span class="pl-k">contract</span> <span class="pl-en">SimpleNFT</span> <span class="pl-k">is</span> <span class="pl-en">IERC721</span> {    <span class="pl-c1">string</span> <span class="pl-k">public</span> name;    <span class="pl-c1">string</span> <span class="pl-k">public</span> symbol;    <span class="pl-c1">uint256</span> <span class="pl-k">private </span>_tokenIdCounter <span class="pl-k">=</span> <span class="pl-c1">1</span>;    <span class="pl-k">mapping</span>(<span class="pl-c1">uint256</span> <span class="pl-k">=&gt;</span> <span class="pl-c1">address</span>) <span class="pl-k">private</span> _owners;    <span class="pl-k">mapping</span>(<span class="pl-c1">address</span> <span class="pl-k">=&gt;</span> <span class="pl-c1">uint256</span>) <span class="pl-k">private</span> _balances;    <span class="pl-k">mapping</span>(<span class="pl-c1">uint256</span> <span class="pl-k">=&gt;</span> <span class="pl-c1">address</span>) <span class="pl-k">private</span> _tokenApprovals;    <span class="pl-k">mapping</span>(<span class="pl-c1">address</span> <span class="pl-k">=&gt;</span> <span class="pl-k">mapping</span>(<span class="pl-c1">address</span> <span class="pl-k">=&gt;</span> <span class="pl-c1">bool</span>)) <span class="pl-k">private</span> _operatorApprovals;    <span class="pl-k">mapping</span>(<span class="pl-c1">uint256</span> <span class="pl-k">=&gt;</span> <span class="pl-c1">string</span>) <span class="pl-k">private</span> _tokenURIs;    <span class="pl-k">constructor</span>(<span class="pl-c1">string</span> <span class="pl-k">memory</span> <span class="pl-v">name_</span>, <span class="pl-c1">string</span> <span class="pl-k">memory</span> <span class="pl-v">symbol_</span>) {        name <span class="pl-k">=</span> name_;        symbol <span class="pl-k">=</span> symbol_;    }    <span class="pl-k">function<span class="pl-en"> balanceOf</span></span>(<span class="pl-c1">address</span> <span class="pl-v">owner</span>) <span class="pl-k">public</span> <span class="pl-k">view</span> <span class="pl-k">override</span> <span class="pl-k">returns</span> (<span class="pl-c1">uint256</span>) {        <span class="pl-k">require</span>(owner <span class="pl-k">!=</span> <span class="pl-c1">address</span>(<span class="pl-c1">0</span>), <span class="pl-s">"<span class="pl-s">Zero address</span>"</span>);        <span class="pl-k">return</span> _balances[owner];    }    <span class="pl-k">function<span class="pl-en"> ownerOf</span></span>(<span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">public</span> <span class="pl-k">view</span> <span class="pl-k">override</span> <span class="pl-k">returns</span> (<span class="pl-c1">address</span>) {        <span class="pl-c1">address</span> owner <span class="pl-k">=</span> _owners[tokenId];        <span class="pl-k">require</span>(owner <span class="pl-k">!=</span> <span class="pl-c1">address</span>(<span class="pl-c1">0</span>), <span class="pl-s">"<span class="pl-s">Token doesn't exist</span>"</span>);        <span class="pl-k">return</span> owner;    }    <span class="pl-k">function<span class="pl-en"> approve</span></span>(<span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">public</span> <span class="pl-k">override</span> {        <span class="pl-c1">address</span> owner <span class="pl-k">=</span> <span class="pl-en">ownerOf</span>(tokenId);        <span class="pl-k">require</span>(to <span class="pl-k">!=</span> owner, <span class="pl-s">"<span class="pl-s">Already owner</span>"</span>);        <span class="pl-k">require</span>(<span class="pl-c1">msg</span>.<span class="pl-c1">sender</span> <span class="pl-k">==</span> owner <span class="pl-k">||</span> <span class="pl-en">isApprovedForAll</span>(owner, <span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>), <span class="pl-s">"<span class="pl-s">Not authorized</span>"</span>);        _tokenApprovals[tokenId] <span class="pl-k">=</span> to;        <span class="pl-k">emit</span> <span class="pl-en">Approval</span>(owner, to, tokenId);    }    <span class="pl-k">function<span class="pl-en"> getApproved</span></span>(<span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">public</span> <span class="pl-k">view</span> <span class="pl-k">override</span> <span class="pl-k">returns</span> (<span class="pl-c1">address</span>) {        <span class="pl-k">require</span>(_owners[tokenId] <span class="pl-k">!=</span> <span class="pl-c1">address</span>(<span class="pl-c1">0</span>), <span class="pl-s">"<span class="pl-s">Token doesn't exist</span>"</span>);        <span class="pl-k">return</span> _tokenApprovals[tokenId];    }    <span class="pl-k">function<span class="pl-en"> setApprovalForAll</span></span>(<span class="pl-c1">address</span> <span class="pl-v">operator</span>, <span class="pl-c1">bool</span> <span class="pl-v">approved</span>) <span class="pl-k">public</span> <span class="pl-k">override</span> {        <span class="pl-k">require</span>(operator <span class="pl-k">!=</span> <span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>, <span class="pl-s">"<span class="pl-s">Self approval</span>"</span>);        _operatorApprovals[<span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>][operator] <span class="pl-k">=</span> approved;        <span class="pl-k">emit</span> <span class="pl-en">ApprovalForAll</span>(<span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>, operator, approved);    }    <span class="pl-k">function<span class="pl-en"> isApprovedForAll</span></span>(<span class="pl-c1">address</span> <span class="pl-v">owner</span>, <span class="pl-c1">address</span> <span class="pl-v">operator</span>) <span class="pl-k">public</span> <span class="pl-k">view</span> <span class="pl-k">override</span> <span class="pl-k">returns</span> (<span class="pl-c1">bool</span>) {        <span class="pl-k">return</span> _operatorApprovals[owner][operator];    }    <span class="pl-k">function<span class="pl-en"> transferFrom</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">public</span> <span class="pl-k">override</span> {        <span class="pl-k">require</span>(<span class="pl-en">_isApprovedOrOwner</span>(<span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>, tokenId), <span class="pl-s">"<span class="pl-s">Not authorized</span>"</span>);        <span class="pl-en">_transfer</span>(from, to, tokenId);    }    <span class="pl-k">function<span class="pl-en"> safeTransferFrom</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">public</span> <span class="pl-k">override</span> {        <span class="pl-en">safeTransferFrom</span>(from, to, tokenId, <span class="pl-s">""</span>);    }    <span class="pl-k">function<span class="pl-en"> safeTransferFrom</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>, <span class="pl-c1">bytes</span> <span class="pl-k">memory</span> <span class="pl-v">data</span>) <span class="pl-k">public</span> <span class="pl-k">override</span> {        <span class="pl-k">require</span>(<span class="pl-en">_isApprovedOrOwner</span>(<span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>, tokenId), <span class="pl-s">"<span class="pl-s">Not authorized</span>"</span>);        <span class="pl-en">_safeTransfer</span>(from, to, tokenId, data);    }    <span class="pl-k">function<span class="pl-en"> mint</span></span>(<span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">string</span> <span class="pl-k">memory</span> <span class="pl-v">uri</span>) <span class="pl-k">public</span> {        <span class="pl-c1">uint256</span> tokenId <span class="pl-k">=</span> _tokenIdCounter;        _tokenIdCounter<span class="pl-k">++</span>;        _owners[tokenId] <span class="pl-k">=</span> to;        _balances[to] <span class="pl-k">+=</span> <span class="pl-c1">1</span>;        _tokenURIs[tokenId] <span class="pl-k">=</span> uri;        <span class="pl-k">emit</span> <span class="pl-en">Transfer</span>(<span class="pl-c1">address</span>(<span class="pl-c1">0</span>), to, tokenId);    }    <span class="pl-k">function<span class="pl-en"> tokenURI</span></span>(<span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">public</span> <span class="pl-k">view</span> <span class="pl-k">returns</span> (<span class="pl-c1">string</span> <span class="pl-k">memory</span>) {        <span class="pl-k">require</span>(_owners[tokenId] <span class="pl-k">!=</span> <span class="pl-c1">address</span>(<span class="pl-c1">0</span>), <span class="pl-s">"<span class="pl-s">Token doesn't exist</span>"</span>);        <span class="pl-k">return</span> _tokenURIs[tokenId];    }    <span class="pl-k">function<span class="pl-en"> _transfer</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">internal</span> <span class="pl-k">virtual</span> {        <span class="pl-k">require</span>(<span class="pl-en">ownerOf</span>(tokenId) <span class="pl-k">==</span> from, <span class="pl-s">"<span class="pl-s">Not owner</span>"</span>);        <span class="pl-k">require</span>(to <span class="pl-k">!=</span> <span class="pl-c1">address</span>(<span class="pl-c1">0</span>), <span class="pl-s">"<span class="pl-s">Zero address</span>"</span>);        _balances[from] <span class="pl-k">-=</span> <span class="pl-c1">1</span>;        _balances[to] <span class="pl-k">+=</span> <span class="pl-c1">1</span>;        _owners[tokenId] <span class="pl-k">=</span> to;        <span class="pl-k">delete</span> _tokenApprovals[tokenId];        <span class="pl-k">emit</span> <span class="pl-en">Transfer</span>(from, to, tokenId);    }    <span class="pl-k">function<span class="pl-en"> _safeTransfer</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>, <span class="pl-c1">bytes</span> <span class="pl-k">memory</span> <span class="pl-v">data</span>) <span class="pl-k">internal</span> <span class="pl-k">virtual</span> {        <span class="pl-en">_transfer</span>(from, to, tokenId);        <span class="pl-k">require</span>(<span class="pl-en">_checkOnERC721Received</span>(from, to, tokenId, data), <span class="pl-s">"<span class="pl-s">Not ERC721Receiver</span>"</span>);    }    <span class="pl-k">function<span class="pl-en"> _isApprovedOrOwner</span></span>(<span class="pl-c1">address</span> <span class="pl-v">spender</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">internal</span> <span class="pl-k">view</span> <span class="pl-k">returns</span> (<span class="pl-c1">bool</span>) {        <span class="pl-c1">address</span> owner <span class="pl-k">=</span> <span class="pl-en">ownerOf</span>(tokenId);        <span class="pl-k">return</span> (spender <span class="pl-k">==</span> owner <span class="pl-k">||</span> <span class="pl-en">getApproved</span>(tokenId) <span class="pl-k">==</span> spender <span class="pl-k">||</span> <span class="pl-en">isApprovedForAll</span>(owner, spender));    }    <span class="pl-k">function<span class="pl-en"> _checkOnERC721Received</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>, <span class="pl-c1">bytes</span> <span class="pl-k">memory</span> <span class="pl-v">data</span>) <span class="pl-k">private</span> <span class="pl-k">returns</span> (<span class="pl-c1">bool</span>) {        <span class="pl-k">if</span> (to.code.<span class="pl-mi">length</span> <span class="pl-k">&gt;</span> <span class="pl-c1">0</span>) {            <span class="pl-k">try</span> <span class="pl-c1">IERC721Receiver</span>(to).<span class="pl-en">onERC721Received</span>(<span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>, from, tokenId, data) <span class="pl-k">returns</span> (<span class="pl-c1">bytes4</span> <span class="pl-v">retval</span>) {                <span class="pl-k">return</span> retval <span class="pl-k">==</span> <span class="pl-c1">IERC721Receiver</span>.onERC721Received.<span class="pl-mi">selector</span>;            } <span class="pl-k">catch</span> {                <span class="pl-k">return</span> <span class="pl-c1">false</span>;            }        }        <span class="pl-k">return</span> <span class="pl-c1">true</span>;    }}</pre></div><p dir="auto">å¥½çš„ï¼Œæ˜¯æ—¶å€™åŠ¨æ‰‹äº†ã€‚</p><p dir="auto">è¿™ä¸ªåˆçº¦æ˜¯ä¸€ä¸ª<strong>åŸºç¡€çš„NFTåˆçº¦</strong>ï¼Œéµå¾ªERC-721æ ‡å‡†â€”â€”ä½†ä¸ä½¿ç”¨ä»»ä½•å¤–éƒ¨åº“æˆ–æ¡†æ¶ã€‚</p><p dir="auto">å®ƒéå¸¸å¹²å‡€ï¼Œéå¸¸æ˜“è¯»ï¼Œå‘ä½ å±•ç¤ºäº†NFTåœ¨åº•å±‚å¦‚ä½•å·¥ä½œçš„æ ¸å¿ƒæ€æƒ³ã€‚</p><p dir="auto">å®ƒçš„åŠŸèƒ½ï¼š</p><ul dir="auto"><li>ä¸ºä½ çš„NFTæ”¶è—æä¾›åç§°å’Œç¬¦å·</li><li>è®©ä½ <strong>é“¸é€ </strong>å¸¦æœ‰è‡ªå®šä¹‰å…ƒæ•°æ®çš„æ–°NFTï¼ˆå¦‚å›¾åƒæˆ–æè¿°ï¼‰</li><li>è·Ÿè¸ª<strong>è°æ‹¥æœ‰ä»€ä¹ˆ</strong></li><li>è®°å½•<strong>æ¯ä¸ªäººæ‹¥æœ‰å¤šå°‘NFT</strong></li><li>è®©æ‰€æœ‰è€…<strong>æ‰¹å‡†</strong>å…¶ä»–äººè½¬ç§»ä»–ä»¬çš„NFT</li><li>å½“ç„¶ï¼Œå¤„ç†ç”¨æˆ·ä¹‹é—´çš„<strong>è½¬ç§»</strong></li></ul><p dir="auto">è¿™ä¸è‡ƒè‚¿çš„ï¼Œä¹Ÿæ²¡æœ‰OpenZeppeliné­”æ³•ï¼Œåªæ˜¯çº¯ç²¹çš„Solidityï¼Œå®Œå…¨æŒ‰ç…§NFTåˆçº¦éœ€è¦åšçš„äº‹æƒ…â€”â€”ä¸å¤šä¸å°‘ã€‚</p><p dir="auto">è®©æˆ‘ä»¬æ¥çœ‹çœ‹ã€‚ğŸ‘‡#</p><div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">ğŸ“Œ è¯¦ç»†åˆ†è§£</h2></div><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ“œ æ¥å£</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">interface</span> <span class="pl-en">IERC721</span> {    <span class="pl-k">event <span class="pl-en">Transfer</span></span>(<span class="pl-c1">address</span> <span class="pl-k">indexed</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-k">indexed</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-k">indexed</span> <span class="pl-v">tokenId</span>);    <span class="pl-k">event <span class="pl-en">Approval</span></span>(<span class="pl-c1">address</span> <span class="pl-k">indexed</span> <span class="pl-v">owner</span>, <span class="pl-c1">address</span> <span class="pl-k">indexed</span> <span class="pl-v">approved</span>, <span class="pl-c1">uint256</span> <span class="pl-k">indexed</span> <span class="pl-v">tokenId</span>);    <span class="pl-k">event <span class="pl-en">ApprovalForAll</span></span>(<span class="pl-c1">address</span> <span class="pl-k">indexed</span> <span class="pl-v">owner</span>, <span class="pl-c1">address</span> <span class="pl-k">indexed</span> <span class="pl-v">operator</span>, <span class="pl-c1">bool</span> <span class="pl-v">approved</span>);    <span class="pl-k">function<span class="pl-en"> balanceOf</span></span>(<span class="pl-c1">address</span> <span class="pl-v">owner</span>) <span class="pl-k">external</span> <span class="pl-k">view</span> <span class="pl-k">returns</span> (<span class="pl-c1">uint256</span>);    <span class="pl-k">function<span class="pl-en"> ownerOf</span></span>(<span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">external</span> <span class="pl-k">view</span> <span class="pl-k">returns</span> (<span class="pl-c1">address</span>);    <span class="pl-k">function<span class="pl-en"> approve</span></span>(<span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">external</span>;    <span class="pl-k">function<span class="pl-en"> getApproved</span></span>(<span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">external</span> <span class="pl-k">view</span> <span class="pl-k">returns</span> (<span class="pl-c1">address</span>);    <span class="pl-k">function<span class="pl-en"> setApprovalForAll</span></span>(<span class="pl-c1">address</span> <span class="pl-v">operator</span>, <span class="pl-c1">bool</span> <span class="pl-v">approved</span>) <span class="pl-k">external</span>;    <span class="pl-k">function<span class="pl-en"> isApprovedForAll</span></span>(<span class="pl-c1">address</span> <span class="pl-v">owner</span>, <span class="pl-c1">address</span> <span class="pl-v">operator</span>) <span class="pl-k">external</span> <span class="pl-k">view</span> <span class="pl-k">returns</span> (<span class="pl-c1">bool</span>);    <span class="pl-k">function<span class="pl-en"> transferFrom</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">external</span>;    <span class="pl-k">function<span class="pl-en"> safeTransferFrom</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">external</span>;    <span class="pl-k">function<span class="pl-en"> safeTransferFrom</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>, <span class="pl-c1">bytes</span> <span class="pl-k">calldata</span> <span class="pl-v">data</span>) <span class="pl-k">external</span>;}</pre></div><p dir="auto"><strong>ğŸ§  å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p><p dir="auto">è¿™æ˜¯<strong>ERC-721æ¥å£</strong>ï¼Œå®ƒå®šä¹‰äº†NFTåˆçº¦å¿…é¡»å®ç°çš„æ‰€æœ‰å¼ºåˆ¶å‡½æ•°å’Œäº‹ä»¶ï¼Œæ‰èƒ½è¢«ç§°ä¸º"ERC-721å…¼å®¹"ã€‚</p><p dir="auto">è¿™å°±åƒåœ¨è¯´ï¼š"å˜¿ä»¥å¤ªåŠï¼Œæˆ‘çš„åˆçº¦æ˜¯NFTåˆçº¦ï¼Œè¿™äº›æ˜¯æˆ‘æ‰¿è¯ºæ”¯æŒçš„åŠŸèƒ½ã€‚"</p><ul dir="auto"><li><strong>äº‹ä»¶</strong>å¦‚<code>Transfer</code>å’Œ<code>Approval</code>å‘Šè¯‰åŒºå—é“¾ï¼ˆå’Œå‰ç«¯ï¼‰NFTä½•æ—¶ç§»åŠ¨æˆ–è·å¾—æ‰¹å‡†ã€‚</li><li><strong>å‡½æ•°</strong>å¤„ç†æ‰€æœ‰æƒã€æ‰¹å‡†å’Œè½¬ç§»ä»£å¸ã€‚</li></ul><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ“¬ å¤„ç†å®‰å…¨è½¬ç§»</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">interface</span> <span class="pl-en">IERC721Receiver</span> {    <span class="pl-k">function<span class="pl-en"> onERC721Received</span></span>(<span class="pl-c1">address</span> <span class="pl-v">operator</span>, <span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>, <span class="pl-c1">bytes</span> <span class="pl-k">calldata</span> <span class="pl-v">data</span>) <span class="pl-k">external</span> <span class="pl-k">returns</span> (<span class="pl-c1">bytes4</span>);}</pre></div><p dir="auto">è¿™ä¸ªæ¥å£ç”¨äº<strong>å®‰å…¨åœ°å‘åˆçº¦å‘é€NFT</strong>ã€‚æ²¡æœ‰å®ƒï¼Œå¦‚æœä½ è¯•å›¾å°†NFTè½¬ç§»åˆ°æ— æ³•å¤„ç†å®ƒçš„æ™ºèƒ½åˆçº¦ï¼ŒNFTå¯èƒ½ä¼šè¢«å¡ä½ã€‚æ‰€ä»¥æˆ‘ä»¬æ£€æŸ¥æ¥æ”¶åˆçº¦çŸ¥é“å¦‚ä½•å¤„ç†NFTã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ—ï¸ åˆçº¦å¼€å§‹</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">contract</span> <span class="pl-en">SimpleNFT</span> <span class="pl-k">is</span> <span class="pl-en">IERC721</span> {    <span class="pl-c1">string</span> <span class="pl-k">public</span> name;    <span class="pl-c1">string</span> <span class="pl-k">public</span> symbol;    <span class="pl-c1">uint256</span> <span class="pl-k">private </span>_tokenIdCounter <span class="pl-k">=</span> <span class="pl-c1">1</span>;    <span class="pl-k">mapping</span>(<span class="pl-c1">uint256</span> <span class="pl-k">=&gt;</span> <span class="pl-c1">address</span>) <span class="pl-k">private</span> _owners;    <span class="pl-k">mapping</span>(<span class="pl-c1">address</span> <span class="pl-k">=&gt;</span> <span class="pl-c1">uint256</span>) <span class="pl-k">private</span> _balances;    <span class="pl-k">mapping</span>(<span class="pl-c1">uint256</span> <span class="pl-k">=&gt;</span> <span class="pl-c1">address</span>) <span class="pl-k">private</span> _tokenApprovals;    <span class="pl-k">mapping</span>(<span class="pl-c1">address</span> <span class="pl-k">=&gt;</span> <span class="pl-k">mapping</span>(<span class="pl-c1">address</span> <span class="pl-k">=&gt;</span> <span class="pl-c1">bool</span>)) <span class="pl-k">private</span> _operatorApprovals;    <span class="pl-k">mapping</span>(<span class="pl-c1">uint256</span> <span class="pl-k">=&gt;</span> <span class="pl-c1">string</span>) <span class="pl-k">private</span> _tokenURIs;</pre></div><p dir="auto"><strong>ğŸ§  è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p><p dir="auto">å¥½çš„ï¼Œè¿™æ˜¯æˆ‘ä»¬å·èµ·è¢–å­ï¼Œå®é™…<strong>æ„å»ºNFTåˆçº¦å¤§è„‘</strong>çš„åœ°æ–¹ã€‚</p><p dir="auto">è®©æˆ‘ä»¬é€è¡Œåˆ†æâ€”â€”ä¸ä»…ä»…æ˜¯<em>å®ƒæ˜¯ä»€ä¹ˆ</em>ï¼Œè¿˜æœ‰<em>ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å®ƒ</em>ã€‚</p><hr><div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">contract</span> <span class="pl-v">SimpleNFT</span> <span class="pl-s1">is</span> <span class="pl-c1">IERC721</span><span class="pl-kos">{</span></pre></div><p dir="auto">è¿™ä¸€è¡Œå°±åƒæˆ‘ä»¬åœ¨è¯´ï¼š</p><blockquote><p dir="auto">"å˜¿Solidityï¼Œæˆ‘ä»¬æ­£åœ¨æ„å»ºä¸€ä¸ªåä¸ºSimpleNFTçš„æ–°åˆçº¦ï¼Œå®ƒå°†éµå¾ªERC-721è§„åˆ™ã€‚"</p></blockquote><p dir="auto">åœ¨Solidityä¸­ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨<code>is IERC721</code>æ—¶ï¼Œè¿™å°±åƒç­¾ç½²åˆåŒï¼š</p><p dir="auto">"æˆ‘æ‰¿è¯ºåŒ…å«<code>IERC721</code>æ¥å£ä¸­å®šä¹‰çš„æ‰€æœ‰å‡½æ•°ã€‚"</p><p dir="auto">æ‰€ä»¥æ˜¯çš„â€”â€”å¦‚æœ<code>IERC721</code>æ˜¯è§„åˆ™æ‰‹å†Œï¼Œ<code>SimpleNFT</code>å°±æ˜¯æˆ‘ä»¬å¯¹è¿™äº›è§„åˆ™çš„å®é™…å®ç°ã€‚è¿™å°±æ˜¯å…¶ä»–åˆçº¦å’Œå¹³å°ï¼ˆå¦‚OpenSeaï¼‰çŸ¥é“å¦‚ä½•ä¸æˆ‘ä»¬äº¤äº’çš„æ–¹å¼ã€‚</p><div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">string</span> <span class="pl-s1">public</span> <span class="pl-s1">name</span><span class="pl-kos">;</span> <span class="pl-s1">string</span> <span class="pl-s1">public</span> <span class="pl-s1">symbol</span><span class="pl-kos">;</span></pre></div><hr><p dir="auto">æ¯ä¸ªNFTæ”¶è—ï¼Œå°±åƒæ¯ç§è´§å¸ä¸€æ ·ï¼Œéƒ½éœ€è¦ä¸€ä¸ªèº«ä»½ã€‚</p><ul dir="auto"><li><code>name</code>ï¼šè¿™å¯èƒ½æ˜¯åƒ<code>"åŠ å¯†çŒ«"</code>æˆ–<code>"æˆ‘çš„åƒç´ å°é©¬"</code>è¿™æ ·çš„ä¸œè¥¿ã€‚</li><li><code>symbol</code>ï¼šä¸€ä¸ªæ›´çŸ­çš„ä»£ç é£æ ¼ä»£ç ï¼Œå¦‚<code>"CAT"</code>æˆ–<code>"PONY"</code>ã€‚</li></ul><p dir="auto">è¿™äº›æ˜¯å…¬å…±å˜é‡ï¼Œè¿™æ„å‘³ç€ä»»ä½•äººéƒ½å¯ä»¥è°ƒç”¨å‡½æ•°æ¥è¯¢é—®åç§°æˆ–ç¬¦å·ã€‚Solidityä¼šåœ¨åº•å±‚è‡ªåŠ¨ä¸ºå®ƒä»¬ç”Ÿæˆgetterå‡½æ•°ã€‚</p><hr><div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">uint256</span> <span class="pl-s1">private</span> <span class="pl-s1">_tokenIdCounter</span> <span class="pl-c1">=</span> <span class="pl-c1">1</span><span class="pl-kos">;</span></pre></div><p dir="auto">NFTéœ€è¦æ˜¯ç‹¬ç‰¹çš„ï¼Œå¯¹å§ï¼Ÿæ‰€ä»¥æˆ‘ä»¬ç»™å®ƒä»¬åˆ†é…IDâ€”â€”å°±åƒç¼–å·ä¸º<code>#1</code>ã€<code>#2</code>ã€<code>#3</code>ç­‰çš„æ”¶è—å¡ã€‚</p><p dir="auto">è¿™ä¸ªå˜é‡å¸®åŠ©æˆ‘ä»¬<strong>è·Ÿè¸ªä¸‹ä¸€ä¸ªå¯ç”¨çš„ä»£å¸ID</strong>æ¥é“¸é€ ã€‚</p><p dir="auto">æˆ‘ä»¬ä»<code>1</code>è€Œä¸æ˜¯<code>0</code>å¼€å§‹ï¼ˆåªæ˜¯ä¸ºäº†ä¿æŒäººç±»å¯è¯»æ€§å’Œå‡å°‘é”™è¯¯ï¼‰ã€‚</p><p dir="auto">æ¯æ¬¡æˆ‘ä»¬é“¸é€ æ–°NFTæ—¶ï¼Œæˆ‘ä»¬ï¼š</p><ol dir="auto"><li>ä½¿ç”¨å½“å‰çš„<code>_tokenIdCounter</code></li><li>ç„¶åä¸ºä¸‹ä¸€æ¬¡é“¸é€ å¢åŠ ï¼ˆ<code>++</code>ï¼‰å®ƒ</li></ol><hr><div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-en">mapping</span><span class="pl-kos">(</span><span class="pl-s1">uint256</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">address</span><span class="pl-kos">)</span> <span class="pl-s1">private</span> <span class="pl-s1">_owners</span><span class="pl-kos">;</span></pre></div><p dir="auto">è¿™ä¸ªæ˜ å°„å›ç­”ä¸€ä¸ªç®€å•çš„é—®é¢˜ï¼š</p><blockquote><p dir="auto">"è°æ‹¥æœ‰ä»£å¸#Xï¼Ÿ"</p></blockquote><p dir="auto">æˆ‘ä»¬ç”¨å®ƒæ¥<strong>å­˜å‚¨</strong>æ‹¥æœ‰ç»™å®šä»£å¸IDçš„äººçš„åœ°å€ã€‚å¦‚æœ<code>_owners[10] = 0xabc...</code>ï¼Œè¿™æ„å‘³ç€ä»£å¸#10ç”±è¯¥åœ°å€æ‹¥æœ‰ã€‚</p><p dir="auto">æ²¡æœ‰æ‰€æœ‰è€…=æ²¡æœ‰ä»£å¸ã€‚</p><hr><hr><div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-en">mapping</span><span class="pl-kos">(</span><span class="pl-s1">address</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">uint256</span><span class="pl-kos">)</span> <span class="pl-s1">private</span> <span class="pl-s1">_balances</span><span class="pl-kos">;</span></pre></div><p dir="auto">è¿™ä¸ªä¸ä¸Šé¢çš„ç›¸åã€‚</p><p dir="auto">ä¸æ˜¯é—®**"è°æ‹¥æœ‰ä»£å¸#Xï¼Ÿ"**ï¼Œè¿™ä¸ªé—®ï¼š</p><blockquote><p dir="auto">"Aliceæ‹¥æœ‰å¤šå°‘ä»£å¸ï¼Ÿ"</p></blockquote><p dir="auto">æˆ‘ä»¬åœ¨è¿™é‡Œè·Ÿè¸ªä½™é¢â€”â€”ä¸€ä¸ªåœ°å€æ‹¥æœ‰å¤šå°‘æ€»NFTã€‚</p><p dir="auto">æ‰€ä»¥å¦‚æœ<code>_balances[0xabc...] = 3</code>ï¼Œè¿™æ„å‘³ç€è¿™ä¸ªäººä»è¿™ä¸ªåˆçº¦æ‹¥æœ‰3ä¸ªNFTã€‚</p><p dir="auto">è¿™å¸®åŠ©æˆ‘ä»¬å®ç°æ¥å£ä¸­çš„<code>balanceOf()</code>å‡½æ•°ã€‚</p><hr><div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-en">mapping</span><span class="pl-kos">(</span><span class="pl-s1">uint256</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">address</span><span class="pl-kos">)</span> <span class="pl-s1">private</span> <span class="pl-s1">_tokenApprovals</span><span class="pl-kos">;</span></pre></div><p dir="auto">å¥½çš„â€”â€”è¿™é‡Œå¼€å§‹æ„Ÿè§‰æœ‰ç‚¹åƒå®‰å…¨æ£€æŸ¥ç‚¹ã€‚</p><p dir="auto">NFTå¯ä»¥è¢«<strong>æ‰¹å‡†</strong>ç”±å…¶ä»–äººè½¬ç§»ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³è®©OpenSeaä»£è¡¨ä½ å‡ºå”®ä½ çš„NFTï¼Œä½ éœ€è¦æ‰¹å‡†å®ƒä»¬ã€‚</p><p dir="auto">è¿™ä¸ªæ˜ å°„è·Ÿè¸ªï¼š</p><ul dir="auto"><li><code>_tokenApprovals[12] = 0xopensea...</code>æ„å‘³ç€åœ°å€<code>0xopensea...</code>è¢«æ‰¹å‡†è½¬ç§»ä»£å¸#12ã€‚</li></ul><p dir="auto">æŠŠå®ƒæƒ³è±¡æˆç»™æŸäººä¸´æ—¶æƒé™å°†ä½ çš„å¡ç‰‡æ”¶è—äº¤ç»™ä¹°å®¶ã€‚</p><hr><div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-en">mapping</span><span class="pl-kos">(</span><span class="pl-s1">address</span> <span class="pl-c1">=&gt;</span> <span class="pl-en">mapping</span><span class="pl-kos">(</span><span class="pl-s1">address</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">bool</span><span class="pl-kos">)</span><span class="pl-kos">)</span> <span class="pl-s1">private</span> <span class="pl-s1">_operatorApprovals</span><span class="pl-kos">;</span></pre></div><p dir="auto">è¿™æ˜¯å‰ä¸€ä¸ªçš„æ›´å¹¿æ³›ç‰ˆæœ¬ã€‚</p><p dir="auto">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è¯´ï¼š</p><blockquote><p dir="auto">"æˆ‘ä¿¡ä»»è¿™ä¸ªåœ°å€ç®¡ç†æˆ‘æ‰€æœ‰çš„NFTâ€”â€”ä¸ä»…ä»…æ˜¯ä¸€ä¸ªã€‚"</p></blockquote><p dir="auto">æ‰€ä»¥ä¾‹å¦‚ï¼š</p><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>_operatorApprovals[Alice][Bob] <span class="pl-k">=</span> <span class="pl-c1">true</span></pre></div><p dir="auto">æ„å‘³ç€Bobè¢«å…è®¸ç§»åŠ¨Aliceæ‹¥æœ‰çš„<strong>ä»»ä½•</strong>NFTã€‚</p><p dir="auto">è¿™å¯¹å¸‚åœºã€ç§Ÿèµç³»ç»Ÿæˆ–å°†æƒåˆ©å§”æ‰˜ç»™å¦ä¸€ä¸ªé’±åŒ…å¾ˆæ–¹ä¾¿ã€‚</p><hr><div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-en">mapping</span><span class="pl-kos">(</span><span class="pl-s1">uint256</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">string</span><span class="pl-kos">)</span> <span class="pl-s1">private</span> <span class="pl-s1">_tokenURIs</span><span class="pl-kos">;</span></pre></div><p dir="auto">æœ€åï¼Œæœ‰è¶£çš„éƒ¨åˆ†â€”â€”è¿™æ˜¯NFTé­”æ³•æ‰€åœ¨çš„åœ°æ–¹ï¼</p><p dir="auto">è¿™ä¸ªæ˜ å°„å­˜å‚¨æ¯ä¸ªä»£å¸çš„<strong>å…ƒæ•°æ®URL</strong>ã€‚</p><p dir="auto">æ¯ä¸ªä»£å¸å¯èƒ½æœ‰å›¾åƒã€æè¿°ï¼Œç”šè‡³å¯èƒ½æ˜¯3Dæ¨¡å‹ã€‚</p><p dir="auto">URIå¯èƒ½æŒ‡å‘è¿™æ ·çš„ä¸œè¥¿ï¼š</p><div class="snippet-clipboard-content notranslate position-relative overflow-auto"><pre class="notranslate"><code>&lt;https://my-nft-host.com/metadata/42.json&gt;</code></pre></div><p dir="auto">å…¶ä¸­åŒ…å«ï¼š</p><div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto"><pre>{  <span class="pl-ent">"name"</span>: <span class="pl-s"><span class="pl-pds">"</span>é¾™#42<span class="pl-pds">"</span></span>,  <span class="pl-ent">"description"</span>: <span class="pl-s"><span class="pl-pds">"</span>ä¸€ä¸ªå‡¶çŒ›çš„å–·ç«é¾™NFTã€‚<span class="pl-pds">"</span></span>,  <span class="pl-ent">"image"</span>: <span class="pl-s"><span class="pl-pds">"</span>ipfs://somehash/dragon.png<span class="pl-pds">"</span></span>}</pre></div><p dir="auto">è¿™å°±æ˜¯è®©NFT<em>ä¸ä»…ä»…æ˜¯æ•°å­—</em>çš„åŸå› ã€‚</p><p dir="auto">å®ƒä»¬å˜æˆè§’è‰²ã€è‰ºæœ¯å“ã€éŸ³ä¹â€”â€”ä»»ä½•ä½ æƒ³è®©å®ƒä»¬ä»£è¡¨çš„ä¸œè¥¿ã€‚</p><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">æ„é€ å‡½æ•°</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>    <span class="pl-k">constructor</span>(<span class="pl-c1">string</span> <span class="pl-k">memory</span> <span class="pl-v">name_</span>, <span class="pl-c1">string</span> <span class="pl-k">memory</span> <span class="pl-v">symbol_</span>) {        name <span class="pl-k">=</span> name_;        symbol <span class="pl-k">=</span> symbol_;    }</pre></div><p dir="auto"><strong>ğŸ§  å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p><p dir="auto">å½“ä½ éƒ¨ç½²è¿™ä¸ªåˆçº¦æ—¶ï¼Œä½ è®¾ç½®NFTæ”¶è—çš„åç§°å’Œç¬¦å·ã€‚ä¾‹å¦‚ï¼Œ"åŠ å¯†é¾™"å’Œç¬¦å·"CDR"ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ¦ balanceOf</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>  <span class="pl-k">function<span class="pl-en"> balanceOf</span></span>(<span class="pl-c1">address</span> <span class="pl-v">owner</span>) <span class="pl-k">public</span> <span class="pl-k">view</span> <span class="pl-k">override</span> <span class="pl-k">returns</span> (<span class="pl-c1">uint256</span>) {        <span class="pl-k">require</span>(owner <span class="pl-k">!=</span> <span class="pl-c1">address</span>(<span class="pl-c1">0</span>), <span class="pl-s">"<span class="pl-s">Zero address</span>"</span>);        <span class="pl-k">return</span> _balances[owner];    }</pre></div><p dir="auto"><strong>ğŸ§  è§£é‡Š</strong></p><p dir="auto">è¿™è¿”å›ä¸€ä¸ªåœ°å€æ‹¥æœ‰å¤šå°‘NFTã€‚</p><ul dir="auto"><li>å¦‚æœæœ‰äººç”¨<code>0x0</code>åœ°å€ï¼ˆæ— æ•ˆï¼‰è°ƒç”¨è¿™ä¸ªï¼Œæˆ‘ä»¬æ‹’ç»å®ƒã€‚</li><li>å¦åˆ™ï¼Œæˆ‘ä»¬åªè¿”å›å­˜å‚¨åœ¨<code>_balances</code>ä¸­çš„è®¡æ•°ã€‚</li></ul><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ‘‘ ownerOf</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>    <span class="pl-k">function<span class="pl-en"> ownerOf</span></span>(<span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">public</span> <span class="pl-k">view</span> <span class="pl-k">override</span> <span class="pl-k">returns</span> (<span class="pl-c1">address</span>) {        <span class="pl-c1">address</span> owner <span class="pl-k">=</span> _owners[tokenId];        <span class="pl-k">require</span>(owner <span class="pl-k">!=</span> <span class="pl-c1">address</span>(<span class="pl-c1">0</span>), <span class="pl-s">"<span class="pl-s">Token doesn't exist</span>"</span>);        <span class="pl-k">return</span> owner;    }</pre></div><p dir="auto"><strong>ğŸ§  è§£é‡Š</strong></p><p dir="auto">ç»™å®šä¸€ä¸ªä»£å¸IDï¼Œè¿™å‘Šè¯‰ä½ <strong>è°æ‹¥æœ‰å®ƒ</strong>ã€‚</p><p dir="auto">å¦‚æœä»£å¸ä¸å­˜åœ¨ï¼ˆå³ï¼Œè¿˜æ²¡æœ‰äººæ‹¥æœ‰å®ƒï¼‰ï¼Œæˆ‘ä»¬æŠ›å‡ºé”™è¯¯â€œToken doesn't exist â€ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">âœ‰ï¸ <code>approve</code></h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">function<span class="pl-en"> approve</span></span>(<span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">public</span> <span class="pl-k">override</span> {    <span class="pl-c1">address</span> owner <span class="pl-k">=</span> <span class="pl-en">ownerOf</span>(tokenId);    <span class="pl-k">require</span>(to <span class="pl-k">!=</span> owner, <span class="pl-s">"<span class="pl-s">Already owner</span>"</span>);    <span class="pl-k">require</span>(<span class="pl-c1">msg</span>.<span class="pl-c1">sender</span> <span class="pl-k">==</span> owner <span class="pl-k">||</span> <span class="pl-en">isApprovedForAll</span>(owner, <span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>), <span class="pl-s">"<span class="pl-s">Not authorized</span>"</span>);    _tokenApprovals[tokenId] <span class="pl-k">=</span> to;    <span class="pl-k">emit</span> <span class="pl-en">Approval</span>(owner, to, tokenId);}</pre></div><hr><p dir="auto"><strong>ğŸ§  è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p><p dir="auto">è¿™ä¸ªå‡½æ•°å…è®¸NFTçš„å½“å‰æ‰€æœ‰è€…è¯´ï¼š</p><blockquote><p dir="auto">"å˜¿ï¼Œæˆ‘ç»™è¿™ä¸ªç‰¹å®šçš„äººæƒé™æ¥è½¬ç§»è¿™ä¸ªç‰¹å®šçš„ä»£å¸ã€‚"</p></blockquote><p dir="auto">å®ƒä¸è½¬ç§»æ‰€æœ‰æƒâ€”â€”å®ƒåªæ˜¯<em>ä¸´æ—¶</em>äº¤å‡ºé’¥åŒ™ã€‚</p><p dir="auto">è®©æˆ‘ä»¬é€è¡Œåˆ†æã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ” é€è¡Œåˆ†è§£</h3></div><div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">address</span> <span class="pl-s1">owner</span> <span class="pl-c1">=</span> <span class="pl-en">ownerOf</span><span class="pl-kos">(</span><span class="pl-s1">tokenId</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div><p dir="auto">æˆ‘ä»¬é¦–å…ˆå¼„æ¸…æ¥š<strong>è°çœŸæ­£æ‹¥æœ‰</strong>è¿™ä¸ªä»£å¸ã€‚è¿™å¾ˆé‡è¦ï¼Œå› ä¸º<strong>åªæœ‰çœŸæ­£çš„æ‰€æœ‰è€…</strong>å¯ä»¥æ‰¹å‡†å…¶ä»–äººâ€”â€”æˆ‘ä»¬ä¸å¸Œæœ›éšæœºçš„äººåˆ†å‘æƒé™ã€‚</p><hr><div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s1">to</span> <span class="pl-c1">!=</span> <span class="pl-s1">owner</span><span class="pl-kos">,</span> <span class="pl-s">"Already owner"</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div><p dir="auto">è¿™æ˜¯ä¸€ä¸ªç†æ™ºæ£€æŸ¥ï¼š</p><p dir="auto">ä¸ºä»€ä¹ˆä½ è¦æ‰¹å‡†è‡ªå·±è½¬ç§»è‡ªå·±çš„ä»£å¸ï¼Ÿæ²¡æœ‰æ„ä¹‰ã€‚</p><p dir="auto">æ‰€ä»¥æˆ‘ä»¬ç”¨è¿™ä¸€è¡Œé˜»æ­¢å®ƒã€‚</p><hr><div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s1">msg</span><span class="pl-kos">.</span><span class="pl-c1">sender</span> <span class="pl-c1">==</span> <span class="pl-s1">owner</span> <span class="pl-c1">||</span> <span class="pl-en">isApprovedForAll</span><span class="pl-kos">(</span><span class="pl-s1">owner</span><span class="pl-kos">,</span> <span class="pl-s1">msg</span><span class="pl-kos">.</span><span class="pl-c1">sender</span><span class="pl-kos">)</span><span class="pl-kos">,</span> <span class="pl-s">"Not authorized"</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div><p dir="auto">è¿™æ˜¯æˆ‘ä»¬çš„å®‰å…¨é—¨ã€‚</p><p dir="auto">å®ƒè¯´ï¼š</p><p dir="auto">"åªæœ‰å½“<em>ä½ æ˜¯æ‰€æœ‰è€…</em>...æˆ–è€…<em>ä½ å·²ç»è¢«æ‰€æœ‰è€…æ‰¹å‡†ç®¡ç†ä»–ä»¬æ‰€æœ‰çš„ä»£å¸</em>ï¼ˆé€šè¿‡<code>setApprovalForAll</code>ï¼‰æ—¶ï¼Œä½ æ‰èƒ½æ‰¹å‡†æŸäººã€‚"</p><p dir="auto">åŸºæœ¬ä¸Šï¼š</p><ul dir="auto"><li>âœ… æ‰€æœ‰è€…å¯ä»¥æ‰¹å‡†æŸäºº</li><li>âœ… <em>æ“ä½œå‘˜</em>ï¼ˆè¢«é¢„å…ˆæ‰¹å‡†ç®¡ç†æ‰€æœ‰ä»£å¸çš„äººï¼‰å¯ä»¥æ‰¹å‡†æŸäºº</li><li>âŒ éšæœºé’±åŒ…ä¸èƒ½</li></ul><p dir="auto">è¿™ç¡®ä¿<strong>åªæœ‰æˆæƒç”¨æˆ·å¯ä»¥åˆ†é…ç‰¹å®šä»£å¸çš„æƒé™</strong>ã€‚</p><hr><div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">_tokenApprovals</span><span class="pl-kos">[</span><span class="pl-s1">tokenId</span><span class="pl-kos">]</span> <span class="pl-c1">=</span> <span class="pl-s1">to</span><span class="pl-kos">;</span></pre></div><p dir="auto">ç°åœ¨æ‰€æœ‰æ£€æŸ¥éƒ½é€šè¿‡äº†â€”â€”æˆ‘ä»¬ç»§ç»­<strong>ä¿å­˜æ‰¹å‡†</strong>ã€‚</p><p dir="auto">è¿™æ„å‘³ç€ï¼š</p><blockquote><p dir="auto">"ä»£å¸#123ç°åœ¨è¢«æ‰¹å‡†ç”±åœ°å€0xSomeOtherWalletè½¬ç§»ã€‚"</p></blockquote><p dir="auto">è¯¥ä¿¡æ¯å­˜å‚¨åœ¨<code>_tokenApprovals</code>æ˜ å°„ä¸­ã€‚</p><hr><div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">emit</span> <span class="pl-v">Approval</span><span class="pl-kos">(</span><span class="pl-s1">owner</span><span class="pl-kos">,</span> <span class="pl-s1">to</span><span class="pl-kos">,</span> <span class="pl-s1">tokenId</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div><p dir="auto">æœ€åï¼Œæˆ‘ä»¬å‘å‡ºä¸€ä¸ª<code>Approval</code>äº‹ä»¶â€”â€”å‘å¤–éƒ¨ä¸–ç•Œçš„å°å‘¼å–Šã€‚</p><p dir="auto">è¿™ä¸ªäº‹ä»¶å¯¹åƒOpenSeaæˆ–Etherscanè¿™æ ·çš„å¹³å°éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå¸®åŠ©å®ƒä»¬çŸ¥é“ï¼š</p><ul dir="auto"><li>è°æ‹¥æœ‰ä»€ä¹ˆ</li><li>è°è¢«å…è®¸ç§»åŠ¨å®ƒ</li></ul><p dir="auto">å‰ç«¯<em>ç›‘å¬</em>è¿™äº›äº‹ä»¶ä»¥ä¿æŒå®ƒä»¬çš„UIåŒæ­¥ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ” getApproved</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>    <span class="pl-k">function<span class="pl-en"> getApproved</span></span>(<span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">public</span> <span class="pl-k">view</span> <span class="pl-k">override</span> <span class="pl-k">returns</span> (<span class="pl-c1">address</span>) {        <span class="pl-k">require</span>(_owners[tokenId] <span class="pl-k">!=</span> <span class="pl-c1">address</span>(<span class="pl-c1">0</span>), <span class="pl-s">"<span class="pl-s">Token doesn't exist</span>"</span>);        <span class="pl-k">return</span> _tokenApprovals[tokenId];    }</pre></div><p dir="auto"><strong>ğŸ§  è§£é‡Š</strong></p><p dir="auto">æ£€æŸ¥è°è¢«æ‰¹å‡†è½¬ç§»ç‰¹å®šä»£å¸ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">âœ… setApprovalForAll</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>    <span class="pl-k">function<span class="pl-en"> setApprovalForAll</span></span>(<span class="pl-c1">address</span> <span class="pl-v">operator</span>, <span class="pl-c1">bool</span> <span class="pl-v">approved</span>) <span class="pl-k">public</span> <span class="pl-k">override</span> {        <span class="pl-k">require</span>(operator <span class="pl-k">!=</span> <span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>, <span class="pl-s">"<span class="pl-s">Self approval</span>"</span>);        _operatorApprovals[<span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>][operator] <span class="pl-k">=</span> approved;        <span class="pl-k">emit</span> <span class="pl-en">ApprovalForAll</span>(<span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>, operator, approved);    }</pre></div><p dir="auto"><strong>ğŸ§  è§£é‡Š</strong></p><p dir="auto">ä¸æ˜¯å•ç‹¬æ‰¹å‡†æ¯ä¸ªä»£å¸ï¼Œè¿™è®©ç”¨æˆ·<strong>æ‰¹å‡†æˆ–æ’¤é”€</strong>ç»™å®šæ“ä½œå‘˜ï¼ˆä¾‹å¦‚ï¼Œå¸‚åœºæˆ–é‡‘åº“åˆçº¦ï¼‰å¯¹ä»–ä»¬æ‰€æœ‰NFTçš„è®¿é—®æƒé™ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ”„ isApprovedForAll</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>    <span class="pl-k">function<span class="pl-en"> isApprovedForAll</span></span>(<span class="pl-c1">address</span> <span class="pl-v">owner</span>, <span class="pl-c1">address</span> <span class="pl-v">operator</span>) <span class="pl-k">public</span> <span class="pl-k">view</span> <span class="pl-k">override</span> <span class="pl-k">returns</span> (<span class="pl-c1">bool</span>) {        <span class="pl-k">return</span> _operatorApprovals[owner][operator];    }</pre></div><p dir="auto"><strong>ğŸ§  è§£é‡Š</strong></p><p dir="auto">åªæ˜¯æ£€æŸ¥æ“ä½œå‘˜æ˜¯å¦è¢«æ‰¹å‡†ç®¡ç†æŸäººæ‹¥æœ‰çš„<em>æ‰€æœ‰</em>NFTã€‚</p><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ” _transferï¼ˆå†…éƒ¨ï¼‰</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>    <span class="pl-k">function<span class="pl-en"> _transfer</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">internal</span> <span class="pl-k">virtual</span> {        <span class="pl-k">require</span>(<span class="pl-en">ownerOf</span>(tokenId) <span class="pl-k">==</span> from, <span class="pl-s">"<span class="pl-s">Not owner</span>"</span>);        <span class="pl-k">require</span>(to <span class="pl-k">!=</span> <span class="pl-c1">address</span>(<span class="pl-c1">0</span>), <span class="pl-s">"<span class="pl-s">Zero address</span>"</span>);        _balances[from] <span class="pl-k">-=</span> <span class="pl-c1">1</span>;        _balances[to] <span class="pl-k">+=</span> <span class="pl-c1">1</span>;        _owners[tokenId] <span class="pl-k">=</span> to;        <span class="pl-k">delete</span> _tokenApprovals[tokenId];        <span class="pl-k">emit</span> <span class="pl-en">Transfer</span>(from, to, tokenId);    }</pre></div><p dir="auto"><strong>ğŸ§  è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p><p dir="auto">è¿™æ˜¯å¤„ç†NFTä»ä¸€ä¸ªé’±åŒ…åˆ°å¦ä¸€ä¸ªé’±åŒ…å®é™…ç§»åŠ¨çš„<strong>æ ¸å¿ƒå‡½æ•°</strong>ã€‚</p><p dir="auto">ä½†å…³é”®æ˜¯ï¼š<code>_transfer</code><strong>ä¸æ˜¯ä¸ºäº†è¢«ç”¨æˆ·ç›´æ¥è°ƒç”¨</strong>ã€‚ç›¸åï¼Œå®ƒå……å½“<strong>åŠ©æ‰‹</strong>â€”â€”ä¸€ä¸ª<strong>å¯é‡ç”¨çš„å†…éƒ¨å·¥å…·</strong>ï¼Œå…¶ä»–å‡½æ•°å¦‚<code>transferFrom()</code>å’Œ<code>safeTransferFrom()</code>åœ¨åº•å±‚ä¾èµ–å®ƒã€‚</p><p dir="auto">æ‰€ä»¥æ¯å½“æœ‰äººè°ƒç”¨é‚£äº›å…¬å…±è½¬ç§»å‡½æ•°æ—¶ï¼Œè¿™ä¸ªå°å®¶ä¼™å°±åœ¨è¿™é‡ŒåšçœŸæ­£çš„å·¥ä½œã€‚</p><p dir="auto">è®©æˆ‘ä»¬é€è¡Œåˆ†æï¼š</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ” é€æ­¥åˆ†è§£</h3></div><p dir="auto">âœ… æ‰€æœ‰æƒæ£€æŸ¥</p><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">require</span>(<span class="pl-en">ownerOf</span>(tokenId) <span class="pl-k">==</span> from, <span class="pl-s">"<span class="pl-s">Not owner</span>"</span>);</pre></div><p dir="auto">åœ¨å…¶ä»–ä»»ä½•äº‹æƒ…ä¹‹å‰ï¼Œæˆ‘ä»¬æ£€æŸ¥ï¼š</p><p dir="auto">"è¿™ä¸ª<code>from</code>åœ°å€çœŸçš„æ˜¯è¿™ä¸ªä»£å¸çš„æ‰€æœ‰è€…å—ï¼Ÿ"</p><p dir="auto">å¦‚æœä¸æ˜¯â€”â€”æˆ‘ä»¬åœæ­¢ã€‚ä¸å…è®¸æœªç»æˆæƒçš„ç§»åŠ¨ã€‚</p><hr><p dir="auto"><strong>âŒ æ²¡æœ‰é»‘æ´è½¬ç§»</strong></p><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">require</span>(to <span class="pl-k">!=</span> <span class="pl-c1">address</span>(<span class="pl-c1">0</span>), <span class="pl-s">"<span class="pl-s">Zero address</span>"</span>);</pre></div><p dir="auto">æˆ‘ä»¬ä¹Ÿé˜»æ­¢è½¬ç§»åˆ°<strong>é›¶åœ°å€</strong>â€”â€”è¿™å°±åƒå°†NFTå‘é€åˆ°æ•°å­—é»‘æ´ã€‚</p><p dir="auto">åªæœ‰é“¸é€ ï¼ˆåˆ›å»ºæ–°NFTï¼‰åº”è¯¥ä½¿ç”¨é›¶åœ°å€ä½œä¸º<code>from</code>ã€‚</p><hr><p dir="auto"><strong>â– æ›´æ–°å‘é€è€…çš„ä½™é¢</strong></p><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>_balances[from] <span class="pl-k">-=</span> <span class="pl-c1">1</span>;</pre></div><p dir="auto"><code>from</code>åœ°å€æ­£åœ¨å¤±å»è¿™ä¸ªNFTï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä»–ä»¬çš„ä½™é¢å‡å°‘1ã€‚</p><hr><p dir="auto"><strong>â• æ›´æ–°æ¥æ”¶è€…çš„ä½™é¢</strong></p><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>_balances[to] <span class="pl-k">+=</span> <span class="pl-c1">1</span>;</pre></div><p dir="auto"><code>to</code>åœ°å€æ­£åœ¨æ¥æ”¶æ–°çš„NFTï¼Œæ‰€ä»¥æˆ‘ä»¬å¢åŠ ä»–ä»¬çš„ä½™é¢ã€‚</p><hr><p dir="auto"><strong>ğŸ‘‘ æ›´æ”¹æ‰€æœ‰æƒ</strong></p><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>_owners[tokenId] <span class="pl-k">=</span> to;</pre></div><p dir="auto">ç°åœ¨ä»£å¸å·²ç»æ˜“æ‰‹ï¼Œæˆ‘ä»¬<strong>å°†ä»£å¸IDé‡æ–°åˆ†é…</strong>ç»™æ–°æ‰€æœ‰è€…ã€‚</p><p dir="auto">è¿™æ˜¯æœ€å…³é”®çš„æ­¥éª¤â€”â€”æ‰€æœ‰æƒè®°å½•å¾—åˆ°æ›´æ–°ã€‚</p><hr><p dir="auto"><strong>ğŸ§¹ æ¸…é™¤æ—§æ‰¹å‡†</strong></p><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">delete</span> _tokenApprovals[tokenId];</pre></div><p dir="auto">å¦‚æœæœ‰äººä¹‹å‰è¢«æ‰¹å‡†è½¬ç§»è¿™ä¸ªä»£å¸â€”â€”æˆ‘ä»¬<strong>åˆ é™¤è¯¥æ‰¹å‡†</strong>ã€‚</p><p dir="auto">æ¯•ç«Ÿï¼Œä»£å¸ç°åœ¨æœ‰äº†æ–°æ‰€æœ‰è€…ï¼Œä»–ä»¬åº”è¯¥å†³å®šè°ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ä¸‹æ¬¡è·å¾—æƒé™ã€‚</p><hr><p dir="auto"><strong>ğŸ“¢ å‘å‡ºè½¬ç§»äº‹ä»¶</strong></p><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">emit</span> <span class="pl-en">Transfer</span>(from, to, tokenId);</pre></div><p dir="auto">è¿™å‘åŒºå—é“¾ï¼ˆä»¥åŠåƒEtherscanæˆ–OpenSeaè¿™æ ·çš„å‰ç«¯ï¼‰å‘é€<strong>å®˜æ–¹ä¿¡å·</strong>ï¼š</p><blockquote><p dir="auto">"ä»£å¸#123åˆšåˆšä»Aliceç§»åŠ¨åˆ°Bobã€‚"</p></blockquote><p dir="auto">è¿™ä¸ªäº‹ä»¶æ˜¯ERC-721æ ‡å‡†è¦æ±‚çš„ï¼Œæ˜¯è®©å…¬å…±UIä¸åŒºå—é“¾çŠ¶æ€ä¿æŒåŒæ­¥çš„åŸå› ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ“¦ é‚£ä¹ˆä¸ºä»€ä¹ˆè¿™ä¸ªå‡½æ•°æ˜¯<em>å†…éƒ¨çš„</em>ï¼Ÿ</h3></div><p dir="auto">å¥½é—®é¢˜ã€‚</p><p dir="auto">æˆ‘ä»¬å°†è¿™ä¸ªå‡½æ•°æ ‡è®°ä¸º<code>internal</code>ï¼Œå› ä¸ºï¼š</p><ul dir="auto"><li>å¯¹æœ€ç»ˆç”¨æˆ·ç›´æ¥è°ƒç”¨<strong>ä¸å®‰å…¨</strong>ã€‚</li><li>å®ƒä¸æ‰§è¡Œæƒé™æ£€æŸ¥ï¼Œå¦‚"è°ƒç”¨è€…è¢«æ‰¹å‡†è½¬ç§»è¿™ä¸ªä»£å¸å—ï¼Ÿ"</li><li>å®ƒå‡è®¾è¿™äº›æ£€æŸ¥å·²ç»åœ¨å¤–éƒ¨å‡½æ•°ï¼ˆ<code>transferFrom()</code>æˆ–<code>safeTransferFrom()</code>ï¼‰ä¸­<strong>å‘ç”Ÿäº†</strong>ã€‚</li></ul><p dir="auto">æ‰€ä»¥ä¸æ˜¯åœ¨æ¯ä¸ªåœ°æ–¹é‡å¤è¿™ä¸ªè½¬ç§»é€»è¾‘ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå†™ä¸€æ¬¡ï¼Œå¹¶åœ¨<strong>æ‰€æœ‰æƒé™éªŒè¯å</strong>ä»å…¶ä»–å‡½æ•°å®‰å…¨åœ°è°ƒç”¨å®ƒã€‚</p><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ” <code>_safeTransfer</code>ï¼ˆå†…éƒ¨ï¼‰</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">function<span class="pl-en"> _safeTransfer</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>, <span class="pl-c1">bytes</span> <span class="pl-k">memory</span> <span class="pl-v">data</span>) <span class="pl-k">internal</span> <span class="pl-k">virtual</span> {    <span class="pl-en">_transfer</span>(from, to, tokenId);    <span class="pl-k">require</span>(<span class="pl-en">_checkOnERC721Received</span>(from, to, tokenId, data), <span class="pl-s">"<span class="pl-s">Not ERC721Receiver</span>"</span>);}</pre></div><hr><p dir="auto"><strong>ğŸ§  è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p><p dir="auto">è¿™ä¸ªå‡½æ•°å°±åƒ<code>_transfer</code>ï¼Œä½†æœ‰<strong>é¢å¤–çš„å®‰å…¨è£…ç”²</strong>ã€‚</p><p dir="auto">å®ƒåš<code>_transfer</code>åšçš„ä¸€åˆ‡ï¼ˆæ›´æ–°ä½™é¢ã€æ‰€æœ‰æƒã€æ¸…é™¤æ‰¹å‡†å’Œè§¦å‘<code>Transfer</code>äº‹ä»¶ï¼‰ï¼Œ<strong>ä½†ä¹‹åæ·»åŠ ä¸€ä¸ªå…³é”®æ£€æŸ¥</strong>ï¼š</p><blockquote><p dir="auto">"å˜¿ï¼Œæˆ‘ä»¬æ˜¯åœ¨å‘æ™ºèƒ½åˆçº¦å‘é€è¿™ä¸ªNFTå—ï¼Ÿå¦‚æœæ˜¯â€”â€”å®ƒçœŸçš„èƒ½æ¥æ”¶NFTå—ï¼Ÿ"</p></blockquote><p dir="auto">å› ä¸ºäº‹æƒ…æ˜¯è¿™æ ·çš„â€”â€”å¦‚æœä½ æ„å¤–åœ°å°†NFTå‘é€åˆ°<strong>ä¸çŸ¥é“å¦‚ä½•å¤„ç†NFT</strong>çš„åˆçº¦ï¼Œå®ƒå°±ä¼šæ°¸è¿œå¡åœ¨é‚£é‡Œ...</p><p dir="auto">è¿™ä¸ªå‡½æ•°é€šè¿‡åœ¨è½¬ç§»åè°ƒç”¨<code>_checkOnERC721Received()</code>æ¥å¸®åŠ©é¿å…è¿™ç§æƒ…å†µã€‚å¦‚æœæ£€æŸ¥å¤±è´¥ï¼Œæ•´ä¸ªè½¬ç§»è¢«å›æ»šã€‚</p><p dir="auto">æ‰€ä»¥ï¼Œç®€è€Œè¨€ä¹‹ï¼š</p><ul dir="auto"><li>âœ… å¦‚æœ<code>to</code>æ˜¯æ™®é€šé’±åŒ…ï¼Œå·¥ä½œæ­£å¸¸ã€‚</li><li>ğŸ”’ å½“<code>to</code>æ˜¯æ™ºèƒ½åˆçº¦æ—¶é¢å¤–å®‰å…¨ã€‚</li><li>ğŸš« å¦‚æœåˆçº¦ä¸æ”¯æŒERC-721åˆ™å›æ»šã€‚</li></ul><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ” <code>_isApprovedOrOwner</code></h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">function<span class="pl-en"> _isApprovedOrOwner</span></span>(<span class="pl-c1">address</span> <span class="pl-v">spender</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">internal</span> <span class="pl-k">view</span> <span class="pl-k">returns</span> (<span class="pl-c1">bool</span>) {    <span class="pl-c1">address</span> owner <span class="pl-k">=</span> <span class="pl-en">ownerOf</span>(tokenId);    <span class="pl-k">return</span> (spender <span class="pl-k">==</span> owner <span class="pl-k">||</span> <span class="pl-en">getApproved</span>(tokenId) <span class="pl-k">==</span> spender <span class="pl-k">||</span> <span class="pl-en">isApprovedForAll</span>(owner, spender));}</pre></div><hr><p dir="auto"><strong>ğŸ§  è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p><p dir="auto">è¿™æ˜¯<strong>å®ˆé—¨å‘˜å‡½æ•°</strong>ã€‚åœ¨æˆ‘ä»¬å…è®¸ä»»ä½•äººç§»åŠ¨ä»£å¸ä¹‹å‰ï¼Œæˆ‘ä»¬é—®è¿™ä¸ªç®€å•çš„é—®é¢˜ï¼š</p><blockquote><p dir="auto">"è°ƒç”¨è€…è¢«å…è®¸ç§»åŠ¨è¿™ä¸ªä»£å¸å—ï¼Ÿ"</p></blockquote><p dir="auto">è®©æˆ‘ä»¬åˆ†è§£ä¸€ä¸‹ï¼š</p><ul dir="auto"><li><code>spender == owner</code> â†’ è°ƒç”¨çš„äººæ˜¯ä»£å¸çš„å®é™…æ‰€æœ‰è€…ã€‚</li><li><code>getApproved(tokenId) == spender</code> â†’ ä»£å¸æ‰€æœ‰è€…ç»™äº†è¿™ä¸ªç‰¹å®šçš„äººç§»åŠ¨è¿™ä¸€ä¸ªä»£å¸çš„æƒé™ã€‚</li><li><code>isApprovedForAll(owner, spender)</code> â†’ ä»£å¸æ‰€æœ‰è€…è¯´ï¼Œ"è¿™ä¸ªäººå¯ä»¥ç®¡ç†æˆ‘æ‰€æœ‰çš„ä»£å¸ã€‚"</li></ul><p dir="auto">å¦‚æœè¿™äº›æ£€æŸ¥ä¸­çš„ä»»ä½•ä¸€ä¸ªè¿”å›trueï¼Œé‚£ä¹ˆè°ƒç”¨è€…è¢«æˆæƒç»§ç»­ã€‚</p><p dir="auto">è¿™ä¸ªå‡½æ•°åœ¨å„ä¸ªåœ°æ–¹è¢«ä½¿ç”¨æ¥<strong>å¼ºåˆ¶è®¿é—®æ§åˆ¶</strong>ï¼Œåœ¨åšåƒè½¬ç§»ä»£å¸è¿™æ ·çš„æ•æ„Ÿäº‹æƒ…ä¹‹å‰ã€‚---</p><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ“¦ <code>_checkOnERC721Received</code></h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">function<span class="pl-en"> _checkOnERC721Received</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>, <span class="pl-c1">bytes</span> <span class="pl-k">memory</span> <span class="pl-v">data</span>) <span class="pl-k">private</span> <span class="pl-k">returns</span> (<span class="pl-c1">bool</span>) {    <span class="pl-k">if</span> (to.code.<span class="pl-mi">length</span> <span class="pl-k">&gt;</span> <span class="pl-c1">0</span>) {        <span class="pl-k">try</span> <span class="pl-c1">IERC721Receiver</span>(to).<span class="pl-en">onERC721Received</span>(<span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>, from, tokenId, data) <span class="pl-k">returns</span> (<span class="pl-c1">bytes4</span> <span class="pl-v">retval</span>) {            <span class="pl-k">return</span> retval <span class="pl-k">==</span> <span class="pl-c1">IERC721Receiver</span>.onERC721Received.<span class="pl-mi">selector</span>;        } <span class="pl-k">catch</span> {            <span class="pl-k">return</span> <span class="pl-c1">false</span>;        }    }    <span class="pl-k">return</span> <span class="pl-c1">true</span>;}</pre></div><hr><p dir="auto"><strong>ğŸ§  è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p><p dir="auto">è¿™æ˜¯<code>_safeTransfer</code>ä½¿ç”¨çš„<strong>å®‰å…¨æ£€æŸ¥</strong>ã€‚</p><p dir="auto">å®ƒåœ¨è¿™é‡Œå›ç­”ä¸€ä¸ªéå¸¸é‡è¦çš„é—®é¢˜ï¼š</p><blockquote><p dir="auto">"æˆ‘ä»¬æ˜¯åœ¨å‘çŸ¥é“å¦‚ä½•å¤„ç†NFTçš„æ™ºèƒ½åˆçº¦å‘é€è¿™ä¸ªNFTå—ï¼Ÿ"</p></blockquote><p dir="auto">è®©æˆ‘ä»¬é€è¡Œåˆ†æã€‚</p><p dir="auto"><strong>ğŸ§  <code>if (to.code.length &gt; 0)</code></strong></p><p dir="auto">è¿™æ£€æŸ¥ï¼š</p><blockquote><p dir="auto">æ¥æ”¶è€…æ˜¯æ™ºèƒ½åˆçº¦å—ï¼Ÿ</p></blockquote><p dir="auto">é’±åŒ…åœ°å€æ²¡æœ‰ä»£ç ï¼Œä½†åˆçº¦æœ‰ã€‚</p><p dir="auto">æ‰€ä»¥å¦‚æœ<code>to.code.length &gt; 0</code>ï¼Œé‚£ä¹ˆæ˜¯çš„â€”â€”æˆ‘ä»¬åœ¨ä¸æ™ºèƒ½åˆçº¦å¯¹è¯ã€‚</p><hr><p dir="auto"><strong>ğŸ¯ å°è¯•è°ƒç”¨<code>onERC721Received</code></strong></p><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">try</span> <span class="pl-c1">IERC721Receiver</span>(to).<span class="pl-en">onERC721Received</span>(...) <span class="pl-k">returns</span> (<span class="pl-c1">bytes4</span> <span class="pl-v">retval</span>)</pre></div><p dir="auto">ç„¶åæˆ‘ä»¬<strong>å°è¯•è°ƒç”¨</strong>æ™ºèƒ½åˆçº¦<em>åº”è¯¥</em>å®ç°çš„å‡½æ•°ï¼Œå¦‚æœå®ƒæƒ³å®‰å…¨åœ°æ¥æ”¶NFTã€‚</p><p dir="auto">è¿™å°±åƒæ•²é—¨é—®ï¼š</p><blockquote><p dir="auto">"ä½ çŸ¥é“å¦‚ä½•å¤„ç†è¿™ä¸ªNFTå—ï¼Ÿ"</p></blockquote><p dir="auto">å¦‚æœåˆçº¦è¿”å›é¢„æœŸå€¼ï¼ˆè¿™æ˜¯ä¸€ä¸ªç‰¹å®šçš„é€‰æ‹©å™¨ï¼‰ï¼Œä¸€åˆ‡éƒ½å¥½ã€‚è½¬ç§»æˆåŠŸã€‚</p><hr><p dir="auto"><strong>ğŸ’¥ æ•è·å¤±è´¥</strong></p><p dir="auto">å¦‚æœè°ƒç”¨å¤±è´¥ï¼ˆå³åˆçº¦æ²¡æœ‰å®ç°<code>onERC721Received</code>ï¼Œæˆ–æŠ›å‡ºé”™è¯¯ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿”å›<code>false</code>ã€‚</p><p dir="auto">è¿™å¯¼è‡´<code>_safeTransfer</code>å›æ»šæ•´ä¸ªäº¤æ˜“ï¼Œä¿æŠ¤NFTä¸è¢«ä¸¢å¤±ã€‚</p><hr><p dir="auto"><strong>âœ… å¦‚æœå®ƒåªæ˜¯ä¸€ä¸ªé’±åŒ…...</strong></p><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">return</span> <span class="pl-c1">true</span>;</pre></div><p dir="auto">å¦‚æœæˆ‘ä»¬å‘æ™®é€šé’±åŒ…ï¼ˆä¸æ˜¯åˆçº¦ï¼‰å‘é€NFTï¼Œé‚£ä¹ˆæˆ‘ä»¬å¾ˆå¥½â€”â€”ä¸éœ€è¦èŠ±å“¨çš„æ£€æŸ¥ã€‚</p><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ” transferFrom</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>    <span class="pl-k">function<span class="pl-en"> transferFrom</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">public</span> <span class="pl-k">override</span> {        <span class="pl-k">require</span>(<span class="pl-en">_isApprovedOrOwner</span>(<span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>, tokenId), <span class="pl-s">"<span class="pl-s">Not authorized</span>"</span>);        <span class="pl-en">_transfer</span>(from, to, tokenId);    }</pre></div><p dir="auto"><strong>ğŸ§  è§£é‡Š</strong></p><p dir="auto">å°†ä»£å¸ä»ä¸€ä¸ªäººè½¬ç§»åˆ°å¦ä¸€ä¸ªäººã€‚åªæœ‰æ‰€æœ‰è€…æˆ–è¢«æ‰¹å‡†çš„äººå¯ä»¥è¿™æ ·åšã€‚</p><p dir="auto">å®ƒä½¿ç”¨<code>_isApprovedOrOwner</code>æ£€æŸ¥æƒé™ï¼Œç„¶åè°ƒç”¨<code>_transfer</code>ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ›¡ï¸ <code>safeTransferFrom</code>ï¼ˆåŸºæœ¬ç‰ˆæœ¬ï¼‰</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">function<span class="pl-en"> safeTransferFrom</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">public</span> <span class="pl-k">override</span> {    <span class="pl-en">safeTransferFrom</span>(from, to, tokenId, <span class="pl-s">""</span>);}</pre></div><hr><p dir="auto"><strong>ğŸ§  è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p><p dir="auto">è¿™æ˜¯å®‰å…¨è½¬ç§»çš„<strong>ç®€åŒ–ç‰ˆæœ¬</strong>ã€‚</p><p dir="auto">æŠŠå®ƒæƒ³è±¡æˆå¿«æ·æ–¹å¼â€”â€”å½“ä½ ä¸æƒ³åŒ…å«ä»»ä½•é¢å¤–æ•°æ®æ—¶ï¼Œåªéœ€è°ƒç”¨è¿™ä¸ªã€‚</p><p dir="auto">å®ƒæ‰€åšçš„å°±æ˜¯<strong>å§”æ‰˜ç»™ä¸‹ä¸€ä¸ªç‰ˆæœ¬</strong>ï¼ˆå¸¦æœ‰<code>bytes memory data</code>çš„é‚£ä¸ªï¼‰ï¼Œä¼ å…¥ç©ºæ•°æ®è´Ÿè½½ã€‚</p><p dir="auto">è¿™å¯¹99%çš„è½¬ç§»å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚å½“ç”¨æˆ·åªæ˜¯ç®€å•åœ°ä»ä¸€ä¸ªé’±åŒ…å‘å¦ä¸€ä¸ªé’±åŒ…å‘é€NFTæ—¶ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ›¡ï¸ <code>safeTransferFrom</code>ï¼ˆå¸¦æ•°æ®ï¼‰</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">function<span class="pl-en"> safeTransferFrom</span></span>(<span class="pl-c1">address</span> <span class="pl-v">from</span>, <span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>, <span class="pl-c1">bytes</span> <span class="pl-k">memory</span> <span class="pl-v">data</span>) <span class="pl-k">public</span> <span class="pl-k">override</span> {    <span class="pl-k">require</span>(<span class="pl-en">_isApprovedOrOwner</span>(<span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>, tokenId), <span class="pl-s">"<span class="pl-s">Not authorized</span>"</span>);    <span class="pl-en">_safeTransfer</span>(from, to, tokenId, data);}</pre></div><hr><p dir="auto">ğŸ§  è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p><p dir="auto">è¿™æ˜¯<strong>çœŸæ­£çš„</strong><code>safeTransferFrom</code>å‡½æ•°â€”â€”åšæ‰€æœ‰å®é™…å·¥ä½œçš„é‚£ä¸ªã€‚</p><p dir="auto">å®ƒå¤„ç†ä¸¤ä¸ªé‡è¦çš„äº‹æƒ…ï¼š</p><hr><p dir="auto"><strong>âœ… æ­¥éª¤1ï¼šè®¿é—®æ§åˆ¶æ£€æŸ¥</strong></p><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">require</span>(<span class="pl-en">_isApprovedOrOwner</span>(<span class="pl-c1">msg</span>.<span class="pl-c1">sender</span>, tokenId), <span class="pl-s">"<span class="pl-s">Not authorized</span>"</span>);</pre></div><p dir="auto">è¿™ç¡®ä¿è°ƒç”¨è€…<strong>è¢«å…è®¸</strong>ç§»åŠ¨è¿™ä¸ªNFTã€‚</p><p dir="auto">é‚£ä¹ˆè°è¢«å…è®¸ï¼Ÿ</p><ul dir="auto"><li>ä»£å¸çš„<strong>æ‰€æœ‰è€…</strong></li><li>è¢«<strong>æ‰¹å‡†</strong>è½¬ç§»è¿™ä¸ªç‰¹å®šä»£å¸çš„äºº</li><li>æˆ–è€…æœ‰ç®¡ç†æ‰€æœ‰è€…æ‰€æœ‰ä»£å¸çš„ä¸€èˆ¬æƒé™çš„<strong>æ“ä½œå‘˜</strong></li></ul><p dir="auto">å¦‚æœä½ ä¸æ˜¯è¿™ä¸‰è€…ä¹‹ä¸€ï¼Œè½¬ç§»è¢«é˜»æ­¢ã€‚</p><hr><p dir="auto"><strong>âš™ï¸ æ­¥éª¤2ï¼šæ‰§è¡Œå®‰å…¨è½¬ç§»</strong></p><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-en">_safeTransfer</span>(from, to, tokenId, data);</pre></div><p dir="auto">è¿™æ˜¯é­”æ³•å‘ç”Ÿçš„åœ°æ–¹ã€‚</p><p dir="auto">å®ƒè°ƒç”¨<code>_safeTransfer</code>ï¼Œå®ƒï¼š</p><ul dir="auto"><li>ç§»åŠ¨ä»£å¸</li><li>æ›´æ–°ä½™é¢å’Œæ‰€æœ‰æƒ</li><li>æ¸…é™¤ä¹‹å‰çš„æ‰¹å‡†</li><li>æ£€æŸ¥æ¥æ”¶è€…æ˜¯å¦æ˜¯<strong>æ™ºèƒ½åˆçº¦</strong>ï¼Œå¦‚æœæ˜¯ï¼Œç¡®ä¿å®ƒæ”¯æŒNFT</li></ul><p dir="auto">å¦‚æœæ¥æ”¶è€…æ˜¯é’±åŒ…ï¼šâœ… é¡ºåˆ©è½¬ç§»ã€‚</p><p dir="auto">å¦‚æœå®ƒæ˜¯ä¸å®ç°<code>onERC721Received</code>çš„åˆçº¦ï¼šâŒ äº¤æ˜“è¢«å›æ»šã€‚</p><p dir="auto">è¿™é¿å…äº†æ„å¤–åœ°å°†NFT"é”å®š"åœ¨ä¸çŸ¥é“å¦‚ä½•å¤„ç†å®ƒä»¬çš„åˆçº¦å†…ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ§ª é“¸é€ NFT</h3></div><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>    <span class="pl-k">function<span class="pl-en"> mint</span></span>(<span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">string</span> <span class="pl-k">memory</span> <span class="pl-v">uri</span>) <span class="pl-k">public</span> {        <span class="pl-c1">uint256</span> tokenId <span class="pl-k">=</span> _tokenIdCounter;        _tokenIdCounter<span class="pl-k">++</span>;        _owners[tokenId] <span class="pl-k">=</span> to;        _balances[to] <span class="pl-k">+=</span> <span class="pl-c1">1</span>;        _tokenURIs[tokenId] <span class="pl-k">=</span> uri;        <span class="pl-k">emit</span> <span class="pl-en">Transfer</span>(<span class="pl-c1">address</span>(<span class="pl-c1">0</span>), to, tokenId);    }</pre></div><p dir="auto"><strong>ğŸ§  è§£é‡Š</strong></p><p dir="auto">è¿™æ˜¯ä½ çš„<strong>é“¸é€ å‡½æ•°</strong>â€”â€”å®ƒåˆ›å»ºæ–°çš„NFTï¼š</p><ul dir="auto"><li>ä¸ºå…¶åˆ†é…å”¯ä¸€çš„tokenIdã€‚</li><li>å°†æ‰€æœ‰æƒç»™äºˆæ¥æ”¶è€…ã€‚</li><li>å­˜å‚¨å…¶å…ƒæ•°æ®URIã€‚</li><li>ä»é›¶åœ°å€å‘å‡º<code>Transfer</code>ï¼ˆè¡¨ç¤ºé“¸é€ ï¼‰ã€‚</li></ul><hr><p dir="auto"><strong>ğŸ–¼ï¸ tokenURI</strong></p><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre>    <span class="pl-k">function<span class="pl-en"> tokenURI</span></span>(<span class="pl-c1">uint256</span> <span class="pl-v">tokenId</span>) <span class="pl-k">public</span> <span class="pl-k">view</span> <span class="pl-k">returns</span> (<span class="pl-c1">string</span> <span class="pl-k">memory</span>) {        <span class="pl-k">require</span>(_owners[tokenId] <span class="pl-k">!=</span> <span class="pl-c1">address</span>(<span class="pl-c1">0</span>), <span class="pl-s">"<span class="pl-s">Token doesn't exist</span>"</span>);        <span class="pl-k">return</span> _tokenURIs[tokenId];    }</pre></div><p dir="auto"><strong>ğŸ§  è§£é‡Š</strong></p><p dir="auto">è¿™æ˜¯ä½ å¦‚ä½•<strong>è·å–ç»™å®šNFTçš„å…ƒæ•°æ®URL</strong>â€”â€”å›¾åƒã€æè¿°ç­‰ã€‚---</p><p dir="auto">ğŸ§© ä¸ºä»€ä¹ˆè¿™ç§å‡½æ•°è®¾è®¡æ¨¡å¼ï¼Ÿ</p><p dir="auto">å¦‚æœä½ æƒ³çŸ¥é“ä¸ºä»€ä¹ˆè¿™ä¸ªåˆçº¦æœ‰è¿™ä¹ˆå¤šå‡½æ•°â€”â€”ä¸€äº›å…¬å…±çš„ï¼Œä¸€äº›å†…éƒ¨çš„ï¼Œä¸€äº›çœ‹èµ·æ¥å‡ ä¹ç›¸åŒâ€”â€”è¿™ä¸æ˜¯è¿‡åº¦å·¥ç¨‹åŒ–ã€‚è¿™æ˜¯<strong>èŒè´£çš„æ™ºèƒ½åˆ†ç¦»</strong>ã€‚æƒ³æ³•æ˜¯å°†äº‹æƒ…åˆ†è§£æˆå°çš„ã€å¯é¢„æµ‹çš„æ„å»ºå—ï¼Œæ¯ä¸ªéƒ½<em>åšå¥½ä¸€ä»¶äº‹</em>ã€‚åƒ<code>transferFrom</code>æˆ–<code>safeTransferFrom</code>è¿™æ ·çš„å…¬å…±å‡½æ•°å¤„ç†<strong>æƒé™æ£€æŸ¥</strong>å’Œå¤–éƒ¨è¾“å…¥ã€‚åƒ<code>_transfer</code>æˆ–<code>_safeTransfer</code>è¿™æ ·çš„å†…éƒ¨å‡½æ•°åšç§»åŠ¨ä»£å¸æˆ–æ›´æ–°çŠ¶æ€çš„<strong>æ ¸å¿ƒé€»è¾‘</strong>ã€‚åƒ<code>_isApprovedOrOwner</code>è¿™æ ·çš„è¾…åŠ©å‡½æ•°ä¿æŒæˆ‘ä»¬çš„è®¿é—®è§„åˆ™å¹²å‡€å’Œå¯é‡ç”¨ã€‚è¿™ç§æ¨¡å—åŒ–ç»“æ„ä½¿åˆçº¦<strong>æ›´å®¹æ˜“ç†è§£ã€æ›´å®‰å…¨ç»´æŠ¤ï¼Œå¹¶ä¸”æ›´ä¸å®¹æ˜“å‡ºé”™</strong>â€”â€”ç‰¹åˆ«æ˜¯å½“ä½ å¼€å§‹åœ¨å…¶ä¸Šæ„å»ºæ›´å¤æ‚çš„åŠŸèƒ½æ—¶ã€‚æŠŠå®ƒæƒ³è±¡æˆç»„è£…ä¹é«˜ç§¯æœ¨ï¼šæ¯ä¸ªç§¯æœ¨éƒ½æœ‰ç‰¹å®šçš„å½¢çŠ¶å’Œç›®çš„ï¼Œä½†å½“ä½ æŠŠå®ƒä»¬ç»„åˆåœ¨ä¸€èµ·æ—¶ï¼Œä½ å¾—åˆ°ä¸€ä¸ªåšå›ºã€å®Œæ•´çš„NFTå¼•æ“ã€‚</p><div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">ğŸš€ å¦‚ä½•è¿è¡Œä½ çš„NFTåˆçº¦å¹¶é“¸é€ ä½ çš„ç¬¬ä¸€ä¸ªä»£å¸</h2></div><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ§± å…ˆå†³æ¡ä»¶</h3></div><p dir="auto">åœ¨å¼€å§‹ä¹‹å‰ï¼Œç¡®ä¿ä½ æœ‰ï¼š</p><ul dir="auto"><li>ä¸€ä¸ª<strong>MetaMaské’±åŒ…</strong>ï¼ˆåœ¨æµ‹è¯•ç½‘å¦‚Sepoliaæˆ–l2æµ‹è¯•ç½‘ä¸Šæœ‰ä¸€äº›æµ‹è¯•ETHï¼‰</li><li><strong>Remix IDE</strong>ï¼ˆæ— éœ€è®¾ç½®ï¼Œåœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼‰</li><li><a href="https://www.pinata.cloud/" rel="nofollow"><strong>Pinata</strong></a>ä¸Šçš„è´¦æˆ·ï¼ˆç”¨äºå°†å›¾åƒ+å…ƒæ•°æ®ä¸Šä¼ åˆ°IPFSï¼‰</li></ul><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">âš™ï¸ é€æ­¥åˆ†è§£</h3></div><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">âœ… 1. åœ¨Remixä¸Šéƒ¨ç½²åˆçº¦</h3></div><ol dir="auto"><li>æ‰“å¼€Remix</li><li>åˆ›å»ºæ–°æ–‡ä»¶ï¼ˆä¾‹å¦‚<code>SimpleNFT.sol</code>ï¼‰å¹¶å°†ä½ çš„NFTåˆçº¦ä»£ç ç²˜è´´è¿›å»ã€‚</li><li>ç¡®ä¿ç¼–è¯‘å™¨ç‰ˆæœ¬è®¾ç½®ä¸º<code>0.8.19</code></li><li>ç¼–è¯‘åˆçº¦ã€‚</li><li>è½¬åˆ°"Deploy &amp; Run Transactions"æ ‡ç­¾ï¼š<ul dir="auto"><li>é€‰æ‹©<strong>Injected Provider - MetaMask</strong>ä½œä¸ºç¯å¢ƒ</li><li>è¿æ¥ä½ çš„é’±åŒ…</li><li>é€‰æ‹©åˆçº¦å¹¶ç‚¹å‡»<strong>Deploy</strong></li></ul></li></ol><p dir="auto">ä½ çš„åˆçº¦ç°åœ¨åœ¨æµ‹è¯•ç½‘ä¸Šè¿è¡Œï¼</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ–¼ï¸ 2. é€šè¿‡Pinataå°†å›¾åƒä¸Šä¼ åˆ°IPFS</h3></div><p dir="auto">è¿™æ˜¯æˆ‘ä»¬åœ¨å»ä¸­å¿ƒåŒ–å­˜å‚¨ç½‘ç»œä¸Šå­˜å‚¨NFTçš„<strong>å®é™…åª’ä½“æ–‡ä»¶</strong>â€”â€”æ¯”å¦‚å›¾åƒâ€”â€”çš„åœ°æ–¹ã€‚</p><ol dir="auto"><li><p dir="auto">è½¬åˆ°<a href="https://app.pinata.cloud/pinmanager" rel="nofollow">https://app.pinata.cloud/pinmanager</a></p></li><li><p dir="auto">ç‚¹å‡»<strong>Upload</strong> â†’ <strong>File</strong></p></li><li><p dir="auto">ä¸Šä¼ ä½ çš„å›¾åƒï¼ˆä¾‹å¦‚ï¼Œ<code>dragon.png</code>ï¼‰</p></li><li><p dir="auto">ä¸Šä¼ åï¼ŒPinataä¼šç»™ä½ ä¸€ä¸ªIPFSå“ˆå¸Œã€‚</p><p dir="auto">å®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><div class="snippet-clipboard-content notranslate position-relative overflow-auto"><pre class="notranslate"><code>QmYk...zKs</code></pre></div></li><li><p dir="auto">ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼é¢„è§ˆä½ çš„å›¾åƒï¼š</p><div class="snippet-clipboard-content notranslate position-relative overflow-auto"><pre class="notranslate"><code>&lt;https://gateway.pinata.cloud/ipfs/QmYk...zKs&gt;</code></pre></div></li></ol><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ§¾ 3. åˆ›å»ºå¹¶ä¸Šä¼ å…ƒæ•°æ®JSON</h3></div><p dir="auto">NFTä¸ä»…å­˜å‚¨å›¾åƒâ€”â€”å®ƒä»¬å­˜å‚¨æè¿°NFTçš„<strong>å…ƒæ•°æ®</strong>ã€‚è¿™ä¸ªå…ƒæ•°æ®å­˜å‚¨åœ¨JSONæ–‡ä»¶ä¸­ã€‚</p><p dir="auto">åœ¨ä½ çš„æœ¬åœ°æœºå™¨ä¸Šåˆ›å»ºè¿™æ ·çš„æ–‡ä»¶ï¼š</p><div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto"><pre>{  <span class="pl-ent">"name"</span>: <span class="pl-s"><span class="pl-pds">"</span>é¾™#1<span class="pl-pds">"</span></span>,  <span class="pl-ent">"description"</span>: <span class="pl-s"><span class="pl-pds">"</span>ä¸€ä¸ªå‡¶çŒ›çš„å–·ç«é¾™NFTã€‚<span class="pl-pds">"</span></span>,  <span class="pl-ent">"image"</span>: <span class="pl-s"><span class="pl-pds">"</span>ipfs://QmYk...zKs<span class="pl-pds">"</span></span>}</pre></div><p dir="auto">åƒå›¾åƒä¸€æ ·å°†è¿™ä¸ªJSONæ–‡ä»¶ä¸Šä¼ åˆ°Pinataï¼ˆæ­¥éª¤2ï¼‰ã€‚</p><p dir="auto">ä¸Šä¼ åï¼Œä½ ä¼šå¾—åˆ°å¦ä¸€ä¸ªIPFSå“ˆå¸Œâ€”â€”è¿™æ˜¯ä½ çš„<strong>ä»£å¸URI</strong>ã€‚</p><p dir="auto">ç¤ºä¾‹URIï¼š</p><div class="snippet-clipboard-content notranslate position-relative overflow-auto"><pre class="notranslate"><code>ipfs://QmT7...2uN</code></pre></div><p dir="auto">è¿™æ˜¯ä½ åœ¨é“¸é€ NFTæ—¶ä¼ é€’ç»™æ™ºèƒ½åˆçº¦çš„å†…å®¹ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ§ª 4. é€šè¿‡Remixé“¸é€ NFT</h3></div><ol dir="auto"><li>åœ¨Remixä¸­ï¼Œåœ¨"Deployed Contracts"ä¸‹ï¼Œæ‰“å¼€ä½ çš„åˆçº¦æ–¹æ³•ã€‚</li><li>å¯»æ‰¾<code>mint</code>å‡½æ•°ã€‚å®ƒåº”è¯¥çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</li></ol><div class="highlight highlight-source-solidity notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">function<span class="pl-en"> mint</span></span>(<span class="pl-c1">address</span> <span class="pl-v">to</span>, <span class="pl-c1">string</span> <span class="pl-k">memory</span> <span class="pl-v">uri</span>) <span class="pl-k">public</span></pre></div><ol dir="auto"><li><p dir="auto">å¡«å†™ï¼š</p><ul dir="auto"><li><code>to</code>ï¼šä½ çš„é’±åŒ…åœ°å€ï¼ˆä½ å¯ä»¥ä»MetaMaskå¤åˆ¶ï¼‰</li><li><code>uri</code>ï¼šä½ çš„å…ƒæ•°æ®çš„IPFSé“¾æ¥ï¼Œä¾‹å¦‚</li></ul><div class="snippet-clipboard-content notranslate position-relative overflow-auto"><pre class="notranslate"><code>ipfs://QmT7...2uN</code></pre></div></li><li><p dir="auto">ç‚¹å‡»<strong>transact</strong>å¹¶åœ¨MetaMaskä¸­ç¡®è®¤äº¤æ˜“ã€‚</p></li></ol><p dir="auto">ç °ğŸ’¥ï¼ä½ åˆšåˆšé“¸é€ äº†ä½ è‡ªå·±çš„NFTï¼</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ‘€ 5. åœ¨æµ‹è¯•ç½‘æµè§ˆå™¨æˆ–å¸‚åœºä¸ŠæŸ¥çœ‹ä½ çš„NFT</h3></div><ul dir="auto"><li>ä½¿ç”¨ä½ çš„åˆçº¦åœ°å€</li><li>æˆ–å°è¯•å°†ä½ çš„åˆçº¦å’Œé’±åŒ…å¯¼å…¥<strong>OpenSea</strong>æˆ–<strong>Rarible</strong>çš„æµ‹è¯•ç½‘ç‰ˆæœ¬ã€‚</li></ul><p dir="auto">å®ƒä»¬ä¼šè·å–<code>tokenURI</code>ï¼Œä»IPFSè·å–å…ƒæ•°æ®ï¼Œå¹¶æ˜¾ç¤ºä½ çš„NFTå›¾åƒ+åç§°+æè¿°ã€‚</p><hr><div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ğŸ§  ä¸ºä»€ä¹ˆæ˜¯IPFSå’ŒPinataï¼Ÿ</h3></div><ul dir="auto"><li><strong>ä»¥å¤ªåŠåªå­˜å‚¨ä»£å¸ID + URI</strong>ï¼Œä¸å­˜å‚¨å®é™…åª’ä½“ï¼ˆå¤ªæ˜‚è´µï¼‰ã€‚</li><li><strong>IPFS</strong>æ˜¯å»ä¸­å¿ƒåŒ–å­˜å‚¨ç³»ç»Ÿâ€”â€”å³ä½¿ä½ çš„ç½‘ç«™å…³é—­ï¼Œå†…å®¹ä¹Ÿä¼šä¿æŒå¯ç”¨ã€‚</li><li><strong>Pinata</strong>æ˜¯IPFSå›ºå®šæœåŠ¡â€”â€”å®ƒå¸®åŠ©ä¿æŒä½ çš„æ–‡ä»¶åœ¨IPFSä¸Šå­˜æ´»ï¼Œå¹¶ä¸ºä½ æä¾›ç®¡ç†ä¸Šä¼ çš„ç®€å•å·¥å…·ã€‚</li></ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/solidity.min.js"></script>
    <script>
        hljs.highlightAll();
        
        // å¹³æ»‘æ»šåŠ¨
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
            
        // Snehaçš„ä¸€å°æ¥ä¿¡æ¨¡å—åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            const envelopeContainer = document.getElementById('envelope-container');
            const answerModal = document.getElementById('answer-modal');
            const closeLetter = document.getElementById('close-letter');
            
            if (!envelopeContainer || !answerModal || !closeLetter) {
                return; // å¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å›
            }
            
            // ç‚¹å‡»ä¿¡å°æ‰“å¼€å¼¹çª—
            envelopeContainer.addEventListener('click', function() {
                envelopeContainer.classList.add('open');
                
                // å»¶è¿Ÿæ˜¾ç¤ºå¼¹çª—ï¼Œè®©ä¿¡å°ç¿»è½¬åŠ¨ç”»å®Œæˆ
                setTimeout(function() {
                    answerModal.style.display = 'flex';
                    setTimeout(function() {
                        answerModal.classList.add('open');
                    }, 50);
                }, 400);
            });
            
            // å…³é—­å¼¹çª—
            closeLetter.addEventListener('click', function() {
                answerModal.classList.remove('open');
                
                setTimeout(function() {
                    answerModal.style.display = 'none';
                    envelopeContainer.classList.remove('open');
                }, 600);
            });
            
            // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
            answerModal.addEventListener('click', function(e) {
                if (e.target === answerModal) {
                    closeLetter.click();
                }
            });
        });
    </script>
</body>
</html>